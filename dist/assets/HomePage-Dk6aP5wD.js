import{u as D}from"./index-npWqo0Ou.js";import{d as j,C as Y,q as R,f as u,b as v,c as $,h as l,F as U,s as Z,t as y,j as Q,g as M,w as f,i as C,e as n,u as o,_ as ee,z as E,r as B,m as F,o as te,k as N,l as L}from"./index-Bcr3mXlA.js";import{u as oe}from"./useServices-G1S5lhun.js";import{_ as se}from"./Login.vue_vue_type_script_setup_true_lang-DfCcs621.js";import{u as ae}from"./useForm-fy7gsO6_.js";import{u as le}from"./queues-ahqpviki.js";import{v as z}from"./utils-DvwhG7-T.js";import{u as P,Q as ne,_ as re}from"./EditQueueForm.vue_vue_type_script_setup_true_lang-C8ah80dO.js";import"./services-T7CBbn_K.js";import"./v4-Ch9TGLTe.js";import"./useAuth-D0ISSAP_.js";import"./users-DylJnNym.js";const ue={key:0,class:"flex justify-center py-10"},ie={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-4"},de={class:"flex flex-col gap-2"},ce={class:"text-sm text-gray-600 truncate"},me={class:"text-sm"},pe={class:"text-sm"},ve={class:"text-sm"},fe={class:"text-sm"},ge={key:0,class:"pt-2"},_e=["src"],be={key:2,class:"text-center mt-6 text-gray-500 text-sm"},Ve=j({__name:"ServiceCards",props:{services:{type:Array,required:!0},loading:{type:Boolean,default:!1},pagination:{type:Object,required:!0},sortBy:{type:String,required:!0},sortingOrder:{type:String,default:null}},emits:["reserveTicket"],setup(h,{emit:g}){const S="https://waitkue.onrender.com",c=h,m=Y(c,"services");D();const e=R(()=>Math.ceil(c.pagination.total/c.pagination.perPage));return(T,s)=>{const q=u("VaProgressCircle"),b=u("VaCardTitle"),V=u("VaButton"),A=u("VaCardContent"),x=u("VaCard");return v(),$(U,null,[h.loading?(v(),$("div",ue,[l(q,{indeterminate:"",size:"large"})])):(v(),$("div",ie,[(v(!0),$(U,null,Z(m.value,r=>(v(),M(x,{key:r.id,bordered:!1},{default:f(()=>[l(b,null,{default:f(()=>[C(y(r.name),1)]),_:2},1024),l(A,null,{default:f(()=>[n("div",de,[n("p",ce,[s[0]||(s[0]=n("strong",null,"Description:",-1)),C(" "+y(r.description),1)]),n("p",me,[s[1]||(s[1]=n("strong",null,"Available Days:",-1)),C(" "+y(r.available_days),1)]),n("p",pe,[s[2]||(s[2]=n("strong",null,"Room:",-1)),C(" "+y(r.room),1)]),n("p",ve,[s[3]||(s[3]=n("strong",null,"From:",-1)),C(" "+y(r.from_time)+" â†’ ",1),s[4]||(s[4]=n("strong",null,"To:",-1)),C(" "+y(r.to_time),1)]),n("p",fe,[s[5]||(s[5]=n("strong",null,"Avg Minutes:",-1)),C(" "+y(r.avg_minute),1)]),r.image_url?(v(),$("div",ge,[n("img",{src:o(S)+r.image_url,alt:"Service Image",class:"w-full h-32 object-cover rounded"},null,8,_e)])):Q("",!0),l(V,{onClick:t=>T.$emit("reserveTicket",r)},{default:f(()=>s[6]||(s[6]=[C("Reserve now")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])),e.value>1?(v(),$("div",be," Showing page "+y(c.pagination.page)+" of "+y(e.value),1)):Q("",!0)],64)}}}),ye=ee(Ve,[["__scopeId","data-v-e4515a7e"]]),xe={class:"font-semibold text-3xl mb-4"},we={class:"flex gap-4 flex-col sm:flex-row w-full"},Ce={class:"flex gap-4 flex-col sm:flex-row w-full"},Se={class:"flex gap-2 justify-end w-full"},ke=j({__name:"ReservationForm",props:{queue:{type:Object,default:null},service:{type:Object,required:!0},client:{type:Object,required:!0},saveButtonLabel:{type:String,default:"Reserve"}},emits:["close","save"],setup(h,{expose:g,emit:S}){let x,r;const c=h;E();const m={date:new Date().toISOString().split("T")[0],number:null,time:null,step:0,client_id:((x=c.client)==null?void 0:x.id)||0,comment:"",service_id:((r=c.service)==null?void 0:r.id)||0},e=B({...m});F(()=>c.queue,t=>{t?e.value={...t}:e.value={...m}},{immediate:!0});const T=R(()=>Object.keys(e.value).some(t=>{let a;return e.value[t]!==((a=c.queue??m)==null?void 0:a[t])}));g({isFormHasUnsavedChanges:T}),F(()=>e.value.date,t=>{e.value.service_id&&t&&(e.value.number=null,t instanceof Date?e.value.date=t.toISOString().split("T")[0]:typeof t=="string"&&t.includes("T")&&(e.value.date=t.split("T")[0]),V.getAvailableNumbers(t,e.value.service_id))}),F(()=>e.value.number,t=>{if(t){const a=V.numbers.find(p=>p.queue_number===t);a&&(e.value.time=a.time)}});const s=ae("add-queue-form"),q=S,b=()=>{s.validate()&&q("save",e.value)},V=le();te(async()=>{await V.getAvailableNumbers(e.value.date,c.service.id)});const A=R(()=>V.numbers.map(t=>({text:`${t.time} - ${t.queue_number} ${t.possible?"":" - Reserved"}`,value:t.queue_number,disabled:!t.possible})));return(t,a)=>{const p=u("VaDateInput"),I=u("VaSelect"),d=u("VaTextarea"),i=u("VaButton"),_=u("VaForm");return v(),$(U,null,[n("h1",xe,"Ticket: "+y(h.service.name),1),l(_,{ref:"add-queue-form",class:"flex flex-col gap-4 w-full"},{default:f(({isValid:O})=>[n("div",we,[l(p,{modelValue:e.value.date,"onUpdate:modelValue":a[0]||(a[0]=k=>e.value.date=k),label:"Date",class:"w-full sm:w-1/2",rules:[o(z).required]},null,8,["modelValue","rules"]),l(I,{placeholder:"Select a time",modelValue:e.value.number,"onUpdate:modelValue":a[1]||(a[1]=k=>e.value.number=k),label:"Time & Number",class:"w-full sm:w-1/2",options:A.value,rules:[o(z).required],name:"number","track-by":"value","value-by":"value"},null,8,["modelValue","options","rules"])]),n("div",Ce,[l(d,{placeholder:"Comment to service admin",label:"Comment",modelValue:e.value.comment,"onUpdate:modelValue":a[2]||(a[2]=k=>e.value.comment=k),class:"w-full"},null,8,["modelValue"])]),n("div",Se,[l(i,{preset:"secondary",color:"secondary",onClick:a[3]||(a[3]=k=>t.$emit("close"))},{default:f(()=>a[4]||(a[4]=[C("Cancel")])),_:1}),l(i,{disabled:!O,onClick:b},{default:f(()=>[C(y(h.saveButtonLabel),1)]),_:2},1032,["disabled"])])]),_:1},512)],64)}}}),$e={class:"flex flex-col md:flex-row gap-2 my-2 justify-between"},he={class:"flex flex-col md:flex-row gap-2 justify-start"},Te=j({__name:"ServicesSection",setup(h){const g=B(!1),{services:S,isLoading:c,filters:m,sorting:e,pagination:T,error:s,...q}=oe(),{...b}=P({lazy:!0}),V=B(null);B(null);const A=a=>{V.value=a,g.value=!0},x=E(),{init:r}=N();L(()=>{s.value&&r({message:s.value.message,color:"danger"})});const t=async a=>{await b.add(a),s.value||r({message:`Ticket ${a.number} has been created`,color:"success"})};return B(),D(),(a,p)=>{const I=u("VaIcon"),d=u("VaInput"),i=u("VaModal");return v(),$(U,null,[n("div",$e,[n("div",he,[l(d,{modelValue:o(m).search,"onUpdate:modelValue":p[0]||(p[0]=_=>o(m).search=_),placeholder:"Search"},{prependInner:f(()=>[l(I,{name:"search",color:"secondary",size:"small"})]),_:1},8,["modelValue"])])]),l(ye,{"sort-by":o(e).sortBy,"onUpdate:sortBy":p[1]||(p[1]=_=>o(e).sortBy=_),"sorting-order":o(e).sortingOrder,"onUpdate:sortingOrder":p[2]||(p[2]=_=>o(e).sortingOrder=_),services:o(S),loading:o(c),pagination:o(T),onReserveTicket:A},null,8,["sort-by","sorting-order","services","loading","pagination"]),l(i,{blur:"",modelValue:g.value,"onUpdate:modelValue":p[3]||(p[3]=_=>g.value=_),size:"small","mobile-fullscreen":"","close-button":"","hide-default-actions":""},{default:f(({cancel:_,ok:O})=>[o(x).isAuthenticated?Q("",!0):(v(),M(se,{key:0})),o(x).isAuthenticated&&V.value&&o(x).currentUser?(v(),M(ke,{key:1,service:V.value,client:o(x).currentUser,onClose:_,onSave:k=>{t(k),O()}},null,8,["service","client","onClose","onSave"])):Q("",!0)]),_:1},8,["modelValue"])],64)}}}),Be={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between"},qe={class:"flex flex-col md:flex-row gap-2 justify-start"},Ae={class:"va-h5"},Ue=j({__name:"MyTicketsSection",setup(h){const g=B(!1),{queues:S,isLoading:c,filters:m,sorting:e,pagination:T,error:s,...q}=P({lazy:!1}),b=B(null),V=d=>{b.value=d,g.value=!0},A=()=>{b.value=null,g.value=!0},x=async d=>{b.value?(await q.update(d),s.value||r({message:`${d.number} has been updated`,color:"success"})):(await q.add(d),s.value||r({message:`Ticket ${d.number} has been created`,color:"success"}))},{init:r}=N();L(()=>{s.value&&r({message:s.value.message,color:"danger"})});const t=async d=>{await q.remove(d),r({message:`Ticket ${d.number} for ${d.service.name} has been deleted`,color:"success"})},a=B(),{confirm:p}=D(),I=async d=>{a.value.isFormHasUnsavedChanges?await p({maxWidth:"380px",message:"Form has unsaved changes. Are you sure you want to close it?",size:"small"})&&d():d()};return(d,i)=>{const _=u("VaButtonToggle"),O=u("VaIcon"),k=u("VaInput"),H=u("VaButton"),W=u("VaCardContent"),K=u("VaCard"),G=u("VaModal");return v(),$(U,null,[i[6]||(i[6]=n("h1",{class:"page-title"},"Queues",-1)),l(K,null,{default:f(()=>[l(W,null,{default:f(()=>[n("div",Be,[n("div",qe,[l(_,{modelValue:o(m).isActive,"onUpdate:modelValue":i[0]||(i[0]=w=>o(m).isActive=w),color:"background-element","border-color":"background-element",options:[{label:"Open",value:!0},{label:"Finished",value:!1}]},null,8,["modelValue"]),l(k,{modelValue:o(m).search,"onUpdate:modelValue":i[1]||(i[1]=w=>o(m).search=w),placeholder:"Search"},{prependInner:f(()=>[l(O,{name:"search",color:"secondary",size:"small"})]),_:1},8,["modelValue"])]),l(H,{onClick:A},{default:f(()=>i[5]||(i[5]=[C("Add Queue")])),_:1})]),l(ne,{"sort-by":o(e).sortBy,"onUpdate:sortBy":i[2]||(i[2]=w=>o(e).sortBy=w),"sorting-order":o(e).sortingOrder,"onUpdate:sortingOrder":i[3]||(i[3]=w=>o(e).sortingOrder=w),queues:o(S),loading:o(c),pagination:o(T),onEditQueue:V,onDeleteQueue:t},null,8,["sort-by","sorting-order","queues","loading","pagination"])]),_:1})]),_:1}),l(G,{modelValue:g.value,"onUpdate:modelValue":i[4]||(i[4]=w=>g.value=w),size:"small","mobile-fullscreen":"","close-button":"","hide-default-actions":"","before-cancel":I},{default:f(({cancel:w,ok:J})=>[n("h1",Ae,y(b.value?"Edit queue":"Add queue"),1),l(re,{ref_key:"editFormRef",ref:a,queue:b.value,"save-button-label":b.value?"Save":"Add",onClose:w,onSave:X=>{x(X),J()}},null,8,["queue","save-button-label","onClose","onSave"])]),_:1},8,["modelValue"])],64)}}}),Pe={__name:"HomePage",setup(h){const g=E(),S=B(0),c=["/logo-banner.png","/waiting-people.png","/WAITKUE.jpg","people-checking.webp"];return(m,e)=>{const T=u("VaCarousel");return v(),$(U,null,[l(T,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=s=>S.value=s),items:c,height:"600px"},null,8,["modelValue"]),l(Te),o(g).isAuthenticated?(v(),M(Ue,{key:0})):Q("",!0)],64)}}};export{Pe as default};
//# sourceMappingURL=HomePage-Dk6aP5wD.js.map

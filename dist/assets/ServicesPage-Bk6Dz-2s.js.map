{"version":3,"file":"ServicesPage-Bk6Dz-2s.js","sources":["../../node_modules/filepond/dist/filepond.esm.js","../../node_modules/vue-filepond/dist/vue-filepond.esm.js","../../node_modules/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.esm.js","../../node_modules/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.esm.js","../../src/pages/services/widgets/EditServiceForm.vue","../../src/pages/services/widgets/ServicesTable.vue","../../src/pages/services/ServicesPage.vue"],"sourcesContent":["/*!\n * FilePond 4.32.7\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\nconst isNode = value => value instanceof HTMLElement;\n\nconst createStore = (initialState, queries = [], actions = []) => {\n    // internal state\n    const state = {\n        ...initialState,\n    };\n\n    // contains all actions for next frame, is clear when actions are requested\n    const actionQueue = [];\n    const dispatchQueue = [];\n\n    // returns a duplicate of the current state\n    const getState = () => ({ ...state });\n\n    // returns a duplicate of the actions array and clears the actions array\n    const processActionQueue = () => {\n        // create copy of actions queue\n        const queue = [...actionQueue];\n\n        // clear actions queue (we don't want no double actions)\n        actionQueue.length = 0;\n\n        return queue;\n    };\n\n    // processes actions that might block the main UI thread\n    const processDispatchQueue = () => {\n        // create copy of actions queue\n        const queue = [...dispatchQueue];\n\n        // clear actions queue (we don't want no double actions)\n        dispatchQueue.length = 0;\n\n        // now dispatch these actions\n        queue.forEach(({ type, data }) => {\n            dispatch(type, data);\n        });\n    };\n\n    // adds a new action, calls its handler and\n    const dispatch = (type, data, isBlocking) => {\n        // is blocking action (should never block if document is hidden)\n        if (isBlocking && !document.hidden) {\n            dispatchQueue.push({ type, data });\n            return;\n        }\n\n        // if this action has a handler, handle the action\n        if (actionHandlers[type]) {\n            actionHandlers[type](data);\n        }\n\n        // now add action\n        actionQueue.push({\n            type,\n            data,\n        });\n    };\n\n    const query = (str, ...args) => (queryHandles[str] ? queryHandles[str](...args) : null);\n\n    const api = {\n        getState,\n        processActionQueue,\n        processDispatchQueue,\n        dispatch,\n        query,\n    };\n\n    let queryHandles = {};\n    queries.forEach(query => {\n        queryHandles = {\n            ...query(state),\n            ...queryHandles,\n        };\n    });\n\n    let actionHandlers = {};\n    actions.forEach(action => {\n        actionHandlers = {\n            ...action(dispatch, query, state),\n            ...actionHandlers,\n        };\n    });\n\n    return api;\n};\n\nconst defineProperty = (obj, property, definition) => {\n    if (typeof definition === 'function') {\n        obj[property] = definition;\n        return;\n    }\n    Object.defineProperty(obj, property, { ...definition });\n};\n\nconst forin = (obj, cb) => {\n    for (const key in obj) {\n        if (!obj.hasOwnProperty(key)) {\n            continue;\n        }\n\n        cb(key, obj[key]);\n    }\n};\n\nconst createObject = definition => {\n    const obj = {};\n    forin(definition, property => {\n        defineProperty(obj, property, definition[property]);\n    });\n    return obj;\n};\n\nconst attr = (node, name, value = null) => {\n    if (value === null) {\n        return node.getAttribute(name) || node.hasAttribute(name);\n    }\n    node.setAttribute(name, value);\n};\n\nconst ns = 'http://www.w3.org/2000/svg';\nconst svgElements = ['svg', 'path']; // only svg elements used\n\nconst isSVGElement = tag => svgElements.includes(tag);\n\nconst createElement = (tag, className, attributes = {}) => {\n    if (typeof className === 'object') {\n        attributes = className;\n        className = null;\n    }\n    const element = isSVGElement(tag)\n        ? document.createElementNS(ns, tag)\n        : document.createElement(tag);\n    if (className) {\n        if (isSVGElement(tag)) {\n            attr(element, 'class', className);\n        } else {\n            element.className = className;\n        }\n    }\n    forin(attributes, (name, value) => {\n        attr(element, name, value);\n    });\n    return element;\n};\n\nconst appendChild = parent => (child, index) => {\n    if (typeof index !== 'undefined' && parent.children[index]) {\n        parent.insertBefore(child, parent.children[index]);\n    } else {\n        parent.appendChild(child);\n    }\n};\n\nconst appendChildView = (parent, childViews) => (view, index) => {\n    if (typeof index !== 'undefined') {\n        childViews.splice(index, 0, view);\n    } else {\n        childViews.push(view);\n    }\n\n    return view;\n};\n\nconst removeChildView = (parent, childViews) => view => {\n    // remove from child views\n    childViews.splice(childViews.indexOf(view), 1);\n\n    // remove the element\n    if (view.element.parentNode) {\n        parent.removeChild(view.element);\n    }\n\n    return view;\n};\n\nconst IS_BROWSER = (() =>\n    typeof window !== 'undefined' && typeof window.document !== 'undefined')();\nconst isBrowser = () => IS_BROWSER;\n\nconst testElement = isBrowser() ? createElement('svg') : {};\nconst getChildCount =\n    'children' in testElement ? el => el.children.length : el => el.childNodes.length;\n\nconst getViewRect = (elementRect, childViews, offset, scale) => {\n    const left = offset[0] || elementRect.left;\n    const top = offset[1] || elementRect.top;\n    const right = left + elementRect.width;\n    const bottom = top + elementRect.height * (scale[1] || 1);\n\n    const rect = {\n        // the rectangle of the element itself\n        element: {\n            ...elementRect,\n        },\n\n        // the rectangle of the element expanded to contain its children, does not include any margins\n        inner: {\n            left: elementRect.left,\n            top: elementRect.top,\n            right: elementRect.right,\n            bottom: elementRect.bottom,\n        },\n\n        // the rectangle of the element expanded to contain its children including own margin and child margins\n        // margins will be added after we've recalculated the size\n        outer: {\n            left,\n            top,\n            right,\n            bottom,\n        },\n    };\n\n    // expand rect to fit all child rectangles\n    childViews\n        .filter(childView => !childView.isRectIgnored())\n        .map(childView => childView.rect)\n        .forEach(childViewRect => {\n            expandRect(rect.inner, { ...childViewRect.inner });\n            expandRect(rect.outer, { ...childViewRect.outer });\n        });\n\n    // calculate inner width and height\n    calculateRectSize(rect.inner);\n\n    // append additional margin (top and left margins are included in top and left automatically)\n    rect.outer.bottom += rect.element.marginBottom;\n    rect.outer.right += rect.element.marginRight;\n\n    // calculate outer width and height\n    calculateRectSize(rect.outer);\n\n    return rect;\n};\n\nconst expandRect = (parent, child) => {\n    // adjust for parent offset\n    child.top += parent.top;\n    child.right += parent.left;\n    child.bottom += parent.top;\n    child.left += parent.left;\n\n    if (child.bottom > parent.bottom) {\n        parent.bottom = child.bottom;\n    }\n\n    if (child.right > parent.right) {\n        parent.right = child.right;\n    }\n};\n\nconst calculateRectSize = rect => {\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n};\n\nconst isNumber = value => typeof value === 'number';\n\n/**\n * Determines if position is at destination\n * @param position\n * @param destination\n * @param velocity\n * @param errorMargin\n * @returns {boolean}\n */\nconst thereYet = (position, destination, velocity, errorMargin = 0.001) => {\n    return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;\n};\n\n/**\n * Spring animation\n */\nconst spring =\n    // default options\n    ({ stiffness = 0.5, damping = 0.75, mass = 10 } = {}) =>\n        // method definition\n        {\n            let target = null;\n            let position = null;\n            let velocity = 0;\n            let resting = false;\n\n            // updates spring state\n            const interpolate = (ts, skipToEndState) => {\n                // in rest, don't animate\n                if (resting) return;\n\n                // need at least a target or position to do springy things\n                if (!(isNumber(target) && isNumber(position))) {\n                    resting = true;\n                    velocity = 0;\n                    return;\n                }\n\n                // calculate spring force\n                const f = -(position - target) * stiffness;\n\n                // update velocity by adding force based on mass\n                velocity += f / mass;\n\n                // update position by adding velocity\n                position += velocity;\n\n                // slow down based on amount of damping\n                velocity *= damping;\n\n                // we've arrived if we're near target and our velocity is near zero\n                if (thereYet(position, target, velocity) || skipToEndState) {\n                    position = target;\n                    velocity = 0;\n                    resting = true;\n\n                    // we done\n                    api.onupdate(position);\n                    api.oncomplete(position);\n                } else {\n                    // progress update\n                    api.onupdate(position);\n                }\n            };\n\n            /**\n             * Set new target value\n             * @param value\n             */\n            const setTarget = value => {\n                // if currently has no position, set target and position to this value\n                if (isNumber(value) && !isNumber(position)) {\n                    position = value;\n                }\n\n                // next target value will not be animated to\n                if (target === null) {\n                    target = value;\n                    position = value;\n                }\n\n                // let start moving to target\n                target = value;\n\n                // already at target\n                if (position === target || typeof target === 'undefined') {\n                    // now resting as target is current position, stop moving\n                    resting = true;\n                    velocity = 0;\n\n                    // done!\n                    api.onupdate(position);\n                    api.oncomplete(position);\n\n                    return;\n                }\n\n                resting = false;\n            };\n\n            // need 'api' to call onupdate callback\n            const api = createObject({\n                interpolate,\n                target: {\n                    set: setTarget,\n                    get: () => target,\n                },\n                resting: {\n                    get: () => resting,\n                },\n                onupdate: value => {},\n                oncomplete: value => {},\n            });\n\n            return api;\n        };\n\nconst easeLinear = t => t;\nconst easeInOutQuad = t => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t);\n\nconst tween =\n    // default values\n    ({ duration = 500, easing = easeInOutQuad, delay = 0 } = {}) =>\n        // method definition\n        {\n            let start = null;\n            let t;\n            let p;\n            let resting = true;\n            let reverse = false;\n            let target = null;\n\n            const interpolate = (ts, skipToEndState) => {\n                if (resting || target === null) return;\n\n                if (start === null) {\n                    start = ts;\n                }\n\n                if (ts - start < delay) return;\n\n                t = ts - start - delay;\n\n                if (t >= duration || skipToEndState) {\n                    t = 1;\n                    p = reverse ? 0 : 1;\n                    api.onupdate(p * target);\n                    api.oncomplete(p * target);\n                    resting = true;\n                } else {\n                    p = t / duration;\n                    api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n                }\n            };\n\n            // need 'api' to call onupdate callback\n            const api = createObject({\n                interpolate,\n                target: {\n                    get: () => (reverse ? 0 : target),\n                    set: value => {\n                        // is initial value\n                        if (target === null) {\n                            target = value;\n                            api.onupdate(value);\n                            api.oncomplete(value);\n                            return;\n                        }\n\n                        // want to tween to a smaller value and have a current value\n                        if (value < target) {\n                            target = 1;\n                            reverse = true;\n                        } else {\n                            // not tweening to a smaller value\n                            reverse = false;\n                            target = value;\n                        }\n\n                        // let's go!\n                        resting = false;\n                        start = null;\n                    },\n                },\n                resting: {\n                    get: () => resting,\n                },\n                onupdate: value => {},\n                oncomplete: value => {},\n            });\n\n            return api;\n        };\n\nconst animator = {\n    spring,\n    tween,\n};\n\n/*\n { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n { translation: { type: 'spring', ... }, ... }\n { translation: { x: { type: 'spring', ... } } }\n*/\nconst createAnimator = (definition, category, property) => {\n    // default is single definition\n    // we check if transform is set, if so, we check if property is set\n    const def =\n        definition[category] && typeof definition[category][property] === 'object'\n            ? definition[category][property]\n            : definition[category] || definition;\n\n    const type = typeof def === 'string' ? def : def.type;\n    const props = typeof def === 'object' ? { ...def } : {};\n\n    return animator[type] ? animator[type](props) : null;\n};\n\nconst addGetSet = (keys, obj, props, overwrite = false) => {\n    obj = Array.isArray(obj) ? obj : [obj];\n    obj.forEach(o => {\n        keys.forEach(key => {\n            let name = key;\n            let getter = () => props[key];\n            let setter = value => (props[key] = value);\n\n            if (typeof key === 'object') {\n                name = key.key;\n                getter = key.getter || getter;\n                setter = key.setter || setter;\n            }\n\n            if (o[name] && !overwrite) {\n                return;\n            }\n\n            o[name] = {\n                get: getter,\n                set: setter,\n            };\n        });\n    });\n};\n\n// add to state,\n// add getters and setters to internal and external api (if not set)\n// setup animators\n\nconst animations = ({ mixinConfig, viewProps, viewInternalAPI, viewExternalAPI }) => {\n    // initial properties\n    const initialProps = { ...viewProps };\n\n    // list of all active animations\n    const animations = [];\n\n    // setup animators\n    forin(mixinConfig, (property, animation) => {\n        const animator = createAnimator(animation);\n        if (!animator) {\n            return;\n        }\n\n        // when the animator updates, update the view state value\n        animator.onupdate = value => {\n            viewProps[property] = value;\n        };\n\n        // set animator target\n        animator.target = initialProps[property];\n\n        // when value is set, set the animator target value\n        const prop = {\n            key: property,\n            setter: value => {\n                // if already at target, we done!\n                if (animator.target === value) {\n                    return;\n                }\n\n                animator.target = value;\n            },\n            getter: () => viewProps[property],\n        };\n\n        // add getters and setters\n        addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);\n\n        // add it to the list for easy updating from the _write method\n        animations.push(animator);\n    });\n\n    // expose internal write api\n    return {\n        write: ts => {\n            let skipToEndState = document.hidden;\n            let resting = true;\n            animations.forEach(animation => {\n                if (!animation.resting) resting = false;\n                animation.interpolate(ts, skipToEndState);\n            });\n            return resting;\n        },\n        destroy: () => {},\n    };\n};\n\nconst addEvent = element => (type, fn) => {\n    element.addEventListener(type, fn);\n};\n\nconst removeEvent = element => (type, fn) => {\n    element.removeEventListener(type, fn);\n};\n\n// mixin\nconst listeners = ({\n    mixinConfig,\n    viewProps,\n    viewInternalAPI,\n    viewExternalAPI,\n    viewState,\n    view,\n}) => {\n    const events = [];\n\n    const add = addEvent(view.element);\n    const remove = removeEvent(view.element);\n\n    viewExternalAPI.on = (type, fn) => {\n        events.push({\n            type,\n            fn,\n        });\n        add(type, fn);\n    };\n\n    viewExternalAPI.off = (type, fn) => {\n        events.splice(events.findIndex(event => event.type === type && event.fn === fn), 1);\n        remove(type, fn);\n    };\n\n    return {\n        write: () => {\n            // not busy\n            return true;\n        },\n        destroy: () => {\n            events.forEach(event => {\n                remove(event.type, event.fn);\n            });\n        },\n    };\n};\n\n// add to external api and link to props\n\nconst apis = ({ mixinConfig, viewProps, viewExternalAPI }) => {\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\n};\n\nconst isDefined = value => value != null;\n\n// add to state,\n// add getters and setters to internal and external api (if not set)\n// set initial state based on props in viewProps\n// apply as transforms each frame\n\nconst defaults = {\n    opacity: 1,\n    scaleX: 1,\n    scaleY: 1,\n    translateX: 0,\n    translateY: 0,\n    rotateX: 0,\n    rotateY: 0,\n    rotateZ: 0,\n    originX: 0,\n    originY: 0,\n};\n\nconst styles = ({ mixinConfig, viewProps, viewInternalAPI, viewExternalAPI, view }) => {\n    // initial props\n    const initialProps = { ...viewProps };\n\n    // current props\n    const currentProps = {};\n\n    // we will add those properties to the external API and link them to the viewState\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);\n\n    // override rect on internal and external rect getter so it takes in account transforms\n    const getOffset = () => [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n    const getScale = () => [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n    const getRect = () =>\n        view.rect ? getViewRect(view.rect, view.childViews, getOffset(), getScale()) : null;\n    viewInternalAPI.rect = { get: getRect };\n    viewExternalAPI.rect = { get: getRect };\n\n    // apply view props\n    mixinConfig.forEach(key => {\n        viewProps[key] =\n            typeof initialProps[key] === 'undefined' ? defaults[key] : initialProps[key];\n    });\n\n    // expose api\n    return {\n        write: () => {\n            // see if props have changed\n            if (!propsHaveChanged(currentProps, viewProps)) {\n                return;\n            }\n\n            // moves element to correct position on screen\n            applyStyles(view.element, viewProps);\n\n            // store new transforms\n            Object.assign(currentProps, { ...viewProps });\n\n            // no longer busy\n            return true;\n        },\n        destroy: () => {},\n    };\n};\n\nconst propsHaveChanged = (currentProps, newProps) => {\n    // different amount of keys\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n        return true;\n    }\n\n    // lets analyze the individual props\n    for (const prop in newProps) {\n        if (newProps[prop] !== currentProps[prop]) {\n            return true;\n        }\n    }\n\n    return false;\n};\n\nconst applyStyles = (\n    element,\n    {\n        opacity,\n        perspective,\n        translateX,\n        translateY,\n        scaleX,\n        scaleY,\n        rotateX,\n        rotateY,\n        rotateZ,\n        originX,\n        originY,\n        width,\n        height,\n    }\n) => {\n    let transforms = '';\n    let styles = '';\n\n    // handle transform origin\n    if (isDefined(originX) || isDefined(originY)) {\n        styles += `transform-origin: ${originX || 0}px ${originY || 0}px;`;\n    }\n\n    // transform order is relevant\n    // 0. perspective\n    if (isDefined(perspective)) {\n        transforms += `perspective(${perspective}px) `;\n    }\n\n    // 1. translate\n    if (isDefined(translateX) || isDefined(translateY)) {\n        transforms += `translate3d(${translateX || 0}px, ${translateY || 0}px, 0) `;\n    }\n\n    // 2. scale\n    if (isDefined(scaleX) || isDefined(scaleY)) {\n        transforms += `scale3d(${isDefined(scaleX) ? scaleX : 1}, ${\n            isDefined(scaleY) ? scaleY : 1\n        }, 1) `;\n    }\n\n    // 3. rotate\n    if (isDefined(rotateZ)) {\n        transforms += `rotateZ(${rotateZ}rad) `;\n    }\n\n    if (isDefined(rotateX)) {\n        transforms += `rotateX(${rotateX}rad) `;\n    }\n\n    if (isDefined(rotateY)) {\n        transforms += `rotateY(${rotateY}rad) `;\n    }\n\n    // add transforms\n    if (transforms.length) {\n        styles += `transform:${transforms};`;\n    }\n\n    // add opacity\n    if (isDefined(opacity)) {\n        styles += `opacity:${opacity};`;\n\n        // if we reach zero, we make the element inaccessible\n        if (opacity === 0) {\n            styles += `visibility:hidden;`;\n        }\n\n        // if we're below 100% opacity this element can't be clicked\n        if (opacity < 1) {\n            styles += `pointer-events:none;`;\n        }\n    }\n\n    // add height\n    if (isDefined(height)) {\n        styles += `height:${height}px;`;\n    }\n\n    // add width\n    if (isDefined(width)) {\n        styles += `width:${width}px;`;\n    }\n\n    // apply styles\n    const elementCurrentStyle = element.elementCurrentStyle || '';\n\n    // if new styles does not match current styles, lets update!\n    if (styles.length !== elementCurrentStyle.length || styles !== elementCurrentStyle) {\n        element.style.cssText = styles;\n        // store current styles so we can compare them to new styles later on\n        // _not_ getting the style value is faster\n        element.elementCurrentStyle = styles;\n    }\n};\n\nconst Mixins = {\n    styles,\n    listeners,\n    animations,\n    apis,\n};\n\nconst updateRect = (rect = {}, element = {}, style = {}) => {\n    if (!element.layoutCalculated) {\n        rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n        rect.marginTop = parseInt(style.marginTop, 10) || 0;\n        rect.marginRight = parseInt(style.marginRight, 10) || 0;\n        rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n        rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n        element.layoutCalculated = true;\n    }\n\n    rect.left = element.offsetLeft || 0;\n    rect.top = element.offsetTop || 0;\n    rect.width = element.offsetWidth || 0;\n    rect.height = element.offsetHeight || 0;\n\n    rect.right = rect.left + rect.width;\n    rect.bottom = rect.top + rect.height;\n\n    rect.scrollTop = element.scrollTop;\n\n    rect.hidden = element.offsetParent === null;\n\n    return rect;\n};\n\nconst createView =\n    // default view definition\n    ({\n        // element definition\n        tag = 'div',\n        name = null,\n        attributes = {},\n\n        // view interaction\n        read = () => {},\n        write = () => {},\n        create = () => {},\n        destroy = () => {},\n\n        // hooks\n        filterFrameActionsForChild = (child, actions) => actions,\n        didCreateView = () => {},\n        didWriteView = () => {},\n\n        // rect related\n        ignoreRect = false,\n        ignoreRectUpdate = false,\n\n        // mixins\n        mixins = [],\n    } = {}) => (\n        // each view requires reference to store\n        store,\n        // specific properties for this view\n        props = {}\n    ) => {\n        // root element should not be changed\n        const element = createElement(tag, `filepond--${name}`, attributes);\n\n        // style reference should also not be changed\n        const style = window.getComputedStyle(element, null);\n\n        // element rectangle\n        const rect = updateRect();\n        let frameRect = null;\n\n        // rest state\n        let isResting = false;\n\n        // pretty self explanatory\n        const childViews = [];\n\n        // loaded mixins\n        const activeMixins = [];\n\n        // references to created children\n        const ref = {};\n\n        // state used for each instance\n        const state = {};\n\n        // list of writers that will be called to update this view\n        const writers = [\n            write, // default writer\n        ];\n\n        const readers = [\n            read, // default reader\n        ];\n\n        const destroyers = [\n            destroy, // default destroy\n        ];\n\n        // core view methods\n        const getElement = () => element;\n        const getChildViews = () => childViews.concat();\n        const getReference = () => ref;\n        const createChildView = store => (view, props) => view(store, props);\n        const getRect = () => {\n            if (frameRect) {\n                return frameRect;\n            }\n            frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n            return frameRect;\n        };\n        const getStyle = () => style;\n\n        /**\n         * Read data from DOM\n         * @private\n         */\n        const _read = () => {\n            frameRect = null;\n\n            // read child views\n            childViews.forEach(child => child._read());\n\n            const shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n            if (shouldUpdate) {\n                updateRect(rect, element, style);\n            }\n\n            // readers\n            const api = { root: internalAPI, props, rect };\n            readers.forEach(reader => reader(api));\n        };\n\n        /**\n         * Write data to DOM\n         * @private\n         */\n        const _write = (ts, frameActions, shouldOptimize) => {\n            // if no actions, we assume that the view is resting\n            let resting = frameActions.length === 0;\n\n            // writers\n            writers.forEach(writer => {\n                const writerResting = writer({\n                    props,\n                    root: internalAPI,\n                    actions: frameActions,\n                    timestamp: ts,\n                    shouldOptimize,\n                });\n                if (writerResting === false) {\n                    resting = false;\n                }\n            });\n\n            // run mixins\n            activeMixins.forEach(mixin => {\n                // if one of the mixins is still busy after write operation, we are not resting\n                const mixinResting = mixin.write(ts);\n                if (mixinResting === false) {\n                    resting = false;\n                }\n            });\n\n            // updates child views that are currently attached to the DOM\n            childViews\n                .filter(child => !!child.element.parentNode)\n                .forEach(child => {\n                    // if a child view is not resting, we are not resting\n                    const childResting = child._write(\n                        ts,\n                        filterFrameActionsForChild(child, frameActions),\n                        shouldOptimize\n                    );\n                    if (!childResting) {\n                        resting = false;\n                    }\n                });\n\n            // append new elements to DOM and update those\n            childViews\n                //.filter(child => !child.element.parentNode)\n                .forEach((child, index) => {\n                    // skip\n                    if (child.element.parentNode) {\n                        return;\n                    }\n\n                    // append to DOM\n                    internalAPI.appendChild(child.element, index);\n\n                    // call read (need to know the size of these elements)\n                    child._read();\n\n                    // re-call write\n                    child._write(\n                        ts,\n                        filterFrameActionsForChild(child, frameActions),\n                        shouldOptimize\n                    );\n\n                    // we just added somthing to the dom, no rest\n                    resting = false;\n                });\n\n            // update resting state\n            isResting = resting;\n\n            didWriteView({\n                props,\n                root: internalAPI,\n                actions: frameActions,\n                timestamp: ts,\n            });\n\n            // let parent know if we are resting\n            return resting;\n        };\n\n        const _destroy = () => {\n            activeMixins.forEach(mixin => mixin.destroy());\n            destroyers.forEach(destroyer => {\n                destroyer({ root: internalAPI, props });\n            });\n            childViews.forEach(child => child._destroy());\n        };\n\n        // sharedAPI\n        const sharedAPIDefinition = {\n            element: {\n                get: getElement,\n            },\n            style: {\n                get: getStyle,\n            },\n            childViews: {\n                get: getChildViews,\n            },\n        };\n\n        // private API definition\n        const internalAPIDefinition = {\n            ...sharedAPIDefinition,\n            rect: {\n                get: getRect,\n            },\n\n            // access to custom children references\n            ref: {\n                get: getReference,\n            },\n\n            // dom modifiers\n            is: needle => name === needle,\n            appendChild: appendChild(element),\n            createChildView: createChildView(store),\n            linkView: view => {\n                childViews.push(view);\n                return view;\n            },\n            unlinkView: view => {\n                childViews.splice(childViews.indexOf(view), 1);\n            },\n            appendChildView: appendChildView(element, childViews),\n            removeChildView: removeChildView(element, childViews),\n            registerWriter: writer => writers.push(writer),\n            registerReader: reader => readers.push(reader),\n            registerDestroyer: destroyer => destroyers.push(destroyer),\n            invalidateLayout: () => (element.layoutCalculated = false),\n\n            // access to data store\n            dispatch: store.dispatch,\n            query: store.query,\n        };\n\n        // public view API methods\n        const externalAPIDefinition = {\n            element: {\n                get: getElement,\n            },\n            childViews: {\n                get: getChildViews,\n            },\n            rect: {\n                get: getRect,\n            },\n            resting: {\n                get: () => isResting,\n            },\n            isRectIgnored: () => ignoreRect,\n            _read,\n            _write,\n            _destroy,\n        };\n\n        // mixin API methods\n        const mixinAPIDefinition = {\n            ...sharedAPIDefinition,\n            rect: {\n                get: () => rect,\n            },\n        };\n\n        // add mixin functionality\n        Object.keys(mixins)\n            .sort((a, b) => {\n                // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n                if (a === 'styles') {\n                    return 1;\n                } else if (b === 'styles') {\n                    return -1;\n                }\n                return 0;\n            })\n            .forEach(key => {\n                const mixinAPI = Mixins[key]({\n                    mixinConfig: mixins[key],\n                    viewProps: props,\n                    viewState: state,\n                    viewInternalAPI: internalAPIDefinition,\n                    viewExternalAPI: externalAPIDefinition,\n                    view: createObject(mixinAPIDefinition),\n                });\n\n                if (mixinAPI) {\n                    activeMixins.push(mixinAPI);\n                }\n            });\n\n        // construct private api\n        const internalAPI = createObject(internalAPIDefinition);\n\n        // create the view\n        create({\n            root: internalAPI,\n            props,\n        });\n\n        // append created child views to root node\n        const childCount = getChildCount(element); // need to know the current child count so appending happens in correct order\n        childViews.forEach((child, index) => {\n            internalAPI.appendChild(child.element, childCount + index);\n        });\n\n        // call did create\n        didCreateView(internalAPI);\n\n        // expose public api\n        return createObject(externalAPIDefinition);\n    };\n\nconst createPainter = (read, write, fps = 60) => {\n    const name = '__framePainter';\n\n    // set global painter\n    if (window[name]) {\n        window[name].readers.push(read);\n        window[name].writers.push(write);\n        return;\n    }\n\n    window[name] = {\n        readers: [read],\n        writers: [write],\n    };\n\n    const painter = window[name];\n\n    const interval = 1000 / fps;\n    let last = null;\n    let id = null;\n    let requestTick = null;\n    let cancelTick = null;\n\n    const setTimerType = () => {\n        if (document.hidden) {\n            requestTick = () => window.setTimeout(() => tick(performance.now()), interval);\n            cancelTick = () => window.clearTimeout(id);\n        } else {\n            requestTick = () => window.requestAnimationFrame(tick);\n            cancelTick = () => window.cancelAnimationFrame(id);\n        }\n    };\n\n    document.addEventListener('visibilitychange', () => {\n        if (cancelTick) cancelTick();\n        setTimerType();\n        tick(performance.now());\n    });\n\n    const tick = ts => {\n        // queue next tick\n        id = requestTick(tick);\n\n        // limit fps\n        if (!last) {\n            last = ts;\n        }\n\n        const delta = ts - last;\n\n        if (delta <= interval) {\n            // skip frame\n            return;\n        }\n\n        // align next frame\n        last = ts - (delta % interval);\n\n        // update view\n        painter.readers.forEach(read => read());\n        painter.writers.forEach(write => write(ts));\n    };\n\n    setTimerType();\n    tick(performance.now());\n\n    return {\n        pause: () => {\n            cancelTick(id);\n        },\n    };\n};\n\nconst createRoute = (routes, fn) => ({ root, props, actions = [], timestamp, shouldOptimize }) => {\n    actions\n        .filter(action => routes[action.type])\n        .forEach(action =>\n            routes[action.type]({ root, props, action: action.data, timestamp, shouldOptimize })\n        );\n    if (fn) {\n        fn({ root, props, actions, timestamp, shouldOptimize });\n    }\n};\n\nconst insertBefore = (newNode, referenceNode) =>\n    referenceNode.parentNode.insertBefore(newNode, referenceNode);\n\nconst insertAfter = (newNode, referenceNode) => {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n};\n\nconst isArray = value => Array.isArray(value);\n\nconst isEmpty = value => value == null;\n\nconst trim = str => str.trim();\n\nconst toString = value => '' + value;\n\nconst toArray = (value, splitter = ',') => {\n    if (isEmpty(value)) {\n        return [];\n    }\n    if (isArray(value)) {\n        return value;\n    }\n    return toString(value)\n        .split(splitter)\n        .map(trim)\n        .filter(str => str.length);\n};\n\nconst isBoolean = value => typeof value === 'boolean';\n\nconst toBoolean = value => (isBoolean(value) ? value : value === 'true');\n\nconst isString = value => typeof value === 'string';\n\nconst toNumber = value =>\n    isNumber(value) ? value : isString(value) ? toString(value).replace(/[a-z]+/gi, '') : 0;\n\nconst toInt = value => parseInt(toNumber(value), 10);\n\nconst toFloat = value => parseFloat(toNumber(value));\n\nconst isInt = value => isNumber(value) && isFinite(value) && Math.floor(value) === value;\n\nconst toBytes = (value, base = 1000) => {\n    // is in bytes\n    if (isInt(value)) {\n        return value;\n    }\n\n    // is natural file size\n    let naturalFileSize = toString(value).trim();\n\n    // if is value in megabytes\n    if (/MB$/i.test(naturalFileSize)) {\n        naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n        return toInt(naturalFileSize) * base * base;\n    }\n\n    // if is value in kilobytes\n    if (/KB/i.test(naturalFileSize)) {\n        naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n        return toInt(naturalFileSize) * base;\n    }\n\n    return toInt(naturalFileSize);\n};\n\nconst isFunction = value => typeof value === 'function';\n\nconst toFunctionReference = string => {\n    let ref = self;\n    let levels = string.split('.');\n    let level = null;\n    while ((level = levels.shift())) {\n        ref = ref[level];\n        if (!ref) {\n            return null;\n        }\n    }\n    return ref;\n};\n\nconst methods = {\n    process: 'POST',\n    patch: 'PATCH',\n    revert: 'DELETE',\n    fetch: 'GET',\n    restore: 'GET',\n    load: 'GET',\n};\n\nconst createServerAPI = outline => {\n    const api = {};\n\n    api.url = isString(outline) ? outline : outline.url || '';\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n    api.headers = outline.headers ? outline.headers : {};\n\n    forin(methods, key => {\n        api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);\n    });\n\n    // remove process if no url or process on outline\n    api.process = outline.process || isString(outline) || outline.url ? api.process : null;\n\n    // special treatment for remove\n    api.remove = outline.remove || null;\n\n    // remove generic headers from api object\n    delete api.headers;\n\n    return api;\n};\n\nconst createAction = (name, outline, method, timeout, headers) => {\n    // is explicitely set to null so disable\n    if (outline === null) {\n        return null;\n    }\n\n    // if is custom function, done! Dev handles everything.\n    if (typeof outline === 'function') {\n        return outline;\n    }\n\n    // build action object\n    const action = {\n        url: method === 'GET' || method === 'PATCH' ? `?${name}=` : '',\n        method,\n        headers,\n        withCredentials: false,\n        timeout,\n        onload: null,\n        ondata: null,\n        onerror: null,\n    };\n\n    // is a single url\n    if (isString(outline)) {\n        action.url = outline;\n        return action;\n    }\n\n    // overwrite\n    Object.assign(action, outline);\n\n    // see if should reformat headers;\n    if (isString(action.headers)) {\n        const parts = action.headers.split(/:(.+)/);\n        action.headers = {\n            header: parts[0],\n            value: parts[1],\n        };\n    }\n\n    // if is bool withCredentials\n    action.withCredentials = toBoolean(action.withCredentials);\n\n    return action;\n};\n\nconst toServerAPI = value => createServerAPI(value);\n\nconst isNull = value => value === null;\n\nconst isObject = value => typeof value === 'object' && value !== null;\n\nconst isAPI = value => {\n    return (\n        isObject(value) &&\n        isString(value.url) &&\n        isObject(value.process) &&\n        isObject(value.revert) &&\n        isObject(value.restore) &&\n        isObject(value.fetch)\n    );\n};\n\nconst getType = value => {\n    if (isArray(value)) {\n        return 'array';\n    }\n\n    if (isNull(value)) {\n        return 'null';\n    }\n\n    if (isInt(value)) {\n        return 'int';\n    }\n\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n        return 'bytes';\n    }\n\n    if (isAPI(value)) {\n        return 'api';\n    }\n\n    return typeof value;\n};\n\nconst replaceSingleQuotes = str =>\n    str\n        .replace(/{\\s*'/g, '{\"')\n        .replace(/'\\s*}/g, '\"}')\n        .replace(/'\\s*:/g, '\":')\n        .replace(/:\\s*'/g, ':\"')\n        .replace(/,\\s*'/g, ',\"')\n        .replace(/'\\s*,/g, '\",');\n\nconst conversionTable = {\n    array: toArray,\n    boolean: toBoolean,\n    int: value => (getType(value) === 'bytes' ? toBytes(value) : toInt(value)),\n    number: toFloat,\n    float: toFloat,\n    bytes: toBytes,\n    string: value => (isFunction(value) ? value : toString(value)),\n    function: value => toFunctionReference(value),\n    serverapi: toServerAPI,\n    object: value => {\n        try {\n            return JSON.parse(replaceSingleQuotes(value));\n        } catch (e) {\n            return null;\n        }\n    },\n};\n\nconst convertTo = (value, type) => conversionTable[type](value);\n\nconst getValueByType = (newValue, defaultValue, valueType) => {\n    // can always assign default value\n    if (newValue === defaultValue) {\n        return newValue;\n    }\n\n    // get the type of the new value\n    let newValueType = getType(newValue);\n\n    // is valid type?\n    if (newValueType !== valueType) {\n        // is string input, let's attempt to convert\n        const convertedValue = convertTo(newValue, valueType);\n\n        // what is the type now\n        newValueType = getType(convertedValue);\n\n        // no valid conversions found\n        if (convertedValue === null) {\n            throw `Trying to assign value with incorrect type to \"${option}\", allowed type: \"${valueType}\"`;\n        } else {\n            newValue = convertedValue;\n        }\n    }\n\n    // assign new value\n    return newValue;\n};\n\nconst createOption = (defaultValue, valueType) => {\n    let currentValue = defaultValue;\n    return {\n        enumerable: true,\n        get: () => currentValue,\n        set: newValue => {\n            currentValue = getValueByType(newValue, defaultValue, valueType);\n        },\n    };\n};\n\nconst createOptions = options => {\n    const obj = {};\n    forin(options, prop => {\n        const optionDefinition = options[prop];\n        obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n    });\n    return createObject(obj);\n};\n\nconst createInitialState = options => ({\n    // model\n    items: [],\n\n    // timeout used for calling update items\n    listUpdateTimeout: null,\n\n    // timeout used for stacking metadata updates\n    itemUpdateTimeout: null,\n\n    // queue of items waiting to be processed\n    processingQueue: [],\n\n    // options\n    options: createOptions(options),\n});\n\nconst fromCamels = (string, separator = '-') =>\n    string\n        .split(/(?=[A-Z])/)\n        .map(part => part.toLowerCase())\n        .join(separator);\n\nconst createOptionAPI = (store, options) => {\n    const obj = {};\n    forin(options, key => {\n        obj[key] = {\n            get: () => store.getState().options[key],\n            set: value => {\n                store.dispatch(`SET_${fromCamels(key, '_').toUpperCase()}`, {\n                    value,\n                });\n            },\n        };\n    });\n    return obj;\n};\n\nconst createOptionActions = options => (dispatch, query, state) => {\n    const obj = {};\n    forin(options, key => {\n        const name = fromCamels(key, '_').toUpperCase();\n\n        obj[`SET_${name}`] = action => {\n            try {\n                state.options[key] = action.value;\n            } catch (e) {\n                // nope, failed\n            }\n\n            // we successfully set the value of this option\n            dispatch(`DID_SET_${name}`, { value: state.options[key] });\n        };\n    });\n    return obj;\n};\n\nconst createOptionQueries = options => state => {\n    const obj = {};\n    forin(options, key => {\n        obj[`GET_${fromCamels(key, '_').toUpperCase()}`] = action => state.options[key];\n    });\n    return obj;\n};\n\nconst InteractionMethod = {\n    API: 1,\n    DROP: 2,\n    BROWSE: 3,\n    PASTE: 4,\n    NONE: 5,\n};\n\nconst getUniqueId = () =>\n    Math.random()\n        .toString(36)\n        .substring(2, 11);\n\nconst arrayRemove = (arr, index) => arr.splice(index, 1);\n\nconst run = (cb, sync) => {\n    if (sync) {\n        cb();\n    } else if (document.hidden) {\n        Promise.resolve(1).then(cb);\n    } else {\n        setTimeout(cb, 0);\n    }\n};\n\nconst on = () => {\n    const listeners = [];\n    const off = (event, cb) => {\n        arrayRemove(\n            listeners,\n            listeners.findIndex(listener => listener.event === event && (listener.cb === cb || !cb))\n        );\n    };\n    const fire = (event, args, sync) => {\n        listeners\n            .filter(listener => listener.event === event)\n            .map(listener => listener.cb)\n            .forEach(cb => run(() => cb(...args), sync));\n    };\n    return {\n        fireSync: (event, ...args) => {\n            fire(event, args, true);\n        },\n        fire: (event, ...args) => {\n            fire(event, args, false);\n        },\n        on: (event, cb) => {\n            listeners.push({ event, cb });\n        },\n        onOnce: (event, cb) => {\n            listeners.push({\n                event,\n                cb: (...args) => {\n                    off(event, cb);\n                    cb(...args);\n                },\n            });\n        },\n        off,\n    };\n};\n\nconst copyObjectPropertiesToObject = (src, target, excluded) => {\n    Object.getOwnPropertyNames(src)\n        .filter(property => !excluded.includes(property))\n        .forEach(key =>\n            Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(src, key))\n        );\n};\n\nconst PRIVATE = [\n    'fire',\n    'process',\n    'revert',\n    'load',\n    'on',\n    'off',\n    'onOnce',\n    'retryLoad',\n    'extend',\n    'archive',\n    'archived',\n    'release',\n    'released',\n    'requestProcessing',\n    'freeze',\n];\n\nconst createItemAPI = item => {\n    const api = {};\n    copyObjectPropertiesToObject(item, api, PRIVATE);\n    return api;\n};\n\nconst removeReleasedItems = items => {\n    items.forEach((item, index) => {\n        if (item.released) {\n            arrayRemove(items, index);\n        }\n    });\n};\n\nconst ItemStatus = {\n    INIT: 1,\n    IDLE: 2,\n    PROCESSING_QUEUED: 9,\n    PROCESSING: 3,\n    PROCESSING_COMPLETE: 5,\n    PROCESSING_ERROR: 6,\n    PROCESSING_REVERT_ERROR: 10,\n    LOADING: 7,\n    LOAD_ERROR: 8,\n};\n\nconst FileOrigin = {\n    INPUT: 1,\n    LIMBO: 2,\n    LOCAL: 3,\n};\n\nconst getNonNumeric = str => /[^0-9]+/.exec(str);\n\nconst getDecimalSeparator = () => getNonNumeric((1.1).toLocaleString())[0];\n\nconst getThousandsSeparator = () => {\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n    const decimalSeparator = getDecimalSeparator();\n    const thousandsStringWithSeparator = (1000.0).toLocaleString();\n    const thousandsStringWithoutSeparator = (1000.0).toString();\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n        return getNonNumeric(thousandsStringWithSeparator)[0];\n    }\n    return decimalSeparator === '.' ? ',' : '.';\n};\n\nconst Type = {\n    BOOLEAN: 'boolean',\n    INT: 'int',\n    NUMBER: 'number',\n    STRING: 'string',\n    ARRAY: 'array',\n    OBJECT: 'object',\n    FUNCTION: 'function',\n    ACTION: 'action',\n    SERVER_API: 'serverapi',\n    REGEX: 'regex',\n};\n\n// all registered filters\nconst filters = [];\n\n// loops over matching filters and passes options to each filter, returning the mapped results\nconst applyFilterChain = (key, value, utils) =>\n    new Promise((resolve, reject) => {\n        // find matching filters for this key\n        const matchingFilters = filters.filter(f => f.key === key).map(f => f.cb);\n\n        // resolve now\n        if (matchingFilters.length === 0) {\n            resolve(value);\n            return;\n        }\n\n        // first filter to kick things of\n        const initialFilter = matchingFilters.shift();\n\n        // chain filters\n        matchingFilters\n            .reduce(\n                // loop over promises passing value to next promise\n                (current, next) => current.then(value => next(value, utils)),\n\n                // call initial filter, will return a promise\n                initialFilter(value, utils)\n\n                // all executed\n            )\n            .then(value => resolve(value))\n            .catch(error => reject(error));\n    });\n\nconst applyFilters = (key, value, utils) =>\n    filters.filter(f => f.key === key).map(f => f.cb(value, utils));\n\n// adds a new filter to the list\nconst addFilter = (key, cb) => filters.push({ key, cb });\n\nconst extendDefaultOptions = additionalOptions => Object.assign(defaultOptions, additionalOptions);\n\nconst getOptions = () => ({ ...defaultOptions });\n\nconst setOptions = opts => {\n    forin(opts, (key, value) => {\n        // key does not exist, so this option cannot be set\n        if (!defaultOptions[key]) {\n            return;\n        }\n        defaultOptions[key][0] = getValueByType(\n            value,\n            defaultOptions[key][0],\n            defaultOptions[key][1]\n        );\n    });\n};\n\n// default options on app\nconst defaultOptions = {\n    // the id to add to the root element\n    id: [null, Type.STRING],\n\n    // input field name to use\n    name: ['filepond', Type.STRING],\n\n    // disable the field\n    disabled: [false, Type.BOOLEAN],\n\n    // classname to put on wrapper\n    className: [null, Type.STRING],\n\n    // is the field required\n    required: [false, Type.BOOLEAN],\n\n    // Allow media capture when value is set\n    captureMethod: [null, Type.STRING],\n    // - \"camera\", \"microphone\" or \"camcorder\",\n    // - Does not work with multiple on apple devices\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n\n    // sync `acceptedFileTypes` property with `accept` attribute\n    allowSyncAcceptAttribute: [true, Type.BOOLEAN],\n\n    // Feature toggles\n    allowDrop: [true, Type.BOOLEAN], // Allow dropping of files\n    allowBrowse: [true, Type.BOOLEAN], // Allow browsing the file system\n    allowPaste: [true, Type.BOOLEAN], // Allow pasting files\n    allowMultiple: [false, Type.BOOLEAN], // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n    allowReplace: [true, Type.BOOLEAN], // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n    allowRevert: [true, Type.BOOLEAN], // Allows user to revert file upload\n    allowRemove: [true, Type.BOOLEAN], // Allow user to remove a file\n    allowProcess: [true, Type.BOOLEAN], // Allows user to process a file, when set to false, this removes the file upload button\n    allowReorder: [false, Type.BOOLEAN], // Allow reordering of files\n    allowDirectoriesOnly: [false, Type.BOOLEAN], // Allow only selecting directories with browse (no support for filtering dnd at this point)\n\n    // Try store file if `server` not set\n    storeAsFile: [false, Type.BOOLEAN],\n\n    // Revert mode\n    forceRevert: [false, Type.BOOLEAN], // Set to 'force' to require the file to be reverted before removal\n\n    // Input requirements\n    maxFiles: [null, Type.INT], // Max number of files\n    checkValidity: [false, Type.BOOLEAN], // Enables custom validity messages\n\n    // Where to put file\n    itemInsertLocationFreedom: [true, Type.BOOLEAN], // Set to false to always add items to begin or end of list\n    itemInsertLocation: ['before', Type.STRING], // Default index in list to add items that have been dropped at the top of the list\n    itemInsertInterval: [75, Type.INT],\n\n    // Drag 'n Drop related\n    dropOnPage: [false, Type.BOOLEAN], // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n    dropOnElement: [true, Type.BOOLEAN], // Drop needs to happen on element (set to false to also load drops outside of Up)\n    dropValidation: [false, Type.BOOLEAN], // Enable or disable validating files on drop\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n\n    // Upload related\n    instantUpload: [true, Type.BOOLEAN], // Should upload files immediately on drop\n    maxParallelUploads: [2, Type.INT], // Maximum files to upload in parallel\n    allowMinimumUploadDuration: [true, Type.BOOLEAN], // if true uploads take at least 750 ms, this ensures the user sees the upload progress giving trust the upload actually happened\n\n    // Chunks\n    chunkUploads: [false, Type.BOOLEAN], // Enable chunked uploads\n    chunkForce: [false, Type.BOOLEAN], // Force use of chunk uploads even for files smaller than chunk size\n    chunkSize: [5000000, Type.INT], // Size of chunks (5MB default)\n    chunkRetryDelays: [[500, 1000, 3000], Type.ARRAY], // Amount of times to retry upload of a chunk when it fails\n\n    // The server api end points to use for uploading (see docs)\n    server: [null, Type.SERVER_API],\n\n    // File size calculations, can set to 1024, this is only used for display, properties use file size base 1000\n    fileSizeBase: [1000, Type.INT],\n\n    // Labels and status messages\n    labelFileSizeBytes: ['bytes', Type.STRING],\n    labelFileSizeKilobytes: ['KB', Type.STRING],\n    labelFileSizeMegabytes: ['MB', Type.STRING],\n    labelFileSizeGigabytes: ['GB', Type.STRING],\n\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING], // Default is locale separator\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING], // Default is locale separator\n\n    labelIdle: [\n        'Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>',\n        Type.STRING,\n    ],\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n    labelFileCountSingular: ['file in list', Type.STRING],\n    labelFileCountPlural: ['files in list', Type.STRING],\n    labelFileLoading: ['Loading', Type.STRING],\n    labelFileAdded: ['Added', Type.STRING], // assistive only\n    labelFileLoadError: ['Error during load', Type.STRING],\n    labelFileRemoved: ['Removed', Type.STRING], // assistive only\n    labelFileRemoveError: ['Error during remove', Type.STRING],\n    labelFileProcessing: ['Uploading', Type.STRING],\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n    labelFileProcessingError: ['Error during upload', Type.STRING],\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n\n    labelTapToCancel: ['tap to cancel', Type.STRING],\n    labelTapToRetry: ['tap to retry', Type.STRING],\n    labelTapToUndo: ['tap to undo', Type.STRING],\n\n    labelButtonRemoveItem: ['Remove', Type.STRING],\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n    labelButtonProcessItem: ['Upload', Type.STRING],\n\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\n    iconRemove: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n        Type.STRING,\n    ],\n    iconProcess: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>',\n        Type.STRING,\n    ],\n    iconRetry: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n        Type.STRING,\n    ],\n    iconUndo: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n        Type.STRING,\n    ],\n    iconDone: [\n        '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n        Type.STRING,\n    ],\n\n    // event handlers\n    oninit: [null, Type.FUNCTION],\n    onwarning: [null, Type.FUNCTION],\n    onerror: [null, Type.FUNCTION],\n    onactivatefile: [null, Type.FUNCTION],\n    oninitfile: [null, Type.FUNCTION],\n    onaddfilestart: [null, Type.FUNCTION],\n    onaddfileprogress: [null, Type.FUNCTION],\n    onaddfile: [null, Type.FUNCTION],\n    onprocessfilestart: [null, Type.FUNCTION],\n    onprocessfileprogress: [null, Type.FUNCTION],\n    onprocessfileabort: [null, Type.FUNCTION],\n    onprocessfilerevert: [null, Type.FUNCTION],\n    onprocessfile: [null, Type.FUNCTION],\n    onprocessfiles: [null, Type.FUNCTION],\n    onremovefile: [null, Type.FUNCTION],\n    onpreparefile: [null, Type.FUNCTION],\n    onupdatefiles: [null, Type.FUNCTION],\n    onreorderfiles: [null, Type.FUNCTION],\n\n    // hooks\n    beforeDropFile: [null, Type.FUNCTION],\n    beforeAddFile: [null, Type.FUNCTION],\n    beforeRemoveFile: [null, Type.FUNCTION],\n    beforePrepareFile: [null, Type.FUNCTION],\n\n    // styles\n    stylePanelLayout: [null, Type.STRING], // null 'integrated', 'compact', 'circle'\n    stylePanelAspectRatio: [null, Type.STRING], // null or '3:2' or 1\n    styleItemPanelAspectRatio: [null, Type.STRING],\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\n    styleButtonProcessItemPosition: ['right', Type.STRING],\n    styleLoadIndicatorPosition: ['right', Type.STRING],\n    styleProgressIndicatorPosition: ['right', Type.STRING],\n    styleButtonRemoveItemAlign: [false, Type.BOOLEAN],\n\n    // custom initial files array\n    files: [[], Type.ARRAY],\n\n    // show support by displaying credits\n    credits: [['https://pqina.nl/', 'Powered by PQINA'], Type.ARRAY],\n};\n\nconst getItemByQuery = (items, query) => {\n    // just return first index\n    if (isEmpty(query)) {\n        return items[0] || null;\n    }\n\n    // query is index\n    if (isInt(query)) {\n        return items[query] || null;\n    }\n\n    // if query is item, get the id\n    if (typeof query === 'object') {\n        query = query.id;\n    }\n\n    // assume query is a string and return item by id\n    return items.find(item => item.id === query) || null;\n};\n\nconst getNumericAspectRatioFromString = aspectRatio => {\n    if (isEmpty(aspectRatio)) {\n        return aspectRatio;\n    }\n    if (/:/.test(aspectRatio)) {\n        const parts = aspectRatio.split(':');\n        return parts[1] / parts[0];\n    }\n    return parseFloat(aspectRatio);\n};\n\nconst getActiveItems = items => items.filter(item => !item.archived);\n\nconst Status = {\n    EMPTY: 0,\n    IDLE: 1, // waiting\n    ERROR: 2, // a file is in error state\n    BUSY: 3, // busy processing or loading\n    READY: 4, // all files uploaded\n};\n\nlet res = null;\nconst canUpdateFileInput = () => {\n    if (res === null) {\n        try {\n            const dataTransfer = new DataTransfer();\n            dataTransfer.items.add(new File(['hello world'], 'This_Works.txt'));\n            const el = document.createElement('input');\n            el.setAttribute('type', 'file');\n            el.files = dataTransfer.files;\n            res = el.files.length === 1;\n        } catch (err) {\n            res = false;\n        }\n    }\n    return res;\n};\n\nconst ITEM_ERROR = [\n    ItemStatus.LOAD_ERROR,\n    ItemStatus.PROCESSING_ERROR,\n    ItemStatus.PROCESSING_REVERT_ERROR,\n];\nconst ITEM_BUSY = [\n    ItemStatus.LOADING,\n    ItemStatus.PROCESSING,\n    ItemStatus.PROCESSING_QUEUED,\n    ItemStatus.INIT,\n];\nconst ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n\nconst isItemInErrorState = item => ITEM_ERROR.includes(item.status);\nconst isItemInBusyState = item => ITEM_BUSY.includes(item.status);\nconst isItemInReadyState = item => ITEM_READY.includes(item.status);\n\nconst isAsync = state =>\n    isObject(state.options.server) &&\n    (isObject(state.options.server.process) || isFunction(state.options.server.process));\n\nconst queries = state => ({\n    GET_STATUS: () => {\n        const items = getActiveItems(state.items);\n\n        const { EMPTY, ERROR, BUSY, IDLE, READY } = Status;\n\n        if (items.length === 0) return EMPTY;\n\n        if (items.some(isItemInErrorState)) return ERROR;\n\n        if (items.some(isItemInBusyState)) return BUSY;\n\n        if (items.some(isItemInReadyState)) return READY;\n\n        return IDLE;\n    },\n\n    GET_ITEM: query => getItemByQuery(state.items, query),\n\n    GET_ACTIVE_ITEM: query => getItemByQuery(getActiveItems(state.items), query),\n\n    GET_ACTIVE_ITEMS: () => getActiveItems(state.items),\n\n    GET_ITEMS: () => state.items,\n\n    GET_ITEM_NAME: query => {\n        const item = getItemByQuery(state.items, query);\n        return item ? item.filename : null;\n    },\n\n    GET_ITEM_SIZE: query => {\n        const item = getItemByQuery(state.items, query);\n        return item ? item.fileSize : null;\n    },\n\n    GET_STYLES: () =>\n        Object.keys(state.options)\n            .filter(key => /^style/.test(key))\n            .map(option => ({\n                name: option,\n                value: state.options[option],\n            })),\n\n    GET_PANEL_ASPECT_RATIO: () => {\n        const isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n        const aspectRatio = isShapeCircle\n            ? 1\n            : getNumericAspectRatioFromString(state.options.stylePanelAspectRatio);\n        return aspectRatio;\n    },\n\n    GET_ITEM_PANEL_ASPECT_RATIO: () => state.options.styleItemPanelAspectRatio,\n\n    GET_ITEMS_BY_STATUS: status =>\n        getActiveItems(state.items).filter(item => item.status === status),\n\n    GET_TOTAL_ITEMS: () => getActiveItems(state.items).length,\n\n    SHOULD_UPDATE_FILE_INPUT: () =>\n        state.options.storeAsFile && canUpdateFileInput() && !isAsync(state),\n\n    IS_ASYNC: () => isAsync(state),\n\n    GET_FILE_SIZE_LABELS: query => ({\n        labelBytes: query('GET_LABEL_FILE_SIZE_BYTES') || undefined,\n        labelKilobytes: query('GET_LABEL_FILE_SIZE_KILOBYTES') || undefined,\n        labelMegabytes: query('GET_LABEL_FILE_SIZE_MEGABYTES') || undefined,\n        labelGigabytes: query('GET_LABEL_FILE_SIZE_GIGABYTES') || undefined,\n    }),\n});\n\nconst hasRoomForItem = state => {\n    const count = getActiveItems(state.items).length;\n\n    // if cannot have multiple items, to add one item it should currently not contain items\n    if (!state.options.allowMultiple) {\n        return count === 0;\n    }\n\n    // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n    const maxFileCount = state.options.maxFiles;\n    if (maxFileCount === null) {\n        return true;\n    }\n\n    // we check if the current count is smaller than the max count, if so, another file can still be added\n    if (count < maxFileCount) {\n        return true;\n    }\n\n    // no more room for another file\n    return false;\n};\n\nconst limit = (value, min, max) => Math.max(Math.min(max, value), min);\n\nconst arrayInsert = (arr, index, item) => arr.splice(index, 0, item);\n\nconst insertItem = (items, item, index) => {\n    if (isEmpty(item)) {\n        return null;\n    }\n\n    // if index is undefined, append\n    if (typeof index === 'undefined') {\n        items.push(item);\n        return item;\n    }\n\n    // limit the index to the size of the items array\n    index = limit(index, 0, items.length);\n\n    // add item to array\n    arrayInsert(items, index, item);\n\n    // expose\n    return item;\n};\n\nconst isBase64DataURI = str =>\n    /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(\n        str\n    );\n\nconst getFilenameFromURL = url =>\n    `${url}`\n        .split('/')\n        .pop()\n        .split('?')\n        .shift();\n\nconst getExtensionFromFilename = name => name.split('.').pop();\n\nconst guesstimateExtension = type => {\n    // if no extension supplied, exit here\n    if (typeof type !== 'string') {\n        return '';\n    }\n\n    // get subtype\n    const subtype = type.split('/').pop();\n\n    // is svg subtype\n    if (/svg/.test(subtype)) {\n        return 'svg';\n    }\n\n    if (/zip|compressed/.test(subtype)) {\n        return 'zip';\n    }\n\n    if (/plain/.test(subtype)) {\n        return 'txt';\n    }\n\n    if (/msword/.test(subtype)) {\n        return 'doc';\n    }\n\n    // if is valid subtype\n    if (/[a-z]+/.test(subtype)) {\n        // always use jpg extension\n        if (subtype === 'jpeg') {\n            return 'jpg';\n        }\n\n        // return subtype\n        return subtype;\n    }\n\n    return '';\n};\n\nconst leftPad = (value, padding = '') => (padding + value).slice(-padding.length);\n\nconst getDateString = (date = new Date()) =>\n    `${date.getFullYear()}-${leftPad(date.getMonth() + 1, '00')}-${leftPad(\n        date.getDate(),\n        '00'\n    )}_${leftPad(date.getHours(), '00')}-${leftPad(date.getMinutes(), '00')}-${leftPad(\n        date.getSeconds(),\n        '00'\n    )}`;\n\nconst getFileFromBlob = (blob, filename, type = null, extension = null) => {\n    const file =\n        typeof type === 'string'\n            ? blob.slice(0, blob.size, type)\n            : blob.slice(0, blob.size, blob.type);\n    file.lastModifiedDate = new Date();\n\n    // copy relative path\n    if (blob._relativePath) file._relativePath = blob._relativePath;\n\n    // if blob has name property, use as filename if no filename supplied\n    if (!isString(filename)) {\n        filename = getDateString();\n    }\n\n    // if filename supplied but no extension and filename has extension\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\n        file.name = filename;\n    } else {\n        extension = extension || guesstimateExtension(file.type);\n        file.name = filename + (extension ? '.' + extension : '');\n    }\n\n    return file;\n};\n\nconst getBlobBuilder = () => {\n    return (window.BlobBuilder =\n        window.BlobBuilder ||\n        window.WebKitBlobBuilder ||\n        window.MozBlobBuilder ||\n        window.MSBlobBuilder);\n};\n\nconst createBlob = (arrayBuffer, mimeType) => {\n    const BB = getBlobBuilder();\n\n    if (BB) {\n        const bb = new BB();\n        bb.append(arrayBuffer);\n        return bb.getBlob(mimeType);\n    }\n\n    return new Blob([arrayBuffer], {\n        type: mimeType,\n    });\n};\n\nconst getBlobFromByteStringWithMimeType = (byteString, mimeType) => {\n    const ab = new ArrayBuffer(byteString.length);\n    const ia = new Uint8Array(ab);\n\n    for (let i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i);\n    }\n\n    return createBlob(ab, mimeType);\n};\n\nconst getMimeTypeFromBase64DataURI = dataURI => {\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n};\n\nconst getBase64DataFromBase64DataURI = dataURI => {\n    // get data part of string (remove data:image/jpeg...,)\n    const data = dataURI.split(',')[1];\n\n    // remove any whitespace as that causes InvalidCharacterError in IE\n    return data.replace(/\\s/g, '');\n};\n\nconst getByteStringFromBase64DataURI = dataURI => {\n    return atob(getBase64DataFromBase64DataURI(dataURI));\n};\n\nconst getBlobFromBase64DataURI = dataURI => {\n    const mimeType = getMimeTypeFromBase64DataURI(dataURI);\n    const byteString = getByteStringFromBase64DataURI(dataURI);\n\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\n};\n\nconst getFileFromBase64DataURI = (dataURI, filename, extension) => {\n    return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);\n};\n\nconst getFileNameFromHeader = header => {\n    // test if is content disposition header, if not exit\n    if (!/^content-disposition:/i.test(header)) return null;\n\n    // get filename parts\n    const matches = header\n        .split(/filename=|filename\\*=.+''/)\n        .splice(1)\n        .map(name => name.trim().replace(/^[\"']|[;\"']{0,2}$/g, ''))\n        .filter(name => name.length);\n\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n};\n\nconst getFileSizeFromHeader = header => {\n    if (/content-length:/i.test(header)) {\n        const size = header.match(/[0-9]+/)[0];\n        return size ? parseInt(size, 10) : null;\n    }\n    return null;\n};\n\nconst getTranfserIdFromHeader = header => {\n    if (/x-content-transfer-id:/i.test(header)) {\n        const id = (header.split(':')[1] || '').trim();\n        return id || null;\n    }\n    return null;\n};\n\nconst getFileInfoFromHeaders = headers => {\n    const info = {\n        source: null,\n        name: null,\n        size: null,\n    };\n\n    const rows = headers.split('\\n');\n    for (let header of rows) {\n        const name = getFileNameFromHeader(header);\n        if (name) {\n            info.name = name;\n            continue;\n        }\n\n        const size = getFileSizeFromHeader(header);\n        if (size) {\n            info.size = size;\n            continue;\n        }\n\n        const source = getTranfserIdFromHeader(header);\n        if (source) {\n            info.source = source;\n            continue;\n        }\n    }\n\n    return info;\n};\n\nconst createFileLoader = fetchFn => {\n    const state = {\n        source: null,\n        complete: false,\n        progress: 0,\n        size: null,\n        timestamp: null,\n        duration: 0,\n        request: null,\n    };\n\n    const getProgress = () => state.progress;\n    const abort = () => {\n        if (state.request && state.request.abort) {\n            state.request.abort();\n        }\n    };\n\n    // load source\n    const load = () => {\n        // get quick reference\n        const source = state.source;\n\n        api.fire('init', source);\n\n        // Load Files\n        if (source instanceof File) {\n            api.fire('load', source);\n        } else if (source instanceof Blob) {\n            // Load blobs, set default name to current date\n            api.fire('load', getFileFromBlob(source, source.name));\n        } else if (isBase64DataURI(source)) {\n            // Load base 64, set default name to current date\n            api.fire('load', getFileFromBase64DataURI(source));\n        } else {\n            // Deal as if is external URL, let's load it!\n            loadURL(source);\n        }\n    };\n\n    // loads a url\n    const loadURL = url => {\n        // is remote url and no fetch method supplied\n        if (!fetchFn) {\n            api.fire('error', {\n                type: 'error',\n                body: \"Can't load URL\",\n                code: 400,\n            });\n            return;\n        }\n\n        // set request start\n        state.timestamp = Date.now();\n\n        // load file\n        state.request = fetchFn(\n            url,\n            response => {\n                // update duration\n                state.duration = Date.now() - state.timestamp;\n\n                // done!\n                state.complete = true;\n\n                // turn blob response into a file\n                if (response instanceof Blob) {\n                    response = getFileFromBlob(response, response.name || getFilenameFromURL(url));\n                }\n\n                api.fire(\n                    'load',\n                    // if has received blob, we go with blob, if no response, we return null\n                    response instanceof Blob ? response : response ? response.body : null\n                );\n            },\n            error => {\n                api.fire(\n                    'error',\n                    typeof error === 'string'\n                        ? {\n                              type: 'error',\n                              code: 0,\n                              body: error,\n                          }\n                        : error\n                );\n            },\n            (computable, current, total) => {\n                // collected some meta data already\n                if (total) {\n                    state.size = total;\n                }\n\n                // update duration\n                state.duration = Date.now() - state.timestamp;\n\n                // if we can't compute progress, we're not going to fire progress events\n                if (!computable) {\n                    state.progress = null;\n                    return;\n                }\n\n                // update progress percentage\n                state.progress = current / total;\n\n                // expose\n                api.fire('progress', state.progress);\n            },\n            () => {\n                api.fire('abort');\n            },\n            response => {\n                const fileinfo = getFileInfoFromHeaders(\n                    typeof response === 'string' ? response : response.headers\n                );\n                api.fire('meta', {\n                    size: state.size || fileinfo.size,\n                    filename: fileinfo.name,\n                    source: fileinfo.source,\n                });\n            }\n        );\n    };\n\n    const api = {\n        ...on(),\n        setSource: source => (state.source = source),\n        getProgress, // file load progress\n        abort, // abort file load\n        load, // start load\n    };\n\n    return api;\n};\n\nconst isGet = method => /GET|HEAD/.test(method);\n\nconst sendRequest = (data, url, options) => {\n    const api = {\n        onheaders: () => {},\n        onprogress: () => {},\n        onload: () => {},\n        ontimeout: () => {},\n        onerror: () => {},\n        onabort: () => {},\n        abort: () => {\n            aborted = true;\n            xhr.abort();\n        },\n    };\n\n    // timeout identifier, only used when timeout is defined\n    let aborted = false;\n    let headersReceived = false;\n\n    // set default options\n    options = {\n        method: 'POST',\n        headers: {},\n        withCredentials: false,\n        ...options,\n    };\n\n    // encode url\n    url = encodeURI(url);\n\n    // if method is GET, add any received data to url\n\n    if (isGet(options.method) && data) {\n        url = `${url}${encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data))}`;\n    }\n\n    // create request\n    const xhr = new XMLHttpRequest();\n\n    // progress of load\n    const process = isGet(options.method) ? xhr : xhr.upload;\n    process.onprogress = e => {\n        // no progress event when aborted ( onprogress is called once after abort() )\n        if (aborted) {\n            return;\n        }\n\n        api.onprogress(e.lengthComputable, e.loaded, e.total);\n    };\n\n    // tries to get header info to the app as fast as possible\n    xhr.onreadystatechange = () => {\n        // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n        if (xhr.readyState < 2) {\n            return;\n        }\n\n        // no server response\n        if (xhr.readyState === 4 && xhr.status === 0) {\n            return;\n        }\n\n        if (headersReceived) {\n            return;\n        }\n\n        headersReceived = true;\n\n        // we've probably received some useful data in response headers\n        api.onheaders(xhr);\n    };\n\n    // load successful\n    xhr.onload = () => {\n        // is classified as valid response\n        if (xhr.status >= 200 && xhr.status < 300) {\n            api.onload(xhr);\n        } else {\n            api.onerror(xhr);\n        }\n    };\n\n    // error during load\n    xhr.onerror = () => api.onerror(xhr);\n\n    // request aborted\n    xhr.onabort = () => {\n        aborted = true;\n        api.onabort();\n    };\n\n    // request timeout\n    xhr.ontimeout = () => api.ontimeout(xhr);\n\n    // open up open up!\n    xhr.open(options.method, url, true);\n\n    // set timeout if defined (do it after open so IE11 plays ball)\n    if (isInt(options.timeout)) {\n        xhr.timeout = options.timeout;\n    }\n\n    // add headers\n    Object.keys(options.headers).forEach(key => {\n        const value = unescape(encodeURIComponent(options.headers[key]));\n        xhr.setRequestHeader(key, value);\n    });\n\n    // set type of response\n    if (options.responseType) {\n        xhr.responseType = options.responseType;\n    }\n\n    // set credentials\n    if (options.withCredentials) {\n        xhr.withCredentials = true;\n    }\n\n    // let's send our data\n    xhr.send(data);\n\n    return api;\n};\n\nconst createResponse = (type, code, body, headers) => ({\n    type,\n    code,\n    body,\n    headers,\n});\n\nconst createTimeoutResponse = cb => xhr => {\n    cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n};\n\nconst hasQS = str => /\\?/.test(str);\nconst buildURL = (...parts) => {\n    let url = '';\n    parts.forEach(part => {\n        url += hasQS(url) && hasQS(part) ? part.replace(/\\?/, '&') : part;\n    });\n    return url;\n};\n\nconst createFetchFunction = (apiUrl = '', action) => {\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function') {\n        return action;\n    }\n\n    // no action supplied\n    if (!action || !isString(action.url)) {\n        return null;\n    }\n\n    // set onload hanlder\n    const onload = action.onload || (res => res);\n    const onerror = action.onerror || (res => null);\n\n    // internal handler\n    return (url, load, error, progress, abort, headers) => {\n        // do local or remote request based on if the url is external\n        const request = sendRequest(url, buildURL(apiUrl, action.url), {\n            ...action,\n            responseType: 'blob',\n        });\n\n        request.onload = xhr => {\n            // get headers\n            const headers = xhr.getAllResponseHeaders();\n\n            // get filename\n            const filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n            // create response\n            load(\n                createResponse(\n                    'load',\n                    xhr.status,\n                    action.method === 'HEAD'\n                        ? null\n                        : getFileFromBlob(onload(xhr.response), filename),\n                    headers\n                )\n            );\n        };\n\n        request.onerror = xhr => {\n            error(\n                createResponse(\n                    'error',\n                    xhr.status,\n                    onerror(xhr.response) || xhr.statusText,\n                    xhr.getAllResponseHeaders()\n                )\n            );\n        };\n\n        request.onheaders = xhr => {\n            headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n        };\n\n        request.ontimeout = createTimeoutResponse(error);\n        request.onprogress = progress;\n        request.onabort = abort;\n\n        // should return request\n        return request;\n    };\n};\n\nconst ChunkStatus = {\n    QUEUED: 0,\n    COMPLETE: 1,\n    PROCESSING: 2,\n    ERROR: 3,\n    WAITING: 4,\n};\n\n/*\nfunction signature:\n  (file, metadata, load, error, progress, abort, transfer, options) => {\n    return {\n    abort:() => {}\n  }\n}\n*/\n\n// apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\nconst processFileChunked = (\n    apiUrl,\n    action,\n    name,\n    file,\n    metadata,\n    load,\n    error,\n    progress,\n    abort,\n    transfer,\n    options\n) => {\n    // all chunks\n    const chunks = [];\n    const { chunkTransferId, chunkServer, chunkSize, chunkRetryDelays } = options;\n\n    // default state\n    const state = {\n        serverId: chunkTransferId,\n        aborted: false,\n    };\n\n    // set onload handlers\n    const ondata = action.ondata || (fd => fd);\n    const onload =\n        action.onload ||\n        ((xhr, method) =>\n            method === 'HEAD' ? xhr.getResponseHeader('Upload-Offset') : xhr.response);\n    const onerror = action.onerror || (res => null);\n\n    // create server hook\n    const requestTransferId = cb => {\n        const formData = new FormData();\n\n        // add metadata under same name\n        if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n\n        const headers =\n            typeof action.headers === 'function'\n                ? action.headers(file, metadata)\n                : {\n                      ...action.headers,\n                      'Upload-Length': file.size,\n                  };\n\n        const requestParams = {\n            ...action,\n            headers,\n        };\n\n        // send request object\n        const request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\n\n        request.onload = xhr => cb(onload(xhr, requestParams.method));\n\n        request.onerror = xhr =>\n            error(\n                createResponse(\n                    'error',\n                    xhr.status,\n                    onerror(xhr.response) || xhr.statusText,\n                    xhr.getAllResponseHeaders()\n                )\n            );\n\n        request.ontimeout = createTimeoutResponse(error);\n    };\n\n    const requestTransferOffset = cb => {\n        const requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n        const headers =\n            typeof action.headers === 'function'\n                ? action.headers(state.serverId)\n                : {\n                      ...action.headers,\n                  };\n\n        const requestParams = {\n            headers,\n            method: 'HEAD',\n        };\n\n        const request = sendRequest(null, requestUrl, requestParams);\n\n        request.onload = xhr => cb(onload(xhr, requestParams.method));\n\n        request.onerror = xhr =>\n            error(\n                createResponse(\n                    'error',\n                    xhr.status,\n                    onerror(xhr.response) || xhr.statusText,\n                    xhr.getAllResponseHeaders()\n                )\n            );\n\n        request.ontimeout = createTimeoutResponse(error);\n    };\n\n    // create chunks\n    const lastChunkIndex = Math.floor(file.size / chunkSize);\n    for (let i = 0; i <= lastChunkIndex; i++) {\n        const offset = i * chunkSize;\n        const data = file.slice(offset, offset + chunkSize, 'application/offset+octet-stream');\n        chunks[i] = {\n            index: i,\n            size: data.size,\n            offset,\n            data,\n            file,\n            progress: 0,\n            retries: [...chunkRetryDelays],\n            status: ChunkStatus.QUEUED,\n            error: null,\n            request: null,\n            timeout: null,\n        };\n    }\n\n    const completeProcessingChunks = () => load(state.serverId);\n\n    const canProcessChunk = chunk =>\n        chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;\n\n    const processChunk = chunk => {\n        // processing is paused, wait here\n        if (state.aborted) return;\n\n        // get next chunk to process\n        chunk = chunk || chunks.find(canProcessChunk);\n\n        // no more chunks to process\n        if (!chunk) {\n            // all done?\n            if (chunks.every(chunk => chunk.status === ChunkStatus.COMPLETE)) {\n                completeProcessingChunks();\n            }\n\n            // no chunk to handle\n            return;\n        }\n\n        // now processing this chunk\n        chunk.status = ChunkStatus.PROCESSING;\n        chunk.progress = null;\n\n        // allow parsing of formdata\n        const ondata = chunkServer.ondata || (fd => fd);\n        const onerror = chunkServer.onerror || (res => null);\n        const onload = chunkServer.onload || (() => {});\n\n        // send request object\n        const requestUrl = buildURL(apiUrl, chunkServer.url, state.serverId);\n\n        const headers =\n            typeof chunkServer.headers === 'function'\n                ? chunkServer.headers(chunk)\n                : {\n                      ...chunkServer.headers,\n                      'Content-Type': 'application/offset+octet-stream',\n                      'Upload-Offset': chunk.offset,\n                      'Upload-Length': file.size,\n                      'Upload-Name': file.name,\n                  };\n\n        const request = (chunk.request = sendRequest(ondata(chunk.data), requestUrl, {\n            ...chunkServer,\n            headers,\n        }));\n\n        request.onload = xhr => {\n            // allow hooking into request result\n            onload(xhr, chunk.index, chunks.length);\n\n            // done!\n            chunk.status = ChunkStatus.COMPLETE;\n\n            // remove request reference\n            chunk.request = null;\n\n            // start processing more chunks\n            processChunks();\n        };\n\n        request.onprogress = (lengthComputable, loaded, total) => {\n            chunk.progress = lengthComputable ? loaded : null;\n            updateTotalProgress();\n        };\n\n        request.onerror = xhr => {\n            chunk.status = ChunkStatus.ERROR;\n            chunk.request = null;\n            chunk.error = onerror(xhr.response) || xhr.statusText;\n            if (!retryProcessChunk(chunk)) {\n                error(\n                    createResponse(\n                        'error',\n                        xhr.status,\n                        onerror(xhr.response) || xhr.statusText,\n                        xhr.getAllResponseHeaders()\n                    )\n                );\n            }\n        };\n\n        request.ontimeout = xhr => {\n            chunk.status = ChunkStatus.ERROR;\n            chunk.request = null;\n            if (!retryProcessChunk(chunk)) {\n                createTimeoutResponse(error)(xhr);\n            }\n        };\n\n        request.onabort = () => {\n            chunk.status = ChunkStatus.QUEUED;\n            chunk.request = null;\n            abort();\n        };\n    };\n\n    const retryProcessChunk = chunk => {\n        // no more retries left\n        if (chunk.retries.length === 0) return false;\n\n        // new retry\n        chunk.status = ChunkStatus.WAITING;\n        clearTimeout(chunk.timeout);\n        chunk.timeout = setTimeout(() => {\n            processChunk(chunk);\n        }, chunk.retries.shift());\n\n        // we're going to retry\n        return true;\n    };\n\n    const updateTotalProgress = () => {\n        // calculate total progress fraction\n        const totalBytesTransfered = chunks.reduce((p, chunk) => {\n            if (p === null || chunk.progress === null) return null;\n            return p + chunk.progress;\n        }, 0);\n\n        // can't compute progress\n        if (totalBytesTransfered === null) return progress(false, 0, 0);\n\n        // calculate progress values\n        const totalSize = chunks.reduce((total, chunk) => total + chunk.size, 0);\n\n        // can update progress indicator\n        progress(true, totalBytesTransfered, totalSize);\n    };\n\n    // process new chunks\n    const processChunks = () => {\n        const totalProcessing = chunks.filter(chunk => chunk.status === ChunkStatus.PROCESSING)\n            .length;\n        if (totalProcessing >= 1) return;\n        processChunk();\n    };\n\n    const abortChunks = () => {\n        chunks.forEach(chunk => {\n            clearTimeout(chunk.timeout);\n            if (chunk.request) {\n                chunk.request.abort();\n            }\n        });\n    };\n\n    // let's go!\n    if (!state.serverId) {\n        requestTransferId(serverId => {\n            // stop here if aborted, might have happened in between request and callback\n            if (state.aborted) return;\n\n            // pass back to item so we can use it if something goes wrong\n            transfer(serverId);\n\n            // store internally\n            state.serverId = serverId;\n            processChunks();\n        });\n    } else {\n        requestTransferOffset(offset => {\n            // stop here if aborted, might have happened in between request and callback\n            if (state.aborted) return;\n\n            // mark chunks with lower offset as complete\n            chunks\n                .filter(chunk => chunk.offset < offset)\n                .forEach(chunk => {\n                    chunk.status = ChunkStatus.COMPLETE;\n                    chunk.progress = chunk.size;\n                });\n\n            // continue processing\n            processChunks();\n        });\n    }\n\n    return {\n        abort: () => {\n            state.aborted = true;\n            abortChunks();\n        },\n    };\n};\n\n/*\nfunction signature:\n  (file, metadata, load, error, progress, abort) => {\n    return {\n    abort:() => {}\n  }\n}\n*/\nconst createFileProcessorFunction = (apiUrl, action, name, options) => (\n    file,\n    metadata,\n    load,\n    error,\n    progress,\n    abort,\n    transfer\n) => {\n    // no file received\n    if (!file) return;\n\n    // if was passed a file, and we can chunk it, exit here\n    const canChunkUpload = options.chunkUploads;\n    const shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n    const willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);\n    if (file instanceof Blob && willChunkUpload)\n        return processFileChunked(\n            apiUrl,\n            action,\n            name,\n            file,\n            metadata,\n            load,\n            error,\n            progress,\n            abort,\n            transfer,\n            options\n        );\n\n    // set handlers\n    const ondata = action.ondata || (fd => fd);\n    const onload = action.onload || (res => res);\n    const onerror = action.onerror || (res => null);\n\n    const headers =\n        typeof action.headers === 'function'\n            ? action.headers(file, metadata) || {}\n            : {\n                  ...action.headers,\n              };\n\n    const requestParams = {\n        ...action,\n        headers,\n    };\n\n    // create formdata object\n    var formData = new FormData();\n\n    // add metadata under same name\n    if (isObject(metadata)) {\n        formData.append(name, JSON.stringify(metadata));\n    }\n\n    // Turn into an array of objects so no matter what the input, we can handle it the same way\n    (file instanceof Blob ? [{ name: null, file }] : file).forEach(item => {\n        formData.append(\n            name,\n            item.file,\n            item.name === null ? item.file.name : `${item.name}${item.file.name}`\n        );\n    });\n\n    // send request object\n    const request = sendRequest(ondata(formData), buildURL(apiUrl, action.url), requestParams);\n    request.onload = xhr => {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n    };\n\n    request.onerror = xhr => {\n        error(\n            createResponse(\n                'error',\n                xhr.status,\n                onerror(xhr.response) || xhr.statusText,\n                xhr.getAllResponseHeaders()\n            )\n        );\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort;\n\n    // should return request\n    return request;\n};\n\nconst createProcessorFunction = (apiUrl = '', action, name, options) => {\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function') return (...params) => action(name, ...params, options);\n\n    // no action supplied\n    if (!action || !isString(action.url)) return null;\n\n    // internal handler\n    return createFileProcessorFunction(apiUrl, action, name, options);\n};\n\n/*\n function signature:\n (uniqueFileId, load, error) => { }\n */\nconst createRevertFunction = (apiUrl = '', action) => {\n    // is custom implementation\n    if (typeof action === 'function') {\n        return action;\n    }\n\n    // no action supplied, return stub function, interface will work, but file won't be removed\n    if (!action || !isString(action.url)) {\n        return (uniqueFileId, load) => load();\n    }\n\n    // set onload hanlder\n    const onload = action.onload || (res => res);\n    const onerror = action.onerror || (res => null);\n\n    // internal implementation\n    return (uniqueFileId, load, error) => {\n        const request = sendRequest(\n            uniqueFileId,\n            apiUrl + action.url,\n            action // contains method, headers and withCredentials properties\n        );\n        request.onload = xhr => {\n            load(\n                createResponse(\n                    'load',\n                    xhr.status,\n                    onload(xhr.response),\n                    xhr.getAllResponseHeaders()\n                )\n            );\n        };\n\n        request.onerror = xhr => {\n            error(\n                createResponse(\n                    'error',\n                    xhr.status,\n                    onerror(xhr.response) || xhr.statusText,\n                    xhr.getAllResponseHeaders()\n                )\n            );\n        };\n\n        request.ontimeout = createTimeoutResponse(error);\n\n        return request;\n    };\n};\n\nconst getRandomNumber = (min = 0, max = 1) => min + Math.random() * (max - min);\n\nconst createPerceivedPerformanceUpdater = (\n    cb,\n    duration = 1000,\n    offset = 0,\n    tickMin = 25,\n    tickMax = 250\n) => {\n    let timeout = null;\n    const start = Date.now();\n\n    const tick = () => {\n        let runtime = Date.now() - start;\n        let delay = getRandomNumber(tickMin, tickMax);\n\n        if (runtime + delay > duration) {\n            delay = runtime + delay - duration;\n        }\n\n        let progress = runtime / duration;\n        if (progress >= 1 || document.hidden) {\n            cb(1);\n            return;\n        }\n\n        cb(progress);\n\n        timeout = setTimeout(tick, delay);\n    };\n\n    if (duration > 0) tick();\n\n    return {\n        clear: () => {\n            clearTimeout(timeout);\n        },\n    };\n};\n\nconst createFileProcessor = (processFn, options) => {\n    const state = {\n        complete: false,\n        perceivedProgress: 0,\n        perceivedPerformanceUpdater: null,\n        progress: null,\n        timestamp: null,\n        perceivedDuration: 0,\n        duration: 0,\n        request: null,\n        response: null,\n    };\n\n    const { allowMinimumUploadDuration } = options;\n\n    const process = (file, metadata) => {\n        const progressFn = () => {\n            // we've not yet started the real download, stop here\n            // the request might not go through, for instance, there might be some server trouble\n            // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n            if (state.duration === 0 || state.progress === null) return;\n\n            // as we're now processing, fire the progress event\n            api.fire('progress', api.getProgress());\n        };\n\n        const completeFn = () => {\n            state.complete = true;\n            api.fire('load-perceived', state.response.body);\n        };\n\n        // let's start processing\n        api.fire('start');\n\n        // set request start\n        state.timestamp = Date.now();\n\n        // create perceived performance progress indicator\n        state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(\n            progress => {\n                state.perceivedProgress = progress;\n                state.perceivedDuration = Date.now() - state.timestamp;\n\n                progressFn();\n\n                // if fake progress is done, and a response has been received,\n                // and we've not yet called the complete method\n                if (state.response && state.perceivedProgress === 1 && !state.complete) {\n                    // we done!\n                    completeFn();\n                }\n            },\n            // random delay as in a list of files you start noticing\n            // files uploading at the exact same speed\n            allowMinimumUploadDuration ? getRandomNumber(750, 1500) : 0\n        );\n\n        // remember request so we can abort it later\n        state.request = processFn(\n            // the file to process\n            file,\n\n            // the metadata to send along\n            metadata,\n\n            // callbacks (load, error, progress, abort, transfer)\n            // load expects the body to be a server id if\n            // you want to make use of revert\n            response => {\n                // we put the response in state so we can access\n                // it outside of this method\n                state.response = isObject(response)\n                    ? response\n                    : {\n                          type: 'load',\n                          code: 200,\n                          body: `${response}`,\n                          headers: {},\n                      };\n\n                // update duration\n                state.duration = Date.now() - state.timestamp;\n\n                // force progress to 1 as we're now done\n                state.progress = 1;\n\n                // actual load is done let's share results\n                api.fire('load', state.response.body);\n\n                // we are really done\n                // if perceived progress is 1 ( wait for perceived progress to complete )\n                // or if server does not support progress ( null )\n                if (\n                    !allowMinimumUploadDuration ||\n                    (allowMinimumUploadDuration && state.perceivedProgress === 1)\n                ) {\n                    completeFn();\n                }\n            },\n\n            // error is expected to be an object with type, code, body\n            error => {\n                // cancel updater\n                state.perceivedPerformanceUpdater.clear();\n\n                // update others about this error\n                api.fire(\n                    'error',\n                    isObject(error)\n                        ? error\n                        : {\n                              type: 'error',\n                              code: 0,\n                              body: `${error}`,\n                          }\n                );\n            },\n\n            // actual processing progress\n            (computable, current, total) => {\n                // update actual duration\n                state.duration = Date.now() - state.timestamp;\n\n                // update actual progress\n                state.progress = computable ? current / total : null;\n\n                progressFn();\n            },\n\n            // abort does not expect a value\n            () => {\n                // stop updater\n                state.perceivedPerformanceUpdater.clear();\n\n                // fire the abort event so we can switch visuals\n                api.fire('abort', state.response ? state.response.body : null);\n            },\n\n            // register the id for this transfer\n            transferId => {\n                api.fire('transfer', transferId);\n            }\n        );\n    };\n\n    const abort = () => {\n        // no request running, can't abort\n        if (!state.request) return;\n\n        // stop updater\n        state.perceivedPerformanceUpdater.clear();\n\n        // abort actual request\n        if (state.request.abort) state.request.abort();\n\n        // if has response object, we've completed the request\n        state.complete = true;\n    };\n\n    const reset = () => {\n        abort();\n        state.complete = false;\n        state.perceivedProgress = 0;\n        state.progress = 0;\n        state.timestamp = null;\n        state.perceivedDuration = 0;\n        state.duration = 0;\n        state.request = null;\n        state.response = null;\n    };\n\n    const getProgress = allowMinimumUploadDuration\n        ? () => (state.progress ? Math.min(state.progress, state.perceivedProgress) : null)\n        : () => state.progress || null;\n\n    const getDuration = allowMinimumUploadDuration\n        ? () => Math.min(state.duration, state.perceivedDuration)\n        : () => state.duration;\n\n    const api = {\n        ...on(),\n        process, // start processing file\n        abort, // abort active process request\n        getProgress,\n        getDuration,\n        reset,\n    };\n\n    return api;\n};\n\nconst getFilenameWithoutExtension = name => name.substring(0, name.lastIndexOf('.')) || name;\n\nconst createFileStub = source => {\n    let data = [source.name, source.size, source.type];\n\n    // is blob or base64, then we need to set the name\n    if (source instanceof Blob || isBase64DataURI(source)) {\n        data[0] = source.name || getDateString();\n    } else if (isBase64DataURI(source)) {\n        // if is base64 data uri we need to determine the average size and type\n        data[1] = source.length;\n        data[2] = getMimeTypeFromBase64DataURI(source);\n    } else if (isString(source)) {\n        // url\n        data[0] = getFilenameFromURL(source);\n        data[1] = 0;\n        data[2] = 'application/octet-stream';\n    }\n\n    return {\n        name: data[0],\n        size: data[1],\n        type: data[2],\n    };\n};\n\nconst isFile = value => !!(value instanceof File || (value instanceof Blob && value.name));\n\nconst deepCloneObject = src => {\n    if (!isObject(src)) return src;\n    const target = isArray(src) ? [] : {};\n    for (const key in src) {\n        if (!src.hasOwnProperty(key)) continue;\n        const v = src[key];\n        target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n    }\n    return target;\n};\n\nconst createItem = (origin = null, serverFileReference = null, file = null) => {\n    // unique id for this item, is used to identify the item across views\n    const id = getUniqueId();\n\n    /**\n     * Internal item state\n     */\n    const state = {\n        // is archived\n        archived: false,\n\n        // if is frozen, no longer fires events\n        frozen: false,\n\n        // removed from view\n        released: false,\n\n        // original source\n        source: null,\n\n        // file model reference\n        file,\n\n        // id of file on server\n        serverFileReference,\n\n        // id of file transfer on server\n        transferId: null,\n\n        // is aborted\n        processingAborted: false,\n\n        // current item status\n        status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,\n\n        // active processes\n        activeLoader: null,\n        activeProcessor: null,\n    };\n\n    // callback used when abort processing is called to link back to the resolve method\n    let abortProcessingRequestComplete = null;\n\n    /**\n     * Externally added item metadata\n     */\n    const metadata = {};\n\n    // item data\n    const setStatus = status => (state.status = status);\n\n    // fire event unless the item has been archived\n    const fire = (event, ...params) => {\n        if (state.released || state.frozen) return;\n        api.fire(event, ...params);\n    };\n\n    // file data\n    const getFileExtension = () => getExtensionFromFilename(state.file.name);\n    const getFileType = () => state.file.type;\n    const getFileSize = () => state.file.size;\n    const getFile = () => state.file;\n\n    //\n    // logic to load a file\n    //\n    const load = (source, loader, onload) => {\n        // remember the original item source\n        state.source = source;\n\n        // source is known\n        api.fireSync('init');\n\n        // file stub is already there\n        if (state.file) {\n            api.fireSync('load-skip');\n            return;\n        }\n\n        // set a stub file object while loading the actual data\n        state.file = createFileStub(source);\n\n        // starts loading\n        loader.on('init', () => {\n            fire('load-init');\n        });\n\n        // we'eve received a size indication, let's update the stub\n        loader.on('meta', meta => {\n            // set size of file stub\n            state.file.size = meta.size;\n\n            // set name of file stub\n            state.file.filename = meta.filename;\n\n            // if has received source, we done\n            if (meta.source) {\n                origin = FileOrigin.LIMBO;\n                state.serverFileReference = meta.source;\n                state.status = ItemStatus.PROCESSING_COMPLETE;\n            }\n\n            // size has been updated\n            fire('load-meta');\n        });\n\n        // the file is now loading we need to update the progress indicators\n        loader.on('progress', progress => {\n            setStatus(ItemStatus.LOADING);\n\n            fire('load-progress', progress);\n        });\n\n        // an error was thrown while loading the file, we need to switch to error state\n        loader.on('error', error => {\n            setStatus(ItemStatus.LOAD_ERROR);\n\n            fire('load-request-error', error);\n        });\n\n        // user or another process aborted the file load (cannot retry)\n        loader.on('abort', () => {\n            setStatus(ItemStatus.INIT);\n            fire('load-abort');\n        });\n\n        // done loading\n        loader.on('load', file => {\n            // as we've now loaded the file the loader is no longer required\n            state.activeLoader = null;\n\n            // called when file has loaded succesfully\n            const success = result => {\n                // set (possibly) transformed file\n                state.file = isFile(result) ? result : state.file;\n\n                // file received\n                if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n                    setStatus(ItemStatus.PROCESSING_COMPLETE);\n                } else {\n                    setStatus(ItemStatus.IDLE);\n                }\n\n                fire('load');\n            };\n\n            const error = result => {\n                // set original file\n                state.file = file;\n                fire('load-meta');\n\n                setStatus(ItemStatus.LOAD_ERROR);\n                fire('load-file-error', result);\n            };\n\n            // if we already have a server file reference, we don't need to call the onload method\n            if (state.serverFileReference) {\n                success(file);\n                return;\n            }\n\n            // no server id, let's give this file the full treatment\n            onload(file, success, error);\n        });\n\n        // set loader source data\n        loader.setSource(source);\n\n        // set as active loader\n        state.activeLoader = loader;\n\n        // load the source data\n        loader.load();\n    };\n\n    const retryLoad = () => {\n        if (!state.activeLoader) {\n            return;\n        }\n        state.activeLoader.load();\n    };\n\n    const abortLoad = () => {\n        if (state.activeLoader) {\n            state.activeLoader.abort();\n            return;\n        }\n        setStatus(ItemStatus.INIT);\n        fire('load-abort');\n    };\n\n    //\n    // logic to process a file\n    //\n    const process = (processor, onprocess) => {\n        // processing was aborted\n        if (state.processingAborted) {\n            state.processingAborted = false;\n            return;\n        }\n\n        // now processing\n        setStatus(ItemStatus.PROCESSING);\n\n        // reset abort callback\n        abortProcessingRequestComplete = null;\n\n        // if no file loaded we'll wait for the load event\n        if (!(state.file instanceof Blob)) {\n            api.on('load', () => {\n                process(processor, onprocess);\n            });\n            return;\n        }\n\n        // setup processor\n        processor.on('load', serverFileReference => {\n            // need this id to be able to revert the upload\n            state.transferId = null;\n            state.serverFileReference = serverFileReference;\n        });\n\n        // register transfer id\n        processor.on('transfer', transferId => {\n            // need this id to be able to revert the upload\n            state.transferId = transferId;\n        });\n\n        processor.on('load-perceived', serverFileReference => {\n            // no longer required\n            state.activeProcessor = null;\n\n            // need this id to be able to rever the upload\n            state.transferId = null;\n            state.serverFileReference = serverFileReference;\n\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\n            fire('process-complete', serverFileReference);\n        });\n\n        processor.on('start', () => {\n            fire('process-start');\n        });\n\n        processor.on('error', error => {\n            state.activeProcessor = null;\n            setStatus(ItemStatus.PROCESSING_ERROR);\n            fire('process-error', error);\n        });\n\n        processor.on('abort', serverFileReference => {\n            state.activeProcessor = null;\n\n            // if file was uploaded but processing was cancelled during perceived processor time store file reference\n            state.serverFileReference = serverFileReference;\n\n            setStatus(ItemStatus.IDLE);\n            fire('process-abort');\n\n            // has timeout so doesn't interfere with remove action\n            if (abortProcessingRequestComplete) {\n                abortProcessingRequestComplete();\n            }\n        });\n\n        processor.on('progress', progress => {\n            fire('process-progress', progress);\n        });\n\n        // when successfully transformed\n        const success = file => {\n            // if was archived in the mean time, don't process\n            if (state.archived) return;\n\n            // process file!\n            processor.process(file, { ...metadata });\n        };\n\n        // something went wrong during transform phase\n        const error = console.error;\n\n        // start processing the file\n        onprocess(state.file, success, error);\n\n        // set as active processor\n        state.activeProcessor = processor;\n    };\n\n    const requestProcessing = () => {\n        state.processingAborted = false;\n        setStatus(ItemStatus.PROCESSING_QUEUED);\n    };\n\n    const abortProcessing = () =>\n        new Promise(resolve => {\n            if (!state.activeProcessor) {\n                state.processingAborted = true;\n\n                setStatus(ItemStatus.IDLE);\n                fire('process-abort');\n\n                resolve();\n                return;\n            }\n\n            abortProcessingRequestComplete = () => {\n                resolve();\n            };\n\n            state.activeProcessor.abort();\n        });\n\n    //\n    // logic to revert a processed file\n    //\n    const revert = (revertFileUpload, forceRevert) =>\n        new Promise((resolve, reject) => {\n            // a completed upload will have a serverFileReference, a failed chunked upload where\n            // getting a serverId succeeded but >=0 chunks have been uploaded will have transferId set\n            const serverTransferId =\n                state.serverFileReference !== null ? state.serverFileReference : state.transferId;\n\n            // cannot revert without a server id for this process\n            if (serverTransferId === null) {\n                resolve();\n                return;\n            }\n\n            // revert the upload (fire and forget)\n            revertFileUpload(\n                serverTransferId,\n                () => {\n                    // reset file server id and transfer id as now it's not available on the server\n                    state.serverFileReference = null;\n                    state.transferId = null;\n                    resolve();\n                },\n                error => {\n                    // don't set error state when reverting is optional, it will always resolve\n                    if (!forceRevert) {\n                        resolve();\n                        return;\n                    }\n\n                    // oh no errors\n                    setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n                    fire('process-revert-error');\n                    reject(error);\n                }\n            );\n\n            // fire event\n            setStatus(ItemStatus.IDLE);\n            fire('process-revert');\n        });\n\n    // exposed methods\n    const setMetadata = (key, value, silent) => {\n        const keys = key.split('.');\n        const root = keys[0];\n        const last = keys.pop();\n        let data = metadata;\n        keys.forEach(key => (data = data[key]));\n\n        // compare old value against new value, if they're the same, we're not updating\n        if (JSON.stringify(data[last]) === JSON.stringify(value)) return;\n\n        // update value\n        data[last] = value;\n\n        // fire update\n        fire('metadata-update', {\n            key: root,\n            value: metadata[root],\n            silent,\n        });\n    };\n\n    const getMetadata = key => deepCloneObject(key ? metadata[key] : metadata);\n\n    const api = {\n        id: { get: () => id },\n        origin: { get: () => origin, set: value => (origin = value) },\n        serverId: { get: () => state.serverFileReference },\n        transferId: { get: () => state.transferId },\n        status: { get: () => state.status },\n        filename: { get: () => state.file.name },\n        filenameWithoutExtension: { get: () => getFilenameWithoutExtension(state.file.name) },\n        fileExtension: { get: getFileExtension },\n        fileType: { get: getFileType },\n        fileSize: { get: getFileSize },\n        file: { get: getFile },\n        relativePath: { get: () => state.file._relativePath },\n\n        source: { get: () => state.source },\n\n        getMetadata,\n        setMetadata: (key, value, silent) => {\n            if (isObject(key)) {\n                const data = key;\n                Object.keys(data).forEach(key => {\n                    setMetadata(key, data[key], value);\n                });\n                return key;\n            }\n            setMetadata(key, value, silent);\n            return value;\n        },\n\n        extend: (name, handler) => (itemAPI[name] = handler),\n\n        abortLoad,\n        retryLoad,\n        requestProcessing,\n        abortProcessing,\n\n        load,\n        process,\n        revert,\n\n        ...on(),\n\n        freeze: () => (state.frozen = true),\n\n        release: () => (state.released = true),\n        released: { get: () => state.released },\n\n        archive: () => (state.archived = true),\n        archived: { get: () => state.archived },\n\n        // replace source and file object\n        setFile: file => (state.file = file),\n    };\n\n    // create it here instead of returning it instantly so we can extend it later\n    const itemAPI = createObject(api);\n\n    return itemAPI;\n};\n\nconst getItemIndexByQuery = (items, query) => {\n    // just return first index\n    if (isEmpty(query)) {\n        return 0;\n    }\n\n    // invalid queries\n    if (!isString(query)) {\n        return -1;\n    }\n\n    // return item by id (or -1 if not found)\n    return items.findIndex(item => item.id === query);\n};\n\nconst getItemById = (items, itemId) => {\n    const index = getItemIndexByQuery(items, itemId);\n    if (index < 0) {\n        return;\n    }\n    return items[index] || null;\n};\n\nconst fetchBlob = (url, load, error, progress, abort, headers) => {\n    const request = sendRequest(null, url, {\n        method: 'GET',\n        responseType: 'blob',\n    });\n\n    request.onload = xhr => {\n        // get headers\n        const headers = xhr.getAllResponseHeaders();\n\n        // get filename\n        const filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n        // create response\n        load(createResponse('load', xhr.status, getFileFromBlob(xhr.response, filename), headers));\n    };\n\n    request.onerror = xhr => {\n        error(createResponse('error', xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));\n    };\n\n    request.onheaders = xhr => {\n        headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort;\n\n    // should return request\n    return request;\n};\n\nconst getDomainFromURL = url => {\n    if (url.indexOf('//') === 0) {\n        url = location.protocol + url;\n    }\n    return url\n        .toLowerCase()\n        .replace('blob:', '')\n        .replace(/([a-z])?:\\/\\//, '$1')\n        .split('/')[0];\n};\n\nconst isExternalURL = url =>\n    (url.indexOf(':') > -1 || url.indexOf('//') > -1) &&\n    getDomainFromURL(location.href) !== getDomainFromURL(url);\n\nconst dynamicLabel = label => (...params) => (isFunction(label) ? label(...params) : label);\n\nconst isMockItem = item => !isFile(item.file);\n\nconst listUpdated = (dispatch, state) => {\n    clearTimeout(state.listUpdateTimeout);\n    state.listUpdateTimeout = setTimeout(() => {\n        dispatch('DID_UPDATE_ITEMS', { items: getActiveItems(state.items) });\n    }, 0);\n};\n\nconst optionalPromise = (fn, ...params) =>\n    new Promise(resolve => {\n        if (!fn) {\n            return resolve(true);\n        }\n\n        const result = fn(...params);\n\n        if (result == null) {\n            return resolve(true);\n        }\n\n        if (typeof result === 'boolean') {\n            return resolve(result);\n        }\n\n        if (typeof result.then === 'function') {\n            result.then(resolve);\n        }\n    });\n\nconst sortItems = (state, compare) => {\n    state.items.sort((a, b) => compare(createItemAPI(a), createItemAPI(b)));\n};\n\n// returns item based on state\nconst getItemByQueryFromState = (state, itemHandler) => ({\n    query,\n    success = () => {},\n    failure = () => {},\n    ...options\n} = {}) => {\n    const item = getItemByQuery(state.items, query);\n    if (!item) {\n        failure({\n            error: createResponse('error', 0, 'Item not found'),\n            file: null,\n        });\n        return;\n    }\n    itemHandler(item, success, failure, options || {});\n};\n\nconst actions = (dispatch, query, state) => ({\n    /**\n     * Aborts all ongoing processes\n     */\n    ABORT_ALL: () => {\n        getActiveItems(state.items).forEach(item => {\n            item.freeze();\n            item.abortLoad();\n            item.abortProcessing();\n        });\n    },\n\n    /**\n     * Sets initial files\n     */\n    DID_SET_FILES: ({ value = [] }) => {\n        // map values to file objects\n        const files = value.map(file => ({\n            source: file.source ? file.source : file,\n            options: file.options,\n        }));\n\n        // loop over files, if file is in list, leave it be, if not, remove\n        // test if items should be moved\n        let activeItems = getActiveItems(state.items);\n\n        activeItems.forEach(item => {\n            // if item not is in new value, remove\n            if (!files.find(file => file.source === item.source || file.source === item.file)) {\n                dispatch('REMOVE_ITEM', { query: item, remove: false });\n            }\n        });\n\n        // add new files\n        activeItems = getActiveItems(state.items);\n        files.forEach((file, index) => {\n            // if file is already in list\n            if (activeItems.find(item => item.source === file.source || item.file === file.source))\n                return;\n\n            // not in list, add\n            dispatch('ADD_ITEM', {\n                ...file,\n                interactionMethod: InteractionMethod.NONE,\n                index,\n            });\n        });\n    },\n\n    DID_UPDATE_ITEM_METADATA: ({ id, action, change }) => {\n        // don't do anything\n        if (change.silent) return;\n\n        // if is called multiple times in close succession we combined all calls together to save resources\n        clearTimeout(state.itemUpdateTimeout);\n        state.itemUpdateTimeout = setTimeout(() => {\n            const item = getItemById(state.items, id);\n\n            // only revert and attempt to upload when we're uploading to a server\n            if (!query('IS_ASYNC')) {\n                // should we update the output data\n                applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n                    item,\n                    query,\n                    action,\n                    change,\n                }).then(shouldPrepareOutput => {\n                    // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n                    const beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n                    if (beforePrepareFile)\n                        shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n\n                    if (!shouldPrepareOutput) return;\n\n                    dispatch(\n                        'REQUEST_PREPARE_OUTPUT',\n                        {\n                            query: id,\n                            item,\n                            success: file => {\n                                dispatch('DID_PREPARE_OUTPUT', { id, file });\n                            },\n                        },\n                        true\n                    );\n                });\n\n                return;\n            }\n\n            // if is local item we need to enable upload button so change can be propagated to server\n            if (item.origin === FileOrigin.LOCAL) {\n                dispatch('DID_LOAD_ITEM', {\n                    id: item.id,\n                    error: null,\n                    serverFileReference: item.source,\n                });\n            }\n\n            // for async scenarios\n            const upload = () => {\n                // we push this forward a bit so the interface is updated correctly\n                setTimeout(() => {\n                    dispatch('REQUEST_ITEM_PROCESSING', { query: id });\n                }, 32);\n            };\n\n            const revert = doUpload => {\n                item.revert(\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\n                    query('GET_FORCE_REVERT')\n                )\n                    .then(doUpload ? upload : () => {})\n                    .catch(() => {});\n            };\n\n            const abort = doUpload => {\n                item.abortProcessing().then(doUpload ? upload : () => {});\n            };\n\n            // if we should re-upload the file immediately\n            if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n                return revert(state.options.instantUpload);\n            }\n\n            // if currently uploading, cancel upload\n            if (item.status === ItemStatus.PROCESSING) {\n                return abort(state.options.instantUpload);\n            }\n\n            if (state.options.instantUpload) {\n                upload();\n            }\n        }, 0);\n    },\n\n    MOVE_ITEM: ({ query, index }) => {\n        const item = getItemByQuery(state.items, query);\n        if (!item) return;\n        const currentIndex = state.items.indexOf(item);\n        index = limit(index, 0, state.items.length - 1);\n        if (currentIndex === index) return;\n        state.items.splice(index, 0, state.items.splice(currentIndex, 1)[0]);\n    },\n\n    SORT: ({ compare }) => {\n        sortItems(state, compare);\n        dispatch('DID_SORT_ITEMS', {\n            items: query('GET_ACTIVE_ITEMS'),\n        });\n    },\n\n    ADD_ITEMS: ({ items, index, interactionMethod, success = () => {}, failure = () => {} }) => {\n        let currentIndex = index;\n\n        if (index === -1 || typeof index === 'undefined') {\n            const insertLocation = query('GET_ITEM_INSERT_LOCATION');\n            const totalItems = query('GET_TOTAL_ITEMS');\n            currentIndex = insertLocation === 'before' ? 0 : totalItems;\n        }\n\n        const ignoredFiles = query('GET_IGNORED_FILES');\n        const isValidFile = source =>\n            isFile(source) ? !ignoredFiles.includes(source.name.toLowerCase()) : !isEmpty(source);\n        const validItems = items.filter(isValidFile);\n\n        const promises = validItems.map(\n            source =>\n                new Promise((resolve, reject) => {\n                    dispatch('ADD_ITEM', {\n                        interactionMethod,\n                        source: source.source || source,\n                        success: resolve,\n                        failure: reject,\n                        index: currentIndex++,\n                        options: source.options || {},\n                    });\n                })\n        );\n\n        Promise.all(promises)\n            .then(success)\n            .catch(failure);\n    },\n\n    /**\n     * @param source\n     * @param index\n     * @param interactionMethod\n     */\n    ADD_ITEM: ({\n        source,\n        index = -1,\n        interactionMethod,\n        success = () => {},\n        failure = () => {},\n        options = {},\n    }) => {\n        // if no source supplied\n        if (isEmpty(source)) {\n            failure({\n                error: createResponse('error', 0, 'No source'),\n                file: null,\n            });\n            return;\n        }\n\n        // filter out invalid file items, used to filter dropped directory contents\n        if (isFile(source) && state.options.ignoredFiles.includes(source.name.toLowerCase())) {\n            // fail silently\n            return;\n        }\n\n        // test if there's still room in the list of files\n        if (!hasRoomForItem(state)) {\n            // if multiple allowed, we can't replace\n            // or if only a single item is allowed but we're not allowed to replace it we exit\n            if (\n                state.options.allowMultiple ||\n                (!state.options.allowMultiple && !state.options.allowReplace)\n            ) {\n                const error = createResponse('warning', 0, 'Max files');\n\n                dispatch('DID_THROW_MAX_FILES', {\n                    source,\n                    error,\n                });\n\n                failure({ error, file: null });\n\n                return;\n            }\n\n            // let's replace the item\n            // id of first item we're about to remove\n            const item = getActiveItems(state.items)[0];\n\n            // if has been processed remove it from the server as well\n            if (\n                item.status === ItemStatus.PROCESSING_COMPLETE ||\n                item.status === ItemStatus.PROCESSING_REVERT_ERROR\n            ) {\n                const forceRevert = query('GET_FORCE_REVERT');\n                item.revert(\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\n                    forceRevert\n                )\n                    .then(() => {\n                        if (!forceRevert) return;\n\n                        // try to add now\n                        dispatch('ADD_ITEM', {\n                            source,\n                            index,\n                            interactionMethod,\n                            success,\n                            failure,\n                            options,\n                        });\n                    })\n                    .catch(() => {}); // no need to handle this catch state for now\n\n                if (forceRevert) return;\n            }\n\n            // remove first item as it will be replaced by this item\n            dispatch('REMOVE_ITEM', { query: item.id });\n        }\n\n        // where did the file originate\n        const origin =\n            options.type === 'local'\n                ? FileOrigin.LOCAL\n                : options.type === 'limbo'\n                ? FileOrigin.LIMBO\n                : FileOrigin.INPUT;\n\n        // create a new blank item\n        const item = createItem(\n            // where did this file come from\n            origin,\n\n            // an input file never has a server file reference\n            origin === FileOrigin.INPUT ? null : source,\n\n            // file mock data, if defined\n            options.file\n        );\n\n        // set initial meta data\n        Object.keys(options.metadata || {}).forEach(key => {\n            item.setMetadata(key, options.metadata[key]);\n        });\n\n        // created the item, let plugins add methods\n        applyFilters('DID_CREATE_ITEM', item, { query, dispatch });\n\n        // where to insert new items\n        const itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n        // adjust index if is not allowed to pick location\n        if (!state.options.itemInsertLocationFreedom) {\n            index = itemInsertLocation === 'before' ? -1 : state.items.length;\n        }\n\n        // add item to list\n        insertItem(state.items, item, index);\n\n        // sort items in list\n        if (isFunction(itemInsertLocation) && source) {\n            sortItems(state, itemInsertLocation);\n        }\n\n        // get a quick reference to the item id\n        const id = item.id;\n\n        // observe item events\n        item.on('init', () => {\n            dispatch('DID_INIT_ITEM', { id });\n        });\n\n        item.on('load-init', () => {\n            dispatch('DID_START_ITEM_LOAD', { id });\n        });\n\n        item.on('load-meta', () => {\n            dispatch('DID_UPDATE_ITEM_META', { id });\n        });\n\n        item.on('load-progress', progress => {\n            dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', { id, progress });\n        });\n\n        item.on('load-request-error', error => {\n            const mainStatus = dynamicLabel(state.options.labelFileLoadError)(error);\n\n            // is client error, no way to recover\n            if (error.code >= 400 && error.code < 500) {\n                dispatch('DID_THROW_ITEM_INVALID', {\n                    id,\n                    error,\n                    status: {\n                        main: mainStatus,\n                        sub: `${error.code} (${error.body})`,\n                    },\n                });\n\n                // reject the file so can be dealt with through API\n                failure({ error, file: createItemAPI(item) });\n                return;\n            }\n\n            // is possible server error, so might be possible to retry\n            dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n                id,\n                error,\n                status: {\n                    main: mainStatus,\n                    sub: state.options.labelTapToRetry,\n                },\n            });\n        });\n\n        item.on('load-file-error', error => {\n            dispatch('DID_THROW_ITEM_INVALID', {\n                id,\n                error: error.status,\n                status: error.status,\n            });\n            failure({ error: error.status, file: createItemAPI(item) });\n        });\n\n        item.on('load-abort', () => {\n            dispatch('REMOVE_ITEM', { query: id });\n        });\n\n        item.on('load-skip', () => {\n            item.on('metadata-update', change => {\n                if (!isFile(item.file)) return;\n                dispatch('DID_UPDATE_ITEM_METADATA', { id, change });\n            });\n\n            dispatch('COMPLETE_LOAD_ITEM', {\n                query: id,\n                item,\n                data: {\n                    source,\n                    success,\n                },\n            });\n        });\n\n        item.on('load', () => {\n            const handleAdd = shouldAdd => {\n                // no should not add this file\n                if (!shouldAdd) {\n                    dispatch('REMOVE_ITEM', {\n                        query: id,\n                    });\n                    return;\n                }\n\n                // now interested in metadata updates\n                item.on('metadata-update', change => {\n                    dispatch('DID_UPDATE_ITEM_METADATA', { id, change });\n                });\n\n                // let plugins decide if the output data should be prepared at this point\n                // means we'll do this and wait for idle state\n                applyFilterChain('SHOULD_PREPARE_OUTPUT', false, { item, query }).then(\n                    shouldPrepareOutput => {\n                        // plugins determined the output data should be prepared (or not), can be adjusted with beforePrepareOutput hook\n                        const beforePrepareFile = query('GET_BEFORE_PREPARE_FILE');\n                        if (beforePrepareFile)\n                            shouldPrepareOutput = beforePrepareFile(item, shouldPrepareOutput);\n\n                        const loadComplete = () => {\n                            dispatch('COMPLETE_LOAD_ITEM', {\n                                query: id,\n                                item,\n                                data: {\n                                    source,\n                                    success,\n                                },\n                            });\n\n                            listUpdated(dispatch, state);\n                        };\n\n                        // exit\n                        if (shouldPrepareOutput) {\n                            // wait for idle state and then run PREPARE_OUTPUT\n                            dispatch(\n                                'REQUEST_PREPARE_OUTPUT',\n                                {\n                                    query: id,\n                                    item,\n                                    success: file => {\n                                        dispatch('DID_PREPARE_OUTPUT', { id, file });\n                                        loadComplete();\n                                    },\n                                },\n                                true\n                            );\n\n                            return;\n                        }\n\n                        loadComplete();\n                    }\n                );\n            };\n\n            // item loaded, allow plugins to\n            // - read data (quickly)\n            // - add metadata\n            applyFilterChain('DID_LOAD_ITEM', item, { query, dispatch })\n                .then(() => {\n                    optionalPromise(query('GET_BEFORE_ADD_FILE'), createItemAPI(item)).then(\n                        handleAdd\n                    );\n                })\n                .catch(e => {\n                    if (!e || !e.error || !e.status) return handleAdd(false);\n                    dispatch('DID_THROW_ITEM_INVALID', {\n                        id,\n                        error: e.error,\n                        status: e.status,\n                    });\n                });\n        });\n\n        item.on('process-start', () => {\n            dispatch('DID_START_ITEM_PROCESSING', { id });\n        });\n\n        item.on('process-progress', progress => {\n            dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', { id, progress });\n        });\n\n        item.on('process-error', error => {\n            dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n                id,\n                error,\n                status: {\n                    main: dynamicLabel(state.options.labelFileProcessingError)(error),\n                    sub: state.options.labelTapToRetry,\n                },\n            });\n        });\n\n        item.on('process-revert-error', error => {\n            dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n                id,\n                error,\n                status: {\n                    main: dynamicLabel(state.options.labelFileProcessingRevertError)(error),\n                    sub: state.options.labelTapToRetry,\n                },\n            });\n        });\n\n        item.on('process-complete', serverFileReference => {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n                id,\n                error: null,\n                serverFileReference,\n            });\n            dispatch('DID_DEFINE_VALUE', { id, value: serverFileReference });\n        });\n\n        item.on('process-abort', () => {\n            dispatch('DID_ABORT_ITEM_PROCESSING', { id });\n        });\n\n        item.on('process-revert', () => {\n            dispatch('DID_REVERT_ITEM_PROCESSING', { id });\n            dispatch('DID_DEFINE_VALUE', { id, value: null });\n        });\n\n        // let view know the item has been inserted\n        dispatch('DID_ADD_ITEM', { id, index, interactionMethod });\n\n        listUpdated(dispatch, state);\n\n        // start loading the source\n        const { url, load, restore, fetch } = state.options.server || {};\n\n        item.load(\n            source,\n\n            // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n            createFileLoader(\n                origin === FileOrigin.INPUT\n                    ? // input, if is remote, see if should use custom fetch, else use default fetchBlob\n                      isString(source) && isExternalURL(source)\n                        ? fetch\n                            ? createFetchFunction(url, fetch)\n                            : fetchBlob // remote url\n                        : fetchBlob // try to fetch url\n                    : // limbo or local\n                    origin === FileOrigin.LIMBO\n                    ? createFetchFunction(url, restore) // limbo\n                    : createFetchFunction(url, load) // local\n            ),\n\n            // called when the file is loaded so it can be piped through the filters\n            (file, success, error) => {\n                // let's process the file\n                applyFilterChain('LOAD_FILE', file, { query })\n                    .then(success)\n                    .catch(error);\n            }\n        );\n    },\n\n    REQUEST_PREPARE_OUTPUT: ({ item, success, failure = () => {} }) => {\n        // error response if item archived\n        const err = {\n            error: createResponse('error', 0, 'Item not found'),\n            file: null,\n        };\n\n        // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n        if (item.archived) return failure(err);\n\n        // allow plugins to alter the file data\n        applyFilterChain('PREPARE_OUTPUT', item.file, { query, item }).then(result => {\n            applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, { query, item }).then(result => {\n                // don't handle archived items, an item could have been archived (load aborted) while being prepared\n                if (item.archived) return failure(err);\n\n                // we done!\n                success(result);\n            });\n        });\n    },\n\n    COMPLETE_LOAD_ITEM: ({ item, data }) => {\n        const { success, source } = data;\n\n        // sort items in list\n        const itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n        if (isFunction(itemInsertLocation) && source) {\n            sortItems(state, itemInsertLocation);\n        }\n\n        // let interface know the item has loaded\n        dispatch('DID_LOAD_ITEM', {\n            id: item.id,\n            error: null,\n            serverFileReference: item.origin === FileOrigin.INPUT ? null : source,\n        });\n\n        // item has been successfully loaded and added to the\n        // list of items so can now be safely returned for use\n        success(createItemAPI(item));\n\n        // if this is a local server file we need to show a different state\n        if (item.origin === FileOrigin.LOCAL) {\n            dispatch('DID_LOAD_LOCAL_ITEM', { id: item.id });\n            return;\n        }\n\n        // if is a temp server file we prevent async upload call here (as the file is already on the server)\n        if (item.origin === FileOrigin.LIMBO) {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n                id: item.id,\n                error: null,\n                serverFileReference: source,\n            });\n\n            dispatch('DID_DEFINE_VALUE', {\n                id: item.id,\n                value: item.serverId || source,\n            });\n            return;\n        }\n\n        // id we are allowed to upload the file immediately, lets do it\n        if (query('IS_ASYNC') && state.options.instantUpload) {\n            dispatch('REQUEST_ITEM_PROCESSING', { query: item.id });\n        }\n    },\n\n    RETRY_ITEM_LOAD: getItemByQueryFromState(state, item => {\n        // try loading the source one more time\n        item.retryLoad();\n    }),\n\n    REQUEST_ITEM_PREPARE: getItemByQueryFromState(state, (item, success, failure) => {\n        dispatch(\n            'REQUEST_PREPARE_OUTPUT',\n            {\n                query: item.id,\n                item,\n                success: file => {\n                    dispatch('DID_PREPARE_OUTPUT', { id: item.id, file });\n                    success({\n                        file: item,\n                        output: file,\n                    });\n                },\n                failure,\n            },\n            true\n        );\n    }),\n\n    REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, (item, success, failure) => {\n        // cannot be queued (or is already queued)\n        const itemCanBeQueuedForProcessing =\n            // waiting for something\n            item.status === ItemStatus.IDLE ||\n            // processing went wrong earlier\n            item.status === ItemStatus.PROCESSING_ERROR;\n\n        // not ready to be processed\n        if (!itemCanBeQueuedForProcessing) {\n            const processNow = () =>\n                dispatch('REQUEST_ITEM_PROCESSING', { query: item, success, failure });\n\n            const process = () => (document.hidden ? processNow() : setTimeout(processNow, 32));\n\n            // if already done processing or tried to revert but didn't work, try again\n            if (\n                item.status === ItemStatus.PROCESSING_COMPLETE ||\n                item.status === ItemStatus.PROCESSING_REVERT_ERROR\n            ) {\n                item.revert(\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\n                    query('GET_FORCE_REVERT')\n                )\n                    .then(process)\n                    .catch(() => {}); // don't continue with processing if something went wrong\n            } else if (item.status === ItemStatus.PROCESSING) {\n                item.abortProcessing().then(process);\n            }\n\n            return;\n        }\n\n        // already queued for processing\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n\n        item.requestProcessing();\n\n        dispatch('DID_REQUEST_ITEM_PROCESSING', { id: item.id });\n\n        dispatch('PROCESS_ITEM', { query: item, success, failure }, true);\n    }),\n\n    PROCESS_ITEM: getItemByQueryFromState(state, (item, success, failure) => {\n        const maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n        const totalCurrentUploads = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING).length;\n\n        // queue and wait till queue is freed up\n        if (totalCurrentUploads === maxParallelUploads) {\n            // queue for later processing\n            state.processingQueue.push({\n                id: item.id,\n                success,\n                failure,\n            });\n\n            // stop it!\n            return;\n        }\n\n        // if was not queued or is already processing exit here\n        if (item.status === ItemStatus.PROCESSING) return;\n\n        const processNext = () => {\n            // process queueud items\n            const queueEntry = state.processingQueue.shift();\n\n            // no items left\n            if (!queueEntry) return;\n\n            // get item reference\n            const { id, success, failure } = queueEntry;\n            const itemReference = getItemByQuery(state.items, id);\n\n            // if item was archived while in queue, jump to next\n            if (!itemReference || itemReference.archived) {\n                processNext();\n                return;\n            }\n\n            // process queued item\n            dispatch('PROCESS_ITEM', { query: id, success, failure }, true);\n        };\n\n        // we done function\n        item.onOnce('process-complete', () => {\n            success(createItemAPI(item));\n            processNext();\n\n            // if origin is local, and we're instant uploading, trigger remove of original\n            // as revert will remove file from list\n            const server = state.options.server;\n            const instantUpload = state.options.instantUpload;\n            if (instantUpload && item.origin === FileOrigin.LOCAL && isFunction(server.remove)) {\n                const noop = () => {};\n                item.origin = FileOrigin.LIMBO;\n                state.options.server.remove(item.source, noop, noop);\n            }\n\n            // All items processed? No errors?\n            const allItemsProcessed =\n                query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE).length ===\n                state.items.length;\n            if (allItemsProcessed) {\n                dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n            }\n        });\n\n        // we error function\n        item.onOnce('process-error', error => {\n            failure({ error, file: createItemAPI(item) });\n            processNext();\n        });\n\n        // start file processing\n        const options = state.options;\n        item.process(\n            createFileProcessor(\n                createProcessorFunction(options.server.url, options.server.process, options.name, {\n                    chunkTransferId: item.transferId,\n                    chunkServer: options.server.patch,\n                    chunkUploads: options.chunkUploads,\n                    chunkForce: options.chunkForce,\n                    chunkSize: options.chunkSize,\n                    chunkRetryDelays: options.chunkRetryDelays,\n                }),\n                {\n                    allowMinimumUploadDuration: query('GET_ALLOW_MINIMUM_UPLOAD_DURATION'),\n                }\n            ),\n            // called when the file is about to be processed so it can be piped through the transform filters\n            (file, success, error) => {\n                // allow plugins to alter the file data\n                applyFilterChain('PREPARE_OUTPUT', file, { query, item })\n                    .then(file => {\n                        dispatch('DID_PREPARE_OUTPUT', { id: item.id, file });\n\n                        success(file);\n                    })\n                    .catch(error);\n            }\n        );\n    }),\n\n    RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\n        dispatch('REQUEST_ITEM_PROCESSING', { query: item });\n    }),\n\n    REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, item => {\n        optionalPromise(query('GET_BEFORE_REMOVE_FILE'), createItemAPI(item)).then(shouldRemove => {\n            if (!shouldRemove) {\n                return;\n            }\n            dispatch('REMOVE_ITEM', { query: item });\n        });\n    }),\n\n    RELEASE_ITEM: getItemByQueryFromState(state, item => {\n        item.release();\n    }),\n\n    REMOVE_ITEM: getItemByQueryFromState(state, (item, success, failure, options) => {\n        const removeFromView = () => {\n            // get id reference\n            const id = item.id;\n\n            // archive the item, this does not remove it from the list\n            getItemById(state.items, id).archive();\n\n            // tell the view the item has been removed\n            dispatch('DID_REMOVE_ITEM', { error: null, id, item });\n\n            // now the list has been modified\n            listUpdated(dispatch, state);\n\n            // correctly removed\n            success(createItemAPI(item));\n        };\n\n        // if this is a local file and the `server.remove` function has been configured,\n        // send source there so dev can remove file from server\n        const server = state.options.server;\n        if (\n            item.origin === FileOrigin.LOCAL &&\n            server &&\n            isFunction(server.remove) &&\n            options.remove !== false\n        ) {\n            dispatch('DID_START_ITEM_REMOVE', { id: item.id });\n\n            server.remove(\n                item.source,\n                () => removeFromView(),\n                status => {\n                    dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n                        id: item.id,\n                        error: createResponse('error', 0, status, null),\n                        status: {\n                            main: dynamicLabel(state.options.labelFileRemoveError)(status),\n                            sub: state.options.labelTapToRetry,\n                        },\n                    });\n                }\n            );\n        } else {\n            // if is requesting revert and can revert need to call revert handler (not calling request_ because that would also trigger beforeRemoveHook)\n            if (\n                (options.revert && item.origin !== FileOrigin.LOCAL && item.serverId !== null) ||\n                // if chunked uploads are enabled and we're uploading in chunks for this specific file\n                // or if the file isn't big enough for chunked uploads but chunkForce is set then call\n                // revert before removing from the view...\n                (state.options.chunkUploads && item.file.size > state.options.chunkSize) ||\n                (state.options.chunkUploads && state.options.chunkForce)\n            ) {\n                item.revert(\n                    createRevertFunction(state.options.server.url, state.options.server.revert),\n                    query('GET_FORCE_REVERT')\n                );\n            }\n\n            // can now safely remove from view\n            removeFromView();\n        }\n    }),\n\n    ABORT_ITEM_LOAD: getItemByQueryFromState(state, item => {\n        item.abortLoad();\n    }),\n\n    ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\n        // test if is already processed\n        if (item.serverId) {\n            dispatch('REVERT_ITEM_PROCESSING', { id: item.id });\n            return;\n        }\n\n        // abort\n        item.abortProcessing().then(() => {\n            const shouldRemove = state.options.instantUpload;\n            if (shouldRemove) {\n                dispatch('REMOVE_ITEM', { query: item.id });\n            }\n        });\n    }),\n\n    REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\n        // not instant uploading, revert immediately\n        if (!state.options.instantUpload) {\n            dispatch('REVERT_ITEM_PROCESSING', { query: item });\n            return;\n        }\n\n        // if we're instant uploading the file will also be removed if we revert,\n        // so if a before remove file hook is defined we need to run it now\n        const handleRevert = shouldRevert => {\n            if (!shouldRevert) return;\n            dispatch('REVERT_ITEM_PROCESSING', { query: item });\n        };\n\n        const fn = query('GET_BEFORE_REMOVE_FILE');\n        if (!fn) {\n            return handleRevert(true);\n        }\n\n        const requestRemoveResult = fn(createItemAPI(item));\n        if (requestRemoveResult == null) {\n            // undefined or null\n            return handleRevert(true);\n        }\n\n        if (typeof requestRemoveResult === 'boolean') {\n            return handleRevert(requestRemoveResult);\n        }\n\n        if (typeof requestRemoveResult.then === 'function') {\n            requestRemoveResult.then(handleRevert);\n        }\n    }),\n\n    REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, item => {\n        item.revert(\n            createRevertFunction(state.options.server.url, state.options.server.revert),\n            query('GET_FORCE_REVERT')\n        )\n            .then(() => {\n                const shouldRemove = state.options.instantUpload || isMockItem(item);\n                if (shouldRemove) {\n                    dispatch('REMOVE_ITEM', { query: item.id });\n                }\n            })\n            .catch(() => {});\n    }),\n\n    SET_OPTIONS: ({ options }) => {\n        // get all keys passed\n        const optionKeys = Object.keys(options);\n\n        // get prioritized keyed to include (remove once not in options object)\n        const prioritizedOptionKeys = PrioritizedOptions.filter(key => optionKeys.includes(key));\n\n        // order the keys, prioritized first, then rest\n        const orderedOptionKeys = [\n            // add prioritized first if passed to options, else remove\n            ...prioritizedOptionKeys,\n\n            // prevent duplicate keys\n            ...Object.keys(options).filter(key => !prioritizedOptionKeys.includes(key)),\n        ];\n\n        // dispatch set event for each option\n        orderedOptionKeys.forEach(key => {\n            dispatch(`SET_${fromCamels(key, '_').toUpperCase()}`, {\n                value: options[key],\n            });\n        });\n    },\n});\n\nconst PrioritizedOptions = [\n    'server', // must be processed before \"files\"\n];\n\nconst formatFilename = name => name;\n\nconst createElement$1 = tagName => {\n    return document.createElement(tagName);\n};\n\nconst text = (node, value) => {\n    let textNode = node.childNodes[0];\n    if (!textNode) {\n        textNode = document.createTextNode(value);\n        node.appendChild(textNode);\n    } else if (value !== textNode.nodeValue) {\n        textNode.nodeValue = value;\n    }\n};\n\nconst polarToCartesian = (centerX, centerY, radius, angleInDegrees) => {\n    const angleInRadians = (((angleInDegrees % 360) - 90) * Math.PI) / 180.0;\n    return {\n        x: centerX + radius * Math.cos(angleInRadians),\n        y: centerY + radius * Math.sin(angleInRadians),\n    };\n};\n\nconst describeArc = (x, y, radius, startAngle, endAngle, arcSweep) => {\n    const start = polarToCartesian(x, y, radius, endAngle);\n    const end = polarToCartesian(x, y, radius, startAngle);\n    return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');\n};\n\nconst percentageArc = (x, y, radius, from, to) => {\n    let arcSweep = 1;\n    if (to > from && to - from <= 0.5) {\n        arcSweep = 0;\n    }\n    if (from > to && from - to >= 0.5) {\n        arcSweep = 0;\n    }\n    return describeArc(\n        x,\n        y,\n        radius,\n        Math.min(0.9999, from) * 360,\n        Math.min(0.9999, to) * 360,\n        arcSweep\n    );\n};\n\nconst create = ({ root, props }) => {\n    // start at 0\n    props.spin = false;\n    props.progress = 0;\n    props.opacity = 0;\n\n    // svg\n    const svg = createElement('svg');\n    root.ref.path = createElement('path', {\n        'stroke-width': 2,\n        'stroke-linecap': 'round',\n    });\n    svg.appendChild(root.ref.path);\n\n    root.ref.svg = svg;\n\n    root.appendChild(svg);\n};\n\nconst write = ({ root, props }) => {\n    if (props.opacity === 0) {\n        return;\n    }\n\n    if (props.align) {\n        root.element.dataset.align = props.align;\n    }\n\n    // get width of stroke\n    const ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10);\n\n    // calculate size of ring\n    const size = root.rect.element.width * 0.5;\n\n    // ring state\n    let ringFrom = 0;\n    let ringTo = 0;\n\n    // now in busy mode\n    if (props.spin) {\n        ringFrom = 0;\n        ringTo = 0.5;\n    } else {\n        ringFrom = 0;\n        ringTo = props.progress;\n    }\n\n    // get arc path\n    const coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo);\n\n    // update progress bar\n    attr(root.ref.path, 'd', coordinates);\n\n    // hide while contains 0 value\n    attr(root.ref.path, 'stroke-opacity', props.spin || props.progress > 0 ? 1 : 0);\n};\n\nconst progressIndicator = createView({\n    tag: 'div',\n    name: 'progress-indicator',\n    ignoreRectUpdate: true,\n    ignoreRect: true,\n    create,\n    write,\n    mixins: {\n        apis: ['progress', 'spin', 'align'],\n        styles: ['opacity'],\n        animations: {\n            opacity: { type: 'tween', duration: 500 },\n            progress: {\n                type: 'spring',\n                stiffness: 0.95,\n                damping: 0.65,\n                mass: 10,\n            },\n        },\n    },\n});\n\nconst create$1 = ({ root, props }) => {\n    root.element.innerHTML = (props.icon || '') + `<span>${props.label}</span>`;\n\n    props.isDisabled = false;\n};\n\nconst write$1 = ({ root, props }) => {\n    const { isDisabled } = props;\n    const shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n\n    if (shouldDisable && !isDisabled) {\n        props.isDisabled = true;\n        attr(root.element, 'disabled', 'disabled');\n    } else if (!shouldDisable && isDisabled) {\n        props.isDisabled = false;\n        root.element.removeAttribute('disabled');\n    }\n};\n\nconst fileActionButton = createView({\n    tag: 'button',\n    attributes: {\n        type: 'button',\n    },\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'file-action-button',\n    mixins: {\n        apis: ['label'],\n        styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n        animations: {\n            scaleX: 'spring',\n            scaleY: 'spring',\n            translateX: 'spring',\n            translateY: 'spring',\n            opacity: { type: 'tween', duration: 250 },\n        },\n        listeners: true,\n    },\n    create: create$1,\n    write: write$1,\n});\n\nconst toNaturalFileSize = (bytes, decimalSeparator = '.', base = 1000, options = {}) => {\n    const {\n        labelBytes = 'bytes',\n        labelKilobytes = 'KB',\n        labelMegabytes = 'MB',\n        labelGigabytes = 'GB',\n    } = options;\n\n    // no negative byte sizes\n    bytes = Math.round(Math.abs(bytes));\n\n    const KB = base;\n    const MB = base * base;\n    const GB = base * base * base;\n\n    // just bytes\n    if (bytes < KB) {\n        return `${bytes} ${labelBytes}`;\n    }\n\n    // kilobytes\n    if (bytes < MB) {\n        return `${Math.floor(bytes / KB)} ${labelKilobytes}`;\n    }\n\n    // megabytes\n    if (bytes < GB) {\n        return `${removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator)} ${labelMegabytes}`;\n    }\n\n    // gigabytes\n    return `${removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator)} ${labelGigabytes}`;\n};\n\nconst removeDecimalsWhenZero = (value, decimalCount, separator) => {\n    return value\n        .toFixed(decimalCount)\n        .split('.')\n        .filter(part => part !== '0')\n        .join(separator);\n};\n\nconst create$2 = ({ root, props }) => {\n    // filename\n    const fileName = createElement$1('span');\n    fileName.className = 'filepond--file-info-main';\n    // hide for screenreaders\n    // the file is contained in a fieldset with legend that contains the filename\n    // no need to read it twice\n    attr(fileName, 'aria-hidden', 'true');\n    root.appendChild(fileName);\n    root.ref.fileName = fileName;\n\n    // filesize\n    const fileSize = createElement$1('span');\n    fileSize.className = 'filepond--file-info-sub';\n    root.appendChild(fileSize);\n    root.ref.fileSize = fileSize;\n\n    // set initial values\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n};\n\nconst updateFile = ({ root, props }) => {\n    text(\n        root.ref.fileSize,\n        toNaturalFileSize(\n            root.query('GET_ITEM_SIZE', props.id),\n            '.',\n            root.query('GET_FILE_SIZE_BASE'),\n            root.query('GET_FILE_SIZE_LABELS', root.query)\n        )\n    );\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n};\n\nconst updateFileSizeOnError = ({ root, props }) => {\n    // if size is available don't fallback to unknown size message\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n        updateFile({ root, props });\n        return;\n    }\n\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n};\n\nconst fileInfo = createView({\n    name: 'file-info',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n        DID_LOAD_ITEM: updateFile,\n        DID_UPDATE_ITEM_META: updateFile,\n        DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n        DID_THROW_ITEM_INVALID: updateFileSizeOnError,\n    }),\n    didCreateView: root => {\n        applyFilters('CREATE_VIEW', { ...root, view: root });\n    },\n    create: create$2,\n    mixins: {\n        styles: ['translateX', 'translateY'],\n        animations: {\n            translateX: 'spring',\n            translateY: 'spring',\n        },\n    },\n});\n\nconst toPercentage = value => Math.round(value * 100);\n\nconst create$3 = ({ root }) => {\n    // main status\n    const main = createElement$1('span');\n    main.className = 'filepond--file-status-main';\n    root.appendChild(main);\n    root.ref.main = main;\n\n    // sub status\n    const sub = createElement$1('span');\n    sub.className = 'filepond--file-status-sub';\n    root.appendChild(sub);\n    root.ref.sub = sub;\n\n    didSetItemLoadProgress({ root, action: { progress: null } });\n};\n\nconst didSetItemLoadProgress = ({ root, action }) => {\n    const title =\n        action.progress === null\n            ? root.query('GET_LABEL_FILE_LOADING')\n            : `${root.query('GET_LABEL_FILE_LOADING')} ${toPercentage(action.progress)}%`;\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n};\n\nconst didSetItemProcessProgress = ({ root, action }) => {\n    const title =\n        action.progress === null\n            ? root.query('GET_LABEL_FILE_PROCESSING')\n            : `${root.query('GET_LABEL_FILE_PROCESSING')} ${toPercentage(action.progress)}%`;\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n};\n\nconst didRequestItemProcessing = ({ root }) => {\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n};\n\nconst didAbortItemProcessing = ({ root }) => {\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n};\n\nconst didCompleteItemProcessing = ({ root }) => {\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n};\n\nconst clear = ({ root }) => {\n    text(root.ref.main, '');\n    text(root.ref.sub, '');\n};\n\nconst error = ({ root, action }) => {\n    text(root.ref.main, action.status.main);\n    text(root.ref.sub, action.status.sub);\n};\n\nconst fileStatus = createView({\n    name: 'file-status',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n        DID_LOAD_ITEM: clear,\n        DID_REVERT_ITEM_PROCESSING: clear,\n        DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n        DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n        DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n        DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n        DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n        DID_THROW_ITEM_LOAD_ERROR: error,\n        DID_THROW_ITEM_INVALID: error,\n        DID_THROW_ITEM_PROCESSING_ERROR: error,\n        DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n        DID_THROW_ITEM_REMOVE_ERROR: error,\n    }),\n    didCreateView: root => {\n        applyFilters('CREATE_VIEW', { ...root, view: root });\n    },\n    create: create$3,\n    mixins: {\n        styles: ['translateX', 'translateY', 'opacity'],\n        animations: {\n            opacity: { type: 'tween', duration: 250 },\n            translateX: 'spring',\n            translateY: 'spring',\n        },\n    },\n});\n\n/**\n * Button definitions for the file view\n */\n\nconst Buttons = {\n    AbortItemLoad: {\n        label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n        action: 'ABORT_ITEM_LOAD',\n        className: 'filepond--action-abort-item-load',\n        align: 'LOAD_INDICATOR_POSITION', // right\n    },\n    RetryItemLoad: {\n        label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n        action: 'RETRY_ITEM_LOAD',\n        icon: 'GET_ICON_RETRY',\n        className: 'filepond--action-retry-item-load',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n    RemoveItem: {\n        label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n        action: 'REQUEST_REMOVE_ITEM',\n        icon: 'GET_ICON_REMOVE',\n        className: 'filepond--action-remove-item',\n        align: 'BUTTON_REMOVE_ITEM_POSITION', // left\n    },\n    ProcessItem: {\n        label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n        action: 'REQUEST_ITEM_PROCESSING',\n        icon: 'GET_ICON_PROCESS',\n        className: 'filepond--action-process-item',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n    AbortItemProcessing: {\n        label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n        action: 'ABORT_ITEM_PROCESSING',\n        className: 'filepond--action-abort-item-processing',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n    RetryItemProcessing: {\n        label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n        action: 'RETRY_ITEM_PROCESSING',\n        icon: 'GET_ICON_RETRY',\n        className: 'filepond--action-retry-item-processing',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n    RevertItemProcessing: {\n        label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n        action: 'REQUEST_REVERT_ITEM_PROCESSING',\n        icon: 'GET_ICON_UNDO',\n        className: 'filepond--action-revert-item-processing',\n        align: 'BUTTON_PROCESS_ITEM_POSITION', // right\n    },\n};\n\n// make a list of buttons, we can then remove buttons from this list if they're disabled\nconst ButtonKeys = [];\nforin(Buttons, key => {\n    ButtonKeys.push(key);\n});\n\nconst calculateFileInfoOffset = root => {\n    if (getRemoveIndicatorAligment(root) === 'right') return 0;\n    const buttonRect = root.ref.buttonRemoveItem.rect.element;\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n};\n\nconst calculateButtonWidth = root => {\n    const buttonRect = root.ref.buttonAbortItemLoad.rect.element;\n    return buttonRect.width;\n};\n\n// Force on full pixels so text stays crips\nconst calculateFileVerticalCenterOffset = root =>\n    Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\nconst calculateFileHorizontalCenterOffset = root =>\n    Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n\nconst getLoadIndicatorAlignment = root => root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\nconst getProcessIndicatorAlignment = root => root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\nconst getRemoveIndicatorAligment = root => root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n\nconst DefaultStyle = {\n    buttonAbortItemLoad: { opacity: 0 },\n    buttonRetryItemLoad: { opacity: 0 },\n    buttonRemoveItem: { opacity: 0 },\n    buttonProcessItem: { opacity: 0 },\n    buttonAbortItemProcessing: { opacity: 0 },\n    buttonRetryItemProcessing: { opacity: 0 },\n    buttonRevertItemProcessing: { opacity: 0 },\n    loadProgressIndicator: { opacity: 0, align: getLoadIndicatorAlignment },\n    processProgressIndicator: { opacity: 0, align: getProcessIndicatorAlignment },\n    processingCompleteIndicator: { opacity: 0, scaleX: 0.75, scaleY: 0.75 },\n    info: { translateX: 0, translateY: 0, opacity: 0 },\n    status: { translateX: 0, translateY: 0, opacity: 0 },\n};\n\nconst IdleStyle = {\n    buttonRemoveItem: { opacity: 1 },\n    buttonProcessItem: { opacity: 1 },\n    info: { translateX: calculateFileInfoOffset },\n    status: { translateX: calculateFileInfoOffset },\n};\n\nconst ProcessingStyle = {\n    buttonAbortItemProcessing: { opacity: 1 },\n    processProgressIndicator: { opacity: 1 },\n    status: { opacity: 1 },\n};\n\nconst StyleMap = {\n    DID_THROW_ITEM_INVALID: {\n        buttonRemoveItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { translateX: calculateFileInfoOffset, opacity: 1 },\n    },\n    DID_START_ITEM_LOAD: {\n        buttonAbortItemLoad: { opacity: 1 },\n        loadProgressIndicator: { opacity: 1 },\n        status: { opacity: 1 },\n    },\n    DID_THROW_ITEM_LOAD_ERROR: {\n        buttonRetryItemLoad: { opacity: 1 },\n        buttonRemoveItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { opacity: 1 },\n    },\n    DID_START_ITEM_REMOVE: {\n        processProgressIndicator: { opacity: 1, align: getRemoveIndicatorAligment },\n        info: { translateX: calculateFileInfoOffset },\n        status: { opacity: 0 },\n    },\n    DID_THROW_ITEM_REMOVE_ERROR: {\n        processProgressIndicator: { opacity: 0, align: getRemoveIndicatorAligment },\n        buttonRemoveItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { opacity: 1, translateX: calculateFileInfoOffset },\n    },\n    DID_LOAD_ITEM: IdleStyle,\n    DID_LOAD_LOCAL_ITEM: {\n        buttonRemoveItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { translateX: calculateFileInfoOffset },\n    },\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n    DID_COMPLETE_ITEM_PROCESSING: {\n        buttonRevertItemProcessing: { opacity: 1 },\n        info: { opacity: 1 },\n        status: { opacity: 1 },\n    },\n    DID_THROW_ITEM_PROCESSING_ERROR: {\n        buttonRemoveItem: { opacity: 1 },\n        buttonRetryItemProcessing: { opacity: 1 },\n        status: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n    },\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n        buttonRevertItemProcessing: { opacity: 1 },\n        status: { opacity: 1 },\n        info: { opacity: 1 },\n    },\n    DID_ABORT_ITEM_PROCESSING: {\n        buttonRemoveItem: { opacity: 1 },\n        buttonProcessItem: { opacity: 1 },\n        info: { translateX: calculateFileInfoOffset },\n        status: { opacity: 1 },\n    },\n    DID_REVERT_ITEM_PROCESSING: IdleStyle,\n};\n\n// complete indicator view\nconst processingCompleteIndicatorView = createView({\n    create: ({ root }) => {\n        root.element.innerHTML = root.query('GET_ICON_DONE');\n    },\n    name: 'processing-complete-indicator',\n    ignoreRect: true,\n    mixins: {\n        styles: ['scaleX', 'scaleY', 'opacity'],\n        animations: {\n            scaleX: 'spring',\n            scaleY: 'spring',\n            opacity: { type: 'tween', duration: 250 },\n        },\n    },\n});\n\n/**\n * Creates the file view\n */\nconst create$4 = ({ root, props }) => {\n    // copy Buttons object\n    const LocalButtons = Object.keys(Buttons).reduce((prev, curr) => {\n        prev[curr] = { ...Buttons[curr] };\n        return prev;\n    }, {});\n\n    const { id } = props;\n\n    // allow reverting upload\n    const allowRevert = root.query('GET_ALLOW_REVERT');\n\n    // allow remove file\n    const allowRemove = root.query('GET_ALLOW_REMOVE');\n\n    // allow processing upload\n    const allowProcess = root.query('GET_ALLOW_PROCESS');\n\n    // is instant uploading, need this to determine the icon of the undo button\n    const instantUpload = root.query('GET_INSTANT_UPLOAD');\n\n    // is async set up\n    const isAsync = root.query('IS_ASYNC');\n\n    // should align remove item buttons\n    const alignRemoveItemButton = root.query('GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN');\n\n    // enabled buttons array\n    let buttonFilter;\n    if (isAsync) {\n        if (allowProcess && !allowRevert) {\n            // only remove revert button\n            buttonFilter = key => !/RevertItemProcessing/.test(key);\n        } else if (!allowProcess && allowRevert) {\n            // only remove process button\n            buttonFilter = key => !/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(key);\n        } else if (!allowProcess && !allowRevert) {\n            // remove all process buttons\n            buttonFilter = key => !/Process/.test(key);\n        }\n    } else {\n        // no process controls available\n        buttonFilter = key => !/Process/.test(key);\n    }\n\n    const enabledButtons = buttonFilter ? ButtonKeys.filter(buttonFilter) : ButtonKeys.concat();\n\n    // update icon and label for revert button when instant uploading\n    if (instantUpload && allowRevert) {\n        LocalButtons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n        LocalButtons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n    }\n\n    // remove last button (revert) if not allowed\n    if (isAsync && !allowRevert) {\n        const map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n        map.info.translateX = calculateFileHorizontalCenterOffset;\n        map.info.translateY = calculateFileVerticalCenterOffset;\n        map.status.translateY = calculateFileVerticalCenterOffset;\n        map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n    }\n\n    // should align center\n    if (isAsync && !allowProcess) {\n        [\n            'DID_START_ITEM_PROCESSING',\n            'DID_REQUEST_ITEM_PROCESSING',\n            'DID_UPDATE_ITEM_PROCESS_PROGRESS',\n            'DID_THROW_ITEM_PROCESSING_ERROR',\n        ].forEach(key => {\n            StyleMap[key].status.translateY = calculateFileVerticalCenterOffset;\n        });\n        StyleMap['DID_THROW_ITEM_PROCESSING_ERROR'].status.translateX = calculateButtonWidth;\n    }\n\n    // move remove button to right\n    if (alignRemoveItemButton && allowRevert) {\n        LocalButtons['RevertItemProcessing'].align = 'BUTTON_REMOVE_ITEM_POSITION';\n        const map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n        map.info.translateX = calculateFileInfoOffset;\n        map.status.translateY = calculateFileVerticalCenterOffset;\n        map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n    }\n\n    // show/hide RemoveItem button\n    if (!allowRemove) {\n        LocalButtons['RemoveItem'].disabled = true;\n    }\n\n    // create the button views\n    forin(LocalButtons, (key, definition) => {\n        // create button\n        const buttonView = root.createChildView(fileActionButton, {\n            label: root.query(definition.label),\n            icon: root.query(definition.icon),\n            opacity: 0,\n        });\n\n        // should be appended?\n        if (enabledButtons.includes(key)) {\n            root.appendChildView(buttonView);\n        }\n\n        // toggle\n        if (definition.disabled) {\n            buttonView.element.setAttribute('disabled', 'disabled');\n            buttonView.element.setAttribute('hidden', 'hidden');\n        }\n\n        // add position attribute\n        buttonView.element.dataset.align = root.query(`GET_STYLE_${definition.align}`);\n\n        // add class\n        buttonView.element.classList.add(definition.className);\n\n        // handle interactions\n        buttonView.on('click', e => {\n            e.stopPropagation();\n            if (definition.disabled) return;\n            root.dispatch(definition.action, { query: id });\n        });\n\n        // set reference\n        root.ref[`button${key}`] = buttonView;\n    });\n\n    // checkmark\n    root.ref.processingCompleteIndicator = root.appendChildView(\n        root.createChildView(processingCompleteIndicatorView)\n    );\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query(\n        `GET_STYLE_BUTTON_PROCESS_ITEM_POSITION`\n    );\n\n    // create file info view\n    root.ref.info = root.appendChildView(root.createChildView(fileInfo, { id }));\n\n    // create file status view\n    root.ref.status = root.appendChildView(root.createChildView(fileStatus, { id }));\n\n    // add progress indicators\n    const loadIndicatorView = root.appendChildView(\n        root.createChildView(progressIndicator, {\n            opacity: 0,\n            align: root.query(`GET_STYLE_LOAD_INDICATOR_POSITION`),\n        })\n    );\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\n    root.ref.loadProgressIndicator = loadIndicatorView;\n\n    const progressIndicatorView = root.appendChildView(\n        root.createChildView(progressIndicator, {\n            opacity: 0,\n            align: root.query(`GET_STYLE_PROGRESS_INDICATOR_POSITION`),\n        })\n    );\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\n    root.ref.processProgressIndicator = progressIndicatorView;\n\n    // current active styles\n    root.ref.activeStyles = [];\n};\n\nconst write$2 = ({ root, actions, props }) => {\n    // route actions\n    route({ root, actions, props });\n\n    // select last state change action\n    let action = actions\n        .concat()\n        .filter(action => /^DID_/.test(action.type))\n        .reverse()\n        .find(action => StyleMap[action.type]);\n\n    // a new action happened, let's get the matching styles\n    if (action) {\n        // define new active styles\n        root.ref.activeStyles = [];\n\n        const stylesToApply = StyleMap[action.type];\n        forin(DefaultStyle, (name, defaultStyles) => {\n            // get reference to control\n            const control = root.ref[name];\n\n            // loop over all styles for this control\n            forin(defaultStyles, (key, defaultValue) => {\n                const value =\n                    stylesToApply[name] && typeof stylesToApply[name][key] !== 'undefined'\n                        ? stylesToApply[name][key]\n                        : defaultValue;\n                root.ref.activeStyles.push({ control, key, value });\n            });\n        });\n    }\n\n    // apply active styles to element\n    root.ref.activeStyles.forEach(({ control, key, value }) => {\n        control[key] = typeof value === 'function' ? value(root) : value;\n    });\n};\n\nconst route = createRoute({\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: ({ root, action }) => {\n        root.ref.buttonAbortItemProcessing.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: ({ root, action }) => {\n        root.ref.buttonAbortItemLoad.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: ({ root, action }) => {\n        root.ref.buttonAbortItemRemoval.label = action.value;\n    },\n    DID_REQUEST_ITEM_PROCESSING: ({ root }) => {\n        root.ref.processProgressIndicator.spin = true;\n        root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_LOAD: ({ root }) => {\n        root.ref.loadProgressIndicator.spin = true;\n        root.ref.loadProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_REMOVE: ({ root }) => {\n        root.ref.processProgressIndicator.spin = true;\n        root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_UPDATE_ITEM_LOAD_PROGRESS: ({ root, action }) => {\n        root.ref.loadProgressIndicator.spin = false;\n        root.ref.loadProgressIndicator.progress = action.progress;\n    },\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ({ root, action }) => {\n        root.ref.processProgressIndicator.spin = false;\n        root.ref.processProgressIndicator.progress = action.progress;\n    },\n});\n\nconst file = createView({\n    create: create$4,\n    write: write$2,\n    didCreateView: root => {\n        applyFilters('CREATE_VIEW', { ...root, view: root });\n    },\n    name: 'file',\n});\n\n/**\n * Creates the file view\n */\nconst create$5 = ({ root, props }) => {\n    // filename\n    root.ref.fileName = createElement$1('legend');\n    root.appendChild(root.ref.fileName);\n\n    // file appended\n    root.ref.file = root.appendChildView(root.createChildView(file, { id: props.id }));\n\n    // data has moved to data.js\n    root.ref.data = false;\n};\n\n/**\n * Data storage\n */\nconst didLoadItem = ({ root, props }) => {\n    // updates the legend of the fieldset so screenreaders can better group buttons\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n};\n\nconst fileWrapper = createView({\n    create: create$5,\n    ignoreRect: true,\n    write: createRoute({\n        DID_LOAD_ITEM: didLoadItem,\n    }),\n    didCreateView: root => {\n        applyFilters('CREATE_VIEW', { ...root, view: root });\n    },\n    tag: 'fieldset',\n    name: 'file-wrapper',\n});\n\nconst PANEL_SPRING_PROPS = { type: 'spring', damping: 0.6, mass: 7 };\n\nconst create$6 = ({ root, props }) => {\n    [\n        {\n            name: 'top',\n        },\n        {\n            name: 'center',\n            props: {\n                translateY: null,\n                scaleY: null,\n            },\n            mixins: {\n                animations: {\n                    scaleY: PANEL_SPRING_PROPS,\n                },\n                styles: ['translateY', 'scaleY'],\n            },\n        },\n        {\n            name: 'bottom',\n            props: {\n                translateY: null,\n            },\n            mixins: {\n                animations: {\n                    translateY: PANEL_SPRING_PROPS,\n                },\n                styles: ['translateY'],\n            },\n        },\n    ].forEach(section => {\n        createSection(root, section, props.name);\n    });\n\n    root.element.classList.add(`filepond--${props.name}`);\n\n    root.ref.scalable = null;\n};\n\nconst createSection = (root, section, className) => {\n    const viewConstructor = createView({\n        name: `panel-${section.name} filepond--${className}`,\n        mixins: section.mixins,\n        ignoreRectUpdate: true,\n    });\n\n    const view = root.createChildView(viewConstructor, section.props);\n\n    root.ref[section.name] = root.appendChildView(view);\n};\n\nconst write$3 = ({ root, props }) => {\n    // update scalable state\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n        root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n        root.element.dataset.scalable = root.ref.scalable;\n    }\n\n    // no height, can't set\n    if (!props.height) return;\n\n    // get child rects\n    const topRect = root.ref.top.rect.element;\n    const bottomRect = root.ref.bottom.rect.element;\n\n    // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n    const height = Math.max(topRect.height + bottomRect.height, props.height);\n\n    // offset center part\n    root.ref.center.translateY = topRect.height;\n\n    // scale center part\n    // use math ceil to prevent transparent lines because of rounding errors\n    root.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100;\n\n    // offset bottom part\n    root.ref.bottom.translateY = height - bottomRect.height;\n};\n\nconst panel = createView({\n    name: 'panel',\n    read: ({ root, props }) => (props.heightCurrent = root.ref.bottom.translateY),\n    write: write$3,\n    create: create$6,\n    ignoreRect: true,\n    mixins: {\n        apis: ['height', 'heightCurrent', 'scalable'],\n    },\n});\n\nconst createDragHelper = items => {\n    const itemIds = items.map(item => item.id);\n    let prevIndex = undefined;\n    return {\n        setIndex: index => {\n            prevIndex = index;\n        },\n        getIndex: () => prevIndex,\n        getItemIndex: item => itemIds.indexOf(item.id),\n    };\n};\n\nconst ITEM_TRANSLATE_SPRING = {\n    type: 'spring',\n    stiffness: 0.75,\n    damping: 0.45,\n    mass: 10,\n};\n\nconst ITEM_SCALE_SPRING = 'spring';\n\nconst StateMap = {\n    DID_START_ITEM_LOAD: 'busy',\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n    DID_THROW_ITEM_INVALID: 'load-invalid',\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n    DID_LOAD_ITEM: 'idle',\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n    DID_START_ITEM_REMOVE: 'busy',\n    DID_START_ITEM_PROCESSING: 'busy processing',\n    DID_REQUEST_ITEM_PROCESSING: 'busy processing',\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\n    DID_REVERT_ITEM_PROCESSING: 'idle',\n};\n\n/**\n * Creates the file view\n */\nconst create$7 = ({ root, props }) => {\n    // select\n    root.ref.handleClick = e => root.dispatch('DID_ACTIVATE_ITEM', { id: props.id });\n\n    // set id\n    root.element.id = `filepond--item-${props.id}`;\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // file view\n    root.ref.container = root.appendChildView(root.createChildView(fileWrapper, { id: props.id }));\n\n    // file panel\n    root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'item-panel' }));\n\n    // default start height\n    root.ref.panel.height = null;\n\n    // by default not marked for removal\n    props.markedForRemoval = false;\n\n    // if not allowed to reorder file items, exit here\n    if (!root.query('GET_ALLOW_REORDER')) return;\n\n    // set to idle so shows grab cursor\n    root.element.dataset.dragState = 'idle';\n\n    const grab = e => {\n        if (!e.isPrimary) return;\n\n        let removedActivateListener = false;\n\n        const origin = {\n            x: e.pageX,\n            y: e.pageY,\n        };\n\n        props.dragOrigin = {\n            x: root.translateX,\n            y: root.translateY,\n        };\n\n        props.dragCenter = {\n            x: e.offsetX,\n            y: e.offsetY,\n        };\n\n        const dragState = createDragHelper(root.query('GET_ACTIVE_ITEMS'));\n\n        root.dispatch('DID_GRAB_ITEM', { id: props.id, dragState });\n\n        const drag = e => {\n            if (!e.isPrimary) return;\n\n            e.stopPropagation();\n            e.preventDefault();\n\n            props.dragOffset = {\n                x: e.pageX - origin.x,\n                y: e.pageY - origin.y,\n            };\n\n            // if dragged stop listening to clicks, will re-add when done dragging\n            const dist =\n                props.dragOffset.x * props.dragOffset.x + props.dragOffset.y * props.dragOffset.y;\n            if (dist > 16 && !removedActivateListener) {\n                removedActivateListener = true;\n                root.element.removeEventListener('click', root.ref.handleClick);\n            }\n\n            root.dispatch('DID_DRAG_ITEM', { id: props.id, dragState });\n        };\n\n        const drop = e => {\n            if (!e.isPrimary) return;\n\n            props.dragOffset = {\n                x: e.pageX - origin.x,\n                y: e.pageY - origin.y,\n            };\n\n            reset();\n        };\n\n        const cancel = () => {\n            reset();\n        };\n\n        const reset = () => {\n            document.removeEventListener('pointercancel', cancel);\n            document.removeEventListener('pointermove', drag);\n            document.removeEventListener('pointerup', drop);\n\n            root.dispatch('DID_DROP_ITEM', { id: props.id, dragState });\n\n            // start listening to clicks again\n            if (removedActivateListener) {\n                setTimeout(() => root.element.addEventListener('click', root.ref.handleClick), 0);\n            }\n        };\n\n        document.addEventListener('pointercancel', cancel);\n        document.addEventListener('pointermove', drag);\n        document.addEventListener('pointerup', drop);\n    };\n\n    root.element.addEventListener('pointerdown', grab);\n};\n\nconst route$1 = createRoute({\n    DID_UPDATE_PANEL_HEIGHT: ({ root, action }) => {\n        root.height = action.height;\n    },\n});\n\nconst write$4 = createRoute(\n    {\n        DID_GRAB_ITEM: ({ root, props }) => {\n            props.dragOrigin = {\n                x: root.translateX,\n                y: root.translateY,\n            };\n        },\n        DID_DRAG_ITEM: ({ root }) => {\n            root.element.dataset.dragState = 'drag';\n        },\n        DID_DROP_ITEM: ({ root, props }) => {\n            props.dragOffset = null;\n            props.dragOrigin = null;\n            root.element.dataset.dragState = 'drop';\n        },\n    },\n    ({ root, actions, props, shouldOptimize }) => {\n        if (root.element.dataset.dragState === 'drop') {\n            if (root.scaleX <= 1) {\n                root.element.dataset.dragState = 'idle';\n            }\n        }\n\n        // select last state change action\n        let action = actions\n            .concat()\n            .filter(action => /^DID_/.test(action.type))\n            .reverse()\n            .find(action => StateMap[action.type]);\n\n        // no need to set same state twice\n        if (action && action.type !== props.currentState) {\n            // set current state\n            props.currentState = action.type;\n\n            // set state\n            root.element.dataset.filepondItemState = StateMap[props.currentState] || '';\n        }\n\n        // route actions\n        const aspectRatio =\n            root.query('GET_ITEM_PANEL_ASPECT_RATIO') || root.query('GET_PANEL_ASPECT_RATIO');\n        if (!aspectRatio) {\n            route$1({ root, actions, props });\n            if (!root.height && root.ref.container.rect.element.height > 0) {\n                root.height = root.ref.container.rect.element.height;\n            }\n        } else if (!shouldOptimize) {\n            root.height = root.rect.element.width * aspectRatio;\n        }\n\n        // sync panel height with item height\n        if (shouldOptimize) {\n            root.ref.panel.height = null;\n        }\n\n        root.ref.panel.height = root.height;\n    }\n);\n\nconst item = createView({\n    create: create$7,\n    write: write$4,\n    destroy: ({ root, props }) => {\n        root.element.removeEventListener('click', root.ref.handleClick);\n        root.dispatch('RELEASE_ITEM', { query: props.id });\n    },\n    tag: 'li',\n    name: 'item',\n    mixins: {\n        apis: [\n            'id',\n            'interactionMethod',\n            'markedForRemoval',\n            'spawnDate',\n            'dragCenter',\n            'dragOrigin',\n            'dragOffset',\n        ],\n        styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity', 'height'],\n        animations: {\n            scaleX: ITEM_SCALE_SPRING,\n            scaleY: ITEM_SCALE_SPRING,\n            translateX: ITEM_TRANSLATE_SPRING,\n            translateY: ITEM_TRANSLATE_SPRING,\n            opacity: { type: 'tween', duration: 150 },\n        },\n    },\n});\n\nvar getItemsPerRow = (horizontalSpace, itemWidth) => {\n    // add one pixel leeway, when using percentages for item width total items can be 1.99 per row\n\n    return Math.max(1, Math.floor((horizontalSpace + 1) / itemWidth));\n};\n\nconst getItemIndexByPosition = (view, children, positionInView) => {\n    if (!positionInView) return;\n\n    const horizontalSpace = view.rect.element.width;\n    // const children = view.childViews;\n    const l = children.length;\n    let last = null;\n\n    // -1, don't move items to accomodate (either add to top or bottom)\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1;\n\n    // let's get the item width\n    const item = children[0];\n    const itemRect = item.rect.element;\n    const itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n    const itemWidth = itemRect.width + itemHorizontalMargin;\n    const itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n        for (let index = 0; index < l; index++) {\n            const child = children[index];\n            const childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n            if (positionInView.top < childMid) {\n                return index;\n            }\n        }\n        return l;\n    }\n\n    // grid\n    const itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n    const itemHeight = itemRect.height + itemVerticalMargin;\n    for (let index = 0; index < l; index++) {\n        const indexX = index % itemsPerRow;\n        const indexY = Math.floor(index / itemsPerRow);\n\n        const offsetX = indexX * itemWidth;\n        const offsetY = indexY * itemHeight;\n\n        const itemTop = offsetY - itemRect.marginTop;\n        const itemRight = offsetX + itemWidth;\n        const itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n\n        if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n            if (positionInView.left < itemRight) {\n                return index;\n            } else if (index !== l - 1) {\n                last = index;\n            } else {\n                last = null;\n            }\n        }\n    }\n\n    if (last !== null) {\n        return last;\n    }\n\n    return l;\n};\n\nconst dropAreaDimensions = {\n    height: 0,\n    width: 0,\n    get getHeight() {\n        return this.height;\n    },\n    set setHeight(val) {\n        if (this.height === 0 || val === 0) this.height = val;\n    },\n    get getWidth() {\n        return this.width;\n    },\n    set setWidth(val) {\n        if (this.width === 0 || val === 0) this.width = val;\n    },\n    setDimensions: function(height, width) {\n        if (this.height === 0 || height === 0) this.height = height;\n        if (this.width === 0 || width === 0) this.width = width;\n    },\n};\n\nconst create$8 = ({ root }) => {\n    // need to set role to list as otherwise it won't be read as a list by VoiceOver\n    attr(root.element, 'role', 'list');\n\n    root.ref.lastItemSpanwDate = Date.now();\n};\n\n/**\n * Inserts a new item\n * @param root\n * @param action\n */\nconst addItemView = ({ root, action }) => {\n    const { id, index, interactionMethod } = action;\n\n    root.ref.addIndex = index;\n\n    const now = Date.now();\n    let spawnDate = now;\n    let opacity = 1;\n\n    if (interactionMethod !== InteractionMethod.NONE) {\n        opacity = 0;\n        const cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n        const dist = now - root.ref.lastItemSpanwDate;\n        spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n    }\n\n    root.ref.lastItemSpanwDate = spawnDate;\n\n    root.appendChildView(\n        root.createChildView(\n            // view type\n            item,\n\n            // props\n            {\n                spawnDate,\n                id,\n                opacity,\n                interactionMethod,\n            }\n        ),\n        index\n    );\n};\n\nconst moveItem = (item, x, y, vx = 0, vy = 1) => {\n    // set to null to remove animation while dragging\n    if (item.dragOffset) {\n        item.translateX = null;\n        item.translateY = null;\n        item.translateX = item.dragOrigin.x + item.dragOffset.x;\n        item.translateY = item.dragOrigin.y + item.dragOffset.y;\n        item.scaleX = 1.025;\n        item.scaleY = 1.025;\n    } else {\n        item.translateX = x;\n        item.translateY = y;\n\n        if (Date.now() > item.spawnDate) {\n            // reveal element\n            if (item.opacity === 0) {\n                introItemView(item, x, y, vx, vy);\n            }\n\n            // make sure is default scale every frame\n            item.scaleX = 1;\n            item.scaleY = 1;\n            item.opacity = 1;\n        }\n    }\n};\n\nconst introItemView = (item, x, y, vx, vy) => {\n    if (item.interactionMethod === InteractionMethod.NONE) {\n        item.translateX = null;\n        item.translateX = x;\n        item.translateY = null;\n        item.translateY = y;\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\n        item.translateX = null;\n        item.translateX = x - vx * 20;\n\n        item.translateY = null;\n        item.translateY = y - vy * 10;\n\n        item.scaleX = 0.8;\n        item.scaleY = 0.8;\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n        item.translateY = null;\n        item.translateY = y - 30;\n    } else if (item.interactionMethod === InteractionMethod.API) {\n        item.translateX = null;\n        item.translateX = x - 30;\n        item.translateY = null;\n    }\n};\n\n/**\n * Removes an existing item\n * @param root\n * @param action\n */\nconst removeItemView = ({ root, action }) => {\n    const { id } = action;\n\n    // get the view matching the given id\n    const view = root.childViews.find(child => child.id === id);\n\n    // if no view found, exit\n    if (!view) {\n        return;\n    }\n\n    // animate view out of view\n    view.scaleX = 0.9;\n    view.scaleY = 0.9;\n    view.opacity = 0;\n\n    // mark for removal\n    view.markedForRemoval = true;\n};\n\nconst getItemHeight = child =>\n    child.rect.element.height +\n    child.rect.element.marginBottom * 0.5 +\n    child.rect.element.marginTop * 0.5;\nconst getItemWidth = child =>\n    child.rect.element.width +\n    child.rect.element.marginLeft * 0.5 +\n    child.rect.element.marginRight * 0.5;\n\nconst dragItem = ({ root, action }) => {\n    const { id, dragState } = action;\n\n    // reference to item\n    const item = root.query('GET_ITEM', { id });\n\n    // get the view matching the given id\n    const view = root.childViews.find(child => child.id === id);\n\n    const numItems = root.childViews.length;\n    const oldIndex = dragState.getItemIndex(item);\n\n    // if no view found, exit\n    if (!view) return;\n\n    const dragPosition = {\n        x: view.dragOrigin.x + view.dragOffset.x + view.dragCenter.x,\n        y: view.dragOrigin.y + view.dragOffset.y + view.dragCenter.y,\n    };\n\n    // get drag area dimensions\n    const dragHeight = getItemHeight(view);\n    const dragWidth = getItemWidth(view);\n\n    // get rows and columns (There will always be at least one row and one column if a file is present)\n    let cols = Math.floor(root.rect.outer.width / dragWidth);\n    if (cols > numItems) cols = numItems;\n\n    // rows are used to find when we have left the preview area bounding box\n    const rows = Math.floor(numItems / cols + 1);\n\n    dropAreaDimensions.setHeight = dragHeight * rows;\n    dropAreaDimensions.setWidth = dragWidth * cols;\n\n    // get new index of dragged item\n    var location = {\n        y: Math.floor(dragPosition.y / dragHeight),\n        x: Math.floor(dragPosition.x / dragWidth),\n        getGridIndex: function getGridIndex() {\n            if (\n                dragPosition.y > dropAreaDimensions.getHeight ||\n                dragPosition.y < 0 ||\n                dragPosition.x > dropAreaDimensions.getWidth ||\n                dragPosition.x < 0\n            )\n                return oldIndex;\n            return this.y * cols + this.x;\n        },\n        getColIndex: function getColIndex() {\n            const items = root.query('GET_ACTIVE_ITEMS');\n            const visibleChildren = root.childViews.filter(child => child.rect.element.height);\n            const children = items.map(item =>\n                visibleChildren.find(childView => childView.id === item.id)\n            );\n            const currentIndex = children.findIndex(child => child === view);\n            const dragHeight = getItemHeight(view);\n            const l = children.length;\n            let idx = l;\n            let childHeight = 0;\n            let childBottom = 0;\n            let childTop = 0;\n            for (let i = 0; i < l; i++) {\n                childHeight = getItemHeight(children[i]);\n                childTop = childBottom;\n                childBottom = childTop + childHeight;\n                if (dragPosition.y < childBottom) {\n                    if (currentIndex > i) {\n                        if (dragPosition.y < childTop + dragHeight) {\n                            idx = i;\n                            break;\n                        }\n                        continue;\n                    }\n                    idx = i;\n                    break;\n                }\n            }\n            return idx;\n        },\n    };\n\n    // get new index\n    const index = cols > 1 ? location.getGridIndex() : location.getColIndex();\n    root.dispatch('MOVE_ITEM', { query: view, index });\n\n    // if the index of the item changed, dispatch reorder action\n    const currentIndex = dragState.getIndex();\n\n    if (currentIndex === undefined || currentIndex !== index) {\n        dragState.setIndex(index);\n\n        if (currentIndex === undefined) return;\n\n        root.dispatch('DID_REORDER_ITEMS', {\n            items: root.query('GET_ACTIVE_ITEMS'),\n            origin: oldIndex,\n            target: index,\n        });\n    }\n};\n\n/**\n * Setup action routes\n */\nconst route$2 = createRoute({\n    DID_ADD_ITEM: addItemView,\n    DID_REMOVE_ITEM: removeItemView,\n    DID_DRAG_ITEM: dragItem,\n});\n\n/**\n * Write to view\n * @param root\n * @param actions\n * @param props\n */\nconst write$5 = ({ root, props, actions, shouldOptimize }) => {\n    // route actions\n    route$2({ root, props, actions });\n\n    const { dragCoordinates } = props;\n\n    // available space on horizontal axis\n    const horizontalSpace = root.rect.element.width;\n\n    // only draw children that have dimensions\n    const visibleChildren = root.childViews.filter(child => child.rect.element.height);\n\n    // sort based on current active items\n    const children = root\n        .query('GET_ACTIVE_ITEMS')\n        .map(item => visibleChildren.find(child => child.id === item.id))\n        .filter(item => item);\n\n    // get index\n    const dragIndex = dragCoordinates\n        ? getItemIndexByPosition(root, children, dragCoordinates)\n        : null;\n\n    // add index is used to reserve the dropped/added item index till the actual item is rendered\n    const addIndex = root.ref.addIndex || null;\n\n    // add index no longer needed till possibly next draw\n    root.ref.addIndex = null;\n\n    let dragIndexOffset = 0;\n    let removeIndexOffset = 0;\n    let addIndexOffset = 0;\n\n    if (children.length === 0) return;\n\n    const childRect = children[0].rect.element;\n    const itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    const itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    const itemWidth = childRect.width + itemHorizontalMargin;\n    const itemHeight = childRect.height + itemVerticalMargin;\n    const itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n        let offsetY = 0;\n        let dragOffset = 0;\n\n        children.forEach((child, index) => {\n            if (dragIndex) {\n                let dist = index - dragIndex;\n                if (dist === -2) {\n                    dragOffset = -itemVerticalMargin * 0.25;\n                } else if (dist === -1) {\n                    dragOffset = -itemVerticalMargin * 0.75;\n                } else if (dist === 0) {\n                    dragOffset = itemVerticalMargin * 0.75;\n                } else if (dist === 1) {\n                    dragOffset = itemVerticalMargin * 0.25;\n                } else {\n                    dragOffset = 0;\n                }\n            }\n\n            if (shouldOptimize) {\n                child.translateX = null;\n                child.translateY = null;\n            }\n\n            if (!child.markedForRemoval) {\n                moveItem(child, 0, offsetY + dragOffset);\n            }\n\n            let itemHeight = child.rect.element.height + itemVerticalMargin;\n\n            let visualHeight = itemHeight * (child.markedForRemoval ? child.opacity : 1);\n\n            offsetY += visualHeight;\n        });\n    }\n    // grid\n    else {\n        let prevX = 0;\n        let prevY = 0;\n\n        children.forEach((child, index) => {\n            if (index === dragIndex) {\n                dragIndexOffset = 1;\n            }\n\n            if (index === addIndex) {\n                addIndexOffset += 1;\n            }\n\n            if (child.markedForRemoval && child.opacity < 0.5) {\n                removeIndexOffset -= 1;\n            }\n\n            const visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n\n            const indexX = visualIndex % itemsPerRow;\n            const indexY = Math.floor(visualIndex / itemsPerRow);\n\n            const offsetX = indexX * itemWidth;\n            const offsetY = indexY * itemHeight;\n\n            const vectorX = Math.sign(offsetX - prevX);\n            const vectorY = Math.sign(offsetY - prevY);\n\n            prevX = offsetX;\n            prevY = offsetY;\n\n            if (child.markedForRemoval) return;\n\n            if (shouldOptimize) {\n                child.translateX = null;\n                child.translateY = null;\n            }\n\n            moveItem(child, offsetX, offsetY, vectorX, vectorY);\n        });\n    }\n};\n\n/**\n * Filters actions that are meant specifically for a certain child of the list\n * @param child\n * @param actions\n */\nconst filterSetItemActions = (child, actions) =>\n    actions.filter(action => {\n        // if action has an id, filter out actions that don't have this child id\n        if (action.data && action.data.id) {\n            return child.id === action.data.id;\n        }\n\n        // allow all other actions\n        return true;\n    });\n\nconst list = createView({\n    create: create$8,\n    write: write$5,\n    tag: 'ul',\n    name: 'list',\n    didWriteView: ({ root }) => {\n        root.childViews\n            .filter(view => view.markedForRemoval && view.opacity === 0 && view.resting)\n            .forEach(view => {\n                view._destroy();\n                root.removeChildView(view);\n            });\n    },\n    filterFrameActionsForChild: filterSetItemActions,\n    mixins: {\n        apis: ['dragCoordinates'],\n    },\n});\n\nconst create$9 = ({ root, props }) => {\n    root.ref.list = root.appendChildView(root.createChildView(list));\n    props.dragCoordinates = null;\n    props.overflowing = false;\n};\n\nconst storeDragCoordinates = ({ root, props, action }) => {\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n    props.dragCoordinates = {\n        left: action.position.scopeLeft - root.ref.list.rect.element.left,\n        top:\n            action.position.scopeTop -\n            (root.rect.outer.top + root.rect.element.marginTop + root.rect.element.scrollTop),\n    };\n};\n\nconst clearDragCoordinates = ({ props }) => {\n    props.dragCoordinates = null;\n};\n\nconst route$3 = createRoute({\n    DID_DRAG: storeDragCoordinates,\n    DID_END_DRAG: clearDragCoordinates,\n});\n\nconst write$6 = ({ root, props, actions }) => {\n    // route actions\n    route$3({ root, props, actions });\n\n    // current drag position\n    root.ref.list.dragCoordinates = props.dragCoordinates;\n\n    // if currently overflowing but no longer received overflow\n    if (props.overflowing && !props.overflow) {\n        props.overflowing = false;\n\n        // reset overflow state\n        root.element.dataset.state = '';\n        root.height = null;\n    }\n\n    // if is not overflowing currently but does receive overflow value\n    if (props.overflow) {\n        const newHeight = Math.round(props.overflow);\n        if (newHeight !== root.height) {\n            props.overflowing = true;\n            root.element.dataset.state = 'overflow';\n            root.height = newHeight;\n        }\n    }\n};\n\nconst listScroller = createView({\n    create: create$9,\n    write: write$6,\n    name: 'list-scroller',\n    mixins: {\n        apis: ['overflow', 'dragCoordinates'],\n        styles: ['height', 'translateY'],\n        animations: {\n            translateY: 'spring',\n        },\n    },\n});\n\nconst attrToggle = (element, name, state, enabledValue = '') => {\n    if (state) {\n        attr(element, name, enabledValue);\n    } else {\n        element.removeAttribute(name);\n    }\n};\n\nconst resetFileInput = input => {\n    // no value, no need to reset\n    if (!input || input.value === '') {\n        return;\n    }\n\n    try {\n        // for modern browsers\n        input.value = '';\n    } catch (err) {}\n\n    // for IE10\n    if (input.value) {\n        // quickly append input to temp form and reset form\n        const form = createElement$1('form');\n        const parentNode = input.parentNode;\n        const ref = input.nextSibling;\n        form.appendChild(input);\n        form.reset();\n\n        // re-inject input where it originally was\n        if (ref) {\n            parentNode.insertBefore(input, ref);\n        } else {\n            parentNode.appendChild(input);\n        }\n    }\n};\n\nconst create$a = ({ root, props }) => {\n    // set id so can be referenced from outside labels\n    root.element.id = `filepond--browser-${props.id}`;\n\n    // set name of element (is removed when a value is set)\n    attr(root.element, 'name', root.query('GET_NAME'));\n\n    // we have to link this element to the status element\n    attr(root.element, 'aria-controls', `filepond--assistant-${props.id}`);\n\n    // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n    attr(root.element, 'aria-labelledby', `filepond--drop-label-${props.id}`);\n\n    // set configurable props\n    setAcceptedFileTypes({ root, action: { value: root.query('GET_ACCEPTED_FILE_TYPES') } });\n    toggleAllowMultiple({ root, action: { value: root.query('GET_ALLOW_MULTIPLE') } });\n    toggleDirectoryFilter({ root, action: { value: root.query('GET_ALLOW_DIRECTORIES_ONLY') } });\n    toggleDisabled({ root });\n    toggleRequired({ root, action: { value: root.query('GET_REQUIRED') } });\n    setCaptureMethod({ root, action: { value: root.query('GET_CAPTURE_METHOD') } });\n\n    // handle changes to the input field\n    root.ref.handleChange = e => {\n        if (!root.element.value) {\n            return;\n        }\n\n        // extract files and move value of webkitRelativePath path to _relativePath\n        const files = Array.from(root.element.files).map(file => {\n            file._relativePath = file.webkitRelativePath;\n            return file;\n        });\n\n        // we add a little delay so the OS file select window can move out of the way before we add our file\n        setTimeout(() => {\n            // load files\n            props.onload(files);\n\n            // reset input, it's just for exposing a method to drop files, should not retain any state\n            resetFileInput(root.element);\n        }, 250);\n    };\n\n    root.element.addEventListener('change', root.ref.handleChange);\n};\n\nconst setAcceptedFileTypes = ({ root, action }) => {\n    if (!root.query('GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE')) return;\n    attrToggle(root.element, 'accept', !!action.value, action.value ? action.value.join(',') : '');\n};\n\nconst toggleAllowMultiple = ({ root, action }) => {\n    attrToggle(root.element, 'multiple', action.value);\n};\n\nconst toggleDirectoryFilter = ({ root, action }) => {\n    attrToggle(root.element, 'webkitdirectory', action.value);\n};\n\nconst toggleDisabled = ({ root }) => {\n    const isDisabled = root.query('GET_DISABLED');\n    const doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n    const disableField = isDisabled || !doesAllowBrowse;\n    attrToggle(root.element, 'disabled', disableField);\n};\n\nconst toggleRequired = ({ root, action }) => {\n    // want to remove required, always possible\n    if (!action.value) {\n        attrToggle(root.element, 'required', false);\n    }\n    // if want to make required, only possible when zero items\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\n        attrToggle(root.element, 'required', true);\n    }\n};\n\nconst setCaptureMethod = ({ root, action }) => {\n    attrToggle(root.element, 'capture', !!action.value, action.value === true ? '' : action.value);\n};\n\nconst updateRequiredStatus = ({ root }) => {\n    const { element } = root;\n    // always remove the required attribute when more than zero items\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\n        attrToggle(element, 'required', false);\n        attrToggle(element, 'name', false);\n\n        // still has items\n        const activeItems = root.query('GET_ACTIVE_ITEMS');\n        let hasInvalidField = false;\n        for (let i = 0; i < activeItems.length; i++) {\n            if (activeItems[i].status === ItemStatus.LOAD_ERROR) {\n                hasInvalidField = true;\n            }\n        }\n        // set validity status\n        root.element.setCustomValidity(\n            hasInvalidField ? root.query('GET_LABEL_INVALID_FIELD') : ''\n        );\n    } else {\n        // add name attribute\n        attrToggle(element, 'name', true, root.query('GET_NAME'));\n\n        // remove any validation messages\n        const shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n        if (shouldCheckValidity) {\n            element.setCustomValidity('');\n        }\n\n        // we only add required if the field has been deemed required\n        if (root.query('GET_REQUIRED')) {\n            attrToggle(element, 'required', true);\n        }\n    }\n};\n\nconst updateFieldValidityStatus = ({ root }) => {\n    const shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n    if (!shouldCheckValidity) return;\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n};\n\nconst browser = createView({\n    tag: 'input',\n    name: 'browser',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    attributes: {\n        type: 'file',\n    },\n    create: create$a,\n    destroy: ({ root }) => {\n        root.element.removeEventListener('change', root.ref.handleChange);\n    },\n    write: createRoute({\n        DID_LOAD_ITEM: updateRequiredStatus,\n        DID_REMOVE_ITEM: updateRequiredStatus,\n        DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n\n        DID_SET_DISABLED: toggleDisabled,\n        DID_SET_ALLOW_BROWSE: toggleDisabled,\n        DID_SET_ALLOW_DIRECTORIES_ONLY: toggleDirectoryFilter,\n        DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n        DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n        DID_SET_CAPTURE_METHOD: setCaptureMethod,\n        DID_SET_REQUIRED: toggleRequired,\n    }),\n});\n\nconst Key = {\n    ENTER: 13,\n    SPACE: 32,\n};\n\nconst create$b = ({ root, props }) => {\n    // create the label and link it to the file browser\n    const label = createElement$1('label');\n    attr(label, 'for', `filepond--browser-${props.id}`);\n\n    // use for labeling file input (aria-labelledby on file input)\n    attr(label, 'id', `filepond--drop-label-${props.id}`);\n\n    // handle keys\n    root.ref.handleKeyDown = e => {\n        const isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n        if (!isActivationKey) return;\n        // stops from triggering the element a second time\n        e.preventDefault();\n\n        // click link (will then in turn activate file input)\n        root.ref.label.click();\n    };\n\n    root.ref.handleClick = e => {\n        const isLabelClick = e.target === label || label.contains(e.target);\n\n        // don't want to click twice\n        if (isLabelClick) return;\n\n        // click link (will then in turn activate file input)\n        root.ref.label.click();\n    };\n\n    // attach events\n    label.addEventListener('keydown', root.ref.handleKeyDown);\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // update\n    updateLabelValue(label, props.caption);\n\n    // add!\n    root.appendChild(label);\n    root.ref.label = label;\n};\n\nconst updateLabelValue = (label, value) => {\n    label.innerHTML = value;\n    const clickable = label.querySelector('.filepond--label-action');\n    if (clickable) {\n        attr(clickable, 'tabindex', '0');\n    }\n    return value;\n};\n\nconst dropLabel = createView({\n    name: 'drop-label',\n    ignoreRect: true,\n    create: create$b,\n    destroy: ({ root }) => {\n        root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n        root.element.removeEventListener('click', root.ref.handleClick);\n    },\n    write: createRoute({\n        DID_SET_LABEL_IDLE: ({ root, action }) => {\n            updateLabelValue(root.ref.label, action.value);\n        },\n    }),\n    mixins: {\n        styles: ['opacity', 'translateX', 'translateY'],\n        animations: {\n            opacity: { type: 'tween', duration: 150 },\n            translateX: 'spring',\n            translateY: 'spring',\n        },\n    },\n});\n\nconst blob = createView({\n    name: 'drip-blob',\n    ignoreRect: true,\n    mixins: {\n        styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n        animations: {\n            scaleX: 'spring',\n            scaleY: 'spring',\n            translateX: 'spring',\n            translateY: 'spring',\n            opacity: { type: 'tween', duration: 250 },\n        },\n    },\n});\n\nconst addBlob = ({ root }) => {\n    const centerX = root.rect.element.width * 0.5;\n    const centerY = root.rect.element.height * 0.5;\n\n    root.ref.blob = root.appendChildView(\n        root.createChildView(blob, {\n            opacity: 0,\n            scaleX: 2.5,\n            scaleY: 2.5,\n            translateX: centerX,\n            translateY: centerY,\n        })\n    );\n};\n\nconst moveBlob = ({ root, action }) => {\n    if (!root.ref.blob) {\n        addBlob({ root });\n        return;\n    }\n\n    root.ref.blob.translateX = action.position.scopeLeft;\n    root.ref.blob.translateY = action.position.scopeTop;\n    root.ref.blob.scaleX = 1;\n    root.ref.blob.scaleY = 1;\n    root.ref.blob.opacity = 1;\n};\n\nconst hideBlob = ({ root }) => {\n    if (!root.ref.blob) {\n        return;\n    }\n    root.ref.blob.opacity = 0;\n};\n\nconst explodeBlob = ({ root }) => {\n    if (!root.ref.blob) {\n        return;\n    }\n    root.ref.blob.scaleX = 2.5;\n    root.ref.blob.scaleY = 2.5;\n    root.ref.blob.opacity = 0;\n};\n\nconst write$7 = ({ root, props, actions }) => {\n    route$4({ root, props, actions });\n\n    const { blob } = root.ref;\n\n    if (actions.length === 0 && blob && blob.opacity === 0) {\n        root.removeChildView(blob);\n        root.ref.blob = null;\n    }\n};\n\nconst route$4 = createRoute({\n    DID_DRAG: moveBlob,\n    DID_DROP: explodeBlob,\n    DID_END_DRAG: hideBlob,\n});\n\nconst drip = createView({\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'drip',\n    write: write$7,\n});\n\nconst setInputFiles = (element, files) => {\n    try {\n        // Create a DataTransfer instance and add a newly created file\n        const dataTransfer = new DataTransfer();\n        files.forEach(file => {\n            if (file instanceof File) {\n                dataTransfer.items.add(file);\n            } else {\n                dataTransfer.items.add(\n                    new File([file], file.name, {\n                        type: file.type,\n                    })\n                );\n            }\n        });\n\n        // Assign the DataTransfer files list to the file input\n        element.files = dataTransfer.files;\n    } catch (err) {\n        return false;\n    }\n    return true;\n};\n\nconst create$c = ({ root }) => {\n    root.ref.fields = {};\n    const legend = document.createElement('legend');\n    legend.textContent = 'Files';\n    root.element.appendChild(legend);\n};\n\nconst getField = (root, id) => root.ref.fields[id];\n\nconst syncFieldPositionsWithItems = root => {\n    root.query('GET_ACTIVE_ITEMS').forEach(item => {\n        if (!root.ref.fields[item.id]) return;\n        root.element.appendChild(root.ref.fields[item.id]);\n    });\n};\n\nconst didReorderItems = ({ root }) => syncFieldPositionsWithItems(root);\n\nconst didAddItem = ({ root, action }) => {\n    const fileItem = root.query('GET_ITEM', action.id);\n    const isLocalFile = fileItem.origin === FileOrigin.LOCAL;\n    const shouldUseFileInput = !isLocalFile && root.query('SHOULD_UPDATE_FILE_INPUT');\n    const dataContainer = createElement$1('input');\n    dataContainer.type = shouldUseFileInput ? 'file' : 'hidden';\n    dataContainer.name = root.query('GET_NAME');\n    root.ref.fields[action.id] = dataContainer;\n    syncFieldPositionsWithItems(root);\n};\n\nconst didLoadItem$1 = ({ root, action }) => {\n    const field = getField(root, action.id);\n    if (!field) return;\n\n    // store server ref in hidden input\n    if (action.serverFileReference !== null) field.value = action.serverFileReference;\n\n    // store file item in file input\n    if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\n\n    const fileItem = root.query('GET_ITEM', action.id);\n    setInputFiles(field, [fileItem.file]);\n};\n\nconst didPrepareOutput = ({ root, action }) => {\n    // this timeout pushes the handler after 'load'\n    if (!root.query('SHOULD_UPDATE_FILE_INPUT')) return;\n    setTimeout(() => {\n        const field = getField(root, action.id);\n        if (!field) return;\n        setInputFiles(field, [action.file]);\n    }, 0);\n};\n\nconst didSetDisabled = ({ root }) => {\n    root.element.disabled = root.query('GET_DISABLED');\n};\n\nconst didRemoveItem = ({ root, action }) => {\n    const field = getField(root, action.id);\n    if (!field) return;\n    if (field.parentNode) field.parentNode.removeChild(field);\n    delete root.ref.fields[action.id];\n};\n\n// only runs for server files. will refuse to update the value if the field\n// is a file field\nconst didDefineValue = ({ root, action }) => {\n    const field = getField(root, action.id);\n    if (!field) return;\n    if (action.value === null) {\n        // clear field value\n        field.removeAttribute('value');\n    } else {\n        // set field value\n        if (field.type != 'file') {\n            field.value = action.value;\n        }\n    }\n    syncFieldPositionsWithItems(root);\n};\n\nconst write$8 = createRoute({\n    DID_SET_DISABLED: didSetDisabled,\n    DID_ADD_ITEM: didAddItem,\n    DID_LOAD_ITEM: didLoadItem$1,\n    DID_REMOVE_ITEM: didRemoveItem,\n    DID_DEFINE_VALUE: didDefineValue,\n    DID_PREPARE_OUTPUT: didPrepareOutput,\n    DID_REORDER_ITEMS: didReorderItems,\n    DID_SORT_ITEMS: didReorderItems,\n});\n\nconst data = createView({\n    tag: 'fieldset',\n    name: 'data',\n    create: create$c,\n    write: write$8,\n    ignoreRect: true,\n});\n\nconst getRootNode = element => ('getRootNode' in element ? element.getRootNode() : document);\n\nconst images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\nconst text$1 = ['css', 'csv', 'html', 'txt'];\nconst map = {\n    zip: 'zip|compressed',\n    epub: 'application/epub+zip',\n};\n\nconst guesstimateMimeType = (extension = '') => {\n    extension = extension.toLowerCase();\n    if (images.includes(extension)) {\n        return (\n            'image/' + (extension === 'jpg' ? 'jpeg' : extension === 'svg' ? 'svg+xml' : extension)\n        );\n    }\n    if (text$1.includes(extension)) {\n        return 'text/' + extension;\n    }\n\n    return map[extension] || '';\n};\n\nconst requestDataTransferItems = dataTransfer =>\n    new Promise((resolve, reject) => {\n        // try to get links from transfer, if found we'll exit immediately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n        const links = getLinks(dataTransfer);\n        if (links.length && !hasFiles(dataTransfer)) {\n            return resolve(links);\n        }\n        // try to get files from the transfer\n        getFiles(dataTransfer).then(resolve);\n    });\n\n/**\n * Test if datatransfer has files\n */\nconst hasFiles = dataTransfer => {\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\n    return false;\n};\n\n/**\n * Extracts files from a DataTransfer object\n */\nconst getFiles = dataTransfer =>\n    new Promise((resolve, reject) => {\n        // get the transfer items as promises\n        const promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : [])\n\n            // only keep file system items (files and directories)\n            .filter(item => isFileSystemItem(item))\n\n            // map each item to promise\n            .map(item => getFilesFromItem(item));\n\n        // if is empty, see if we can extract some info from the files property as a fallback\n        if (!promisedFiles.length) {\n            // TODO: test for directories (should not be allowed)\n            // Use FileReader, problem is that the files property gets lost in the process\n            resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n            return;\n        }\n\n        // done!\n        Promise.all(promisedFiles)\n            .then(returnedFileGroups => {\n                // flatten groups\n                const files = [];\n                returnedFileGroups.forEach(group => {\n                    files.push.apply(files, group);\n                });\n\n                // done (filter out empty files)!\n                resolve(\n                    files\n                        .filter(file => file)\n                        .map(file => {\n                            if (!file._relativePath) file._relativePath = file.webkitRelativePath;\n                            return file;\n                        })\n                );\n            })\n            .catch(console.error);\n    });\n\nconst isFileSystemItem = item => {\n    if (isEntry(item)) {\n        const entry = getAsEntry(item);\n        if (entry) {\n            return entry.isFile || entry.isDirectory;\n        }\n    }\n    return item.kind === 'file';\n};\n\nconst getFilesFromItem = item =>\n    new Promise((resolve, reject) => {\n        if (isDirectoryEntry(item)) {\n            getFilesInDirectory(getAsEntry(item))\n                .then(resolve)\n                .catch(reject);\n            return;\n        }\n\n        resolve([item.getAsFile()]);\n    });\n\nconst getFilesInDirectory = entry =>\n    new Promise((resolve, reject) => {\n        const files = [];\n\n        // the total entries to read\n        let dirCounter = 0;\n        let fileCounter = 0;\n\n        const resolveIfDone = () => {\n            if (fileCounter === 0 && dirCounter === 0) {\n                resolve(files);\n            }\n        };\n\n        // the recursive function\n        const readEntries = dirEntry => {\n            dirCounter++;\n\n            const directoryReader = dirEntry.createReader();\n\n            // directories are returned in batches, we need to process all batches before we're done\n            const readBatch = () => {\n                directoryReader.readEntries(entries => {\n                    if (entries.length === 0) {\n                        dirCounter--;\n                        resolveIfDone();\n                        return;\n                    }\n\n                    entries.forEach(entry => {\n                        // recursively read more directories\n                        if (entry.isDirectory) {\n                            readEntries(entry);\n                        } else {\n                            // read as file\n                            fileCounter++;\n\n                            entry.file(file => {\n                                const correctedFile = correctMissingFileType(file);\n                                if (entry.fullPath) correctedFile._relativePath = entry.fullPath;\n                                files.push(correctedFile);\n                                fileCounter--;\n                                resolveIfDone();\n                            });\n                        }\n                    });\n\n                    // try to get next batch of files\n                    readBatch();\n                }, reject);\n            };\n\n            // read first batch of files\n            readBatch();\n        };\n\n        // go!\n        readEntries(entry);\n    });\n\nconst correctMissingFileType = file => {\n    if (file.type.length) return file;\n    const date = file.lastModifiedDate;\n    const name = file.name;\n    const type = guesstimateMimeType(getExtensionFromFilename(file.name));\n    if (!type.length) return file;\n    file = file.slice(0, file.size, type);\n    file.name = name;\n    file.lastModifiedDate = date;\n    return file;\n};\n\nconst isDirectoryEntry = item => isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n\nconst isEntry = item => 'webkitGetAsEntry' in item;\n\nconst getAsEntry = item => item.webkitGetAsEntry();\n\n/**\n * Extracts links from a DataTransfer object\n */\nconst getLinks = dataTransfer => {\n    let links = [];\n    try {\n        // look in meta data property\n        links = getLinksFromTransferMetaData(dataTransfer);\n        if (links.length) {\n            return links;\n        }\n        links = getLinksFromTransferURLData(dataTransfer);\n    } catch (e) {\n        // nope nope nope (probably IE trouble)\n    }\n    return links;\n};\n\nconst getLinksFromTransferURLData = dataTransfer => {\n    let data = dataTransfer.getData('url');\n    if (typeof data === 'string' && data.length) {\n        return [data];\n    }\n    return [];\n};\n\nconst getLinksFromTransferMetaData = dataTransfer => {\n    let data = dataTransfer.getData('text/html');\n    if (typeof data === 'string' && data.length) {\n        const matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n        if (matches) {\n            return [matches[1]];\n        }\n    }\n    return [];\n};\n\nconst dragNDropObservers = [];\n\nconst eventPosition = e => ({\n    pageLeft: e.pageX,\n    pageTop: e.pageY,\n    scopeLeft: e.offsetX || e.layerX,\n    scopeTop: e.offsetY || e.layerY,\n});\n\nconst createDragNDropClient = (element, scopeToObserve, filterElement) => {\n    const observer = getDragNDropObserver(scopeToObserve);\n\n    const client = {\n        element,\n        filterElement,\n        state: null,\n        ondrop: () => {},\n        onenter: () => {},\n        ondrag: () => {},\n        onexit: () => {},\n        onload: () => {},\n        allowdrop: () => {},\n    };\n\n    client.destroy = observer.addListener(client);\n\n    return client;\n};\n\nconst getDragNDropObserver = element => {\n    // see if already exists, if so, return\n    const observer = dragNDropObservers.find(item => item.element === element);\n    if (observer) {\n        return observer;\n    }\n\n    // create new observer, does not yet exist for this element\n    const newObserver = createDragNDropObserver(element);\n    dragNDropObservers.push(newObserver);\n    return newObserver;\n};\n\nconst createDragNDropObserver = element => {\n    const clients = [];\n\n    const routes = {\n        dragenter,\n        dragover,\n        dragleave,\n        drop,\n    };\n\n    const handlers = {};\n\n    forin(routes, (event, createHandler) => {\n        handlers[event] = createHandler(element, clients);\n        element.addEventListener(event, handlers[event], false);\n    });\n\n    const observer = {\n        element,\n        addListener: client => {\n            // add as client\n            clients.push(client);\n\n            // return removeListener function\n            return () => {\n                // remove client\n                clients.splice(clients.indexOf(client), 1);\n\n                // if no more clients, clean up observer\n                if (clients.length === 0) {\n                    dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n\n                    forin(routes, event => {\n                        element.removeEventListener(event, handlers[event], false);\n                    });\n                }\n            };\n        },\n    };\n\n    return observer;\n};\n\nconst elementFromPoint = (root, point) => {\n    if (!('elementFromPoint' in root)) {\n        root = document;\n    }\n    return root.elementFromPoint(point.x, point.y);\n};\n\nconst isEventTarget = (e, target) => {\n    // get root\n    const root = getRootNode(target);\n\n    // get element at position\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n    const elementAtPosition = elementFromPoint(root, {\n        x: e.pageX - window.pageXOffset,\n        y: e.pageY - window.pageYOffset,\n    });\n\n    // test if target is the element or if one of its children is\n    return elementAtPosition === target || target.contains(elementAtPosition);\n};\n\nlet initialTarget = null;\n\nconst setDropEffect = (dataTransfer, effect) => {\n    // is in try catch as IE11 will throw error if not\n    try {\n        dataTransfer.dropEffect = effect;\n    } catch (e) {}\n};\n\nconst dragenter = (root, clients) => e => {\n    e.preventDefault();\n\n    initialTarget = e.target;\n\n    clients.forEach(client => {\n        const { element, onenter } = client;\n\n        if (isEventTarget(e, element)) {\n            client.state = 'enter';\n\n            // fire enter event\n            onenter(eventPosition(e));\n        }\n    });\n};\n\nconst dragover = (root, clients) => e => {\n    e.preventDefault();\n\n    const dataTransfer = e.dataTransfer;\n\n    requestDataTransferItems(dataTransfer).then(items => {\n        let overDropTarget = false;\n\n        clients.some(client => {\n            const { filterElement, element, onenter, onexit, ondrag, allowdrop } = client;\n\n            // by default we can drop\n            setDropEffect(dataTransfer, 'copy');\n\n            // allow transfer of these items\n            const allowsTransfer = allowdrop(items);\n\n            // only used when can be dropped on page\n            if (!allowsTransfer) {\n                setDropEffect(dataTransfer, 'none');\n                return;\n            }\n\n            // targetting this client\n            if (isEventTarget(e, element)) {\n                overDropTarget = true;\n\n                // had no previous state, means we are entering this client\n                if (client.state === null) {\n                    client.state = 'enter';\n                    onenter(eventPosition(e));\n                    return;\n                }\n\n                // now over element (no matter if it allows the drop or not)\n                client.state = 'over';\n\n                // needs to allow transfer\n                if (filterElement && !allowsTransfer) {\n                    setDropEffect(dataTransfer, 'none');\n                    return;\n                }\n\n                // dragging\n                ondrag(eventPosition(e));\n            } else {\n                // should be over an element to drop\n                if (filterElement && !overDropTarget) {\n                    setDropEffect(dataTransfer, 'none');\n                }\n\n                // might have just left this client?\n                if (client.state) {\n                    client.state = null;\n                    onexit(eventPosition(e));\n                }\n            }\n        });\n    });\n};\n\nconst drop = (root, clients) => e => {\n    e.preventDefault();\n\n    const dataTransfer = e.dataTransfer;\n\n    requestDataTransferItems(dataTransfer).then(items => {\n        clients.forEach(client => {\n            const { filterElement, element, ondrop, onexit, allowdrop } = client;\n\n            client.state = null;\n\n            // if we're filtering on element we need to be over the element to drop\n            if (filterElement && !isEventTarget(e, element)) return;\n\n            // no transfer for this client\n            if (!allowdrop(items)) return onexit(eventPosition(e));\n\n            // we can drop these items on this client\n            ondrop(eventPosition(e), items);\n        });\n    });\n};\n\nconst dragleave = (root, clients) => e => {\n    if (initialTarget !== e.target) {\n        return;\n    }\n\n    clients.forEach(client => {\n        const { onexit } = client;\n\n        client.state = null;\n\n        onexit(eventPosition(e));\n    });\n};\n\nconst createHopper = (scope, validateItems, options) => {\n    // is now hopper scope\n    scope.classList.add('filepond--hopper');\n\n    // shortcuts\n    const { catchesDropsOnPage, requiresDropOnElement, filterItems = items => items } = options;\n\n    // create a dnd client\n    const client = createDragNDropClient(\n        scope,\n        catchesDropsOnPage ? document.documentElement : scope,\n        requiresDropOnElement\n    );\n\n    // current client state\n    let lastState = '';\n    let currentState = '';\n\n    // determines if a file may be dropped\n    client.allowdrop = items => {\n        // TODO: if we can, throw error to indicate the items cannot by dropped\n\n        return validateItems(filterItems(items));\n    };\n\n    client.ondrop = (position, items) => {\n        const filteredItems = filterItems(items);\n\n        if (!validateItems(filteredItems)) {\n            api.ondragend(position);\n            return;\n        }\n\n        currentState = 'drag-drop';\n\n        api.onload(filteredItems, position);\n    };\n\n    client.ondrag = position => {\n        api.ondrag(position);\n    };\n\n    client.onenter = position => {\n        currentState = 'drag-over';\n\n        api.ondragstart(position);\n    };\n\n    client.onexit = position => {\n        currentState = 'drag-exit';\n\n        api.ondragend(position);\n    };\n\n    const api = {\n        updateHopperState: () => {\n            if (lastState !== currentState) {\n                scope.dataset.hopperState = currentState;\n                lastState = currentState;\n            }\n        },\n        onload: () => {},\n        ondragstart: () => {},\n        ondrag: () => {},\n        ondragend: () => {},\n        destroy: () => {\n            // destroy client\n            client.destroy();\n        },\n    };\n\n    return api;\n};\n\nlet listening = false;\nconst listeners$1 = [];\n\nconst handlePaste = e => {\n    // if is pasting in input or textarea and the target is outside of a filepond scope, ignore\n    const activeEl = document.activeElement;\n    const isActiveElementEditable =\n        activeEl &&\n        (/textarea|input/i.test(activeEl.nodeName) ||\n            activeEl.getAttribute('contenteditable') === 'true');\n\n    if (isActiveElementEditable) {\n        // test textarea or input is contained in filepond root\n        let inScope = false;\n        let element = activeEl;\n        while (element !== document.body) {\n            if (element.classList.contains('filepond--root')) {\n                inScope = true;\n                break;\n            }\n            element = element.parentNode;\n        }\n\n        if (!inScope) return;\n    }\n\n    requestDataTransferItems(e.clipboardData).then(files => {\n        // no files received\n        if (!files.length) {\n            return;\n        }\n\n        // notify listeners of received files\n        listeners$1.forEach(listener => listener(files));\n    });\n};\n\nconst listen = cb => {\n    // can't add twice\n    if (listeners$1.includes(cb)) {\n        return;\n    }\n\n    // add initial listener\n    listeners$1.push(cb);\n\n    // setup paste listener for entire page\n    if (listening) {\n        return;\n    }\n\n    listening = true;\n    document.addEventListener('paste', handlePaste);\n};\n\nconst unlisten = listener => {\n    arrayRemove(listeners$1, listeners$1.indexOf(listener));\n\n    // clean up\n    if (listeners$1.length === 0) {\n        document.removeEventListener('paste', handlePaste);\n        listening = false;\n    }\n};\n\nconst createPaster = () => {\n    const cb = files => {\n        api.onload(files);\n    };\n\n    const api = {\n        destroy: () => {\n            unlisten(cb);\n        },\n        onload: () => {},\n    };\n\n    listen(cb);\n\n    return api;\n};\n\n/**\n * Creates the file view\n */\nconst create$d = ({ root, props }) => {\n    root.element.id = `filepond--assistant-${props.id}`;\n    attr(root.element, 'role', 'alert');\n    attr(root.element, 'aria-live', 'polite');\n    attr(root.element, 'aria-relevant', 'additions');\n};\n\nlet addFilesNotificationTimeout = null;\nlet notificationClearTimeout = null;\n\nconst filenames = [];\n\nconst assist = (root, message) => {\n    root.element.textContent = message;\n};\n\nconst clear$1 = root => {\n    root.element.textContent = '';\n};\n\nconst listModified = (root, filename, label) => {\n    const total = root.query('GET_TOTAL_ITEMS');\n    assist(\n        root,\n        `${label} ${filename}, ${total} ${\n            total === 1\n                ? root.query('GET_LABEL_FILE_COUNT_SINGULAR')\n                : root.query('GET_LABEL_FILE_COUNT_PLURAL')\n        }`\n    );\n\n    // clear group after set amount of time so the status is not read twice\n    clearTimeout(notificationClearTimeout);\n    notificationClearTimeout = setTimeout(() => {\n        clear$1(root);\n    }, 1500);\n};\n\nconst isUsingFilePond = root => root.element.parentNode.contains(document.activeElement);\n\nconst itemAdded = ({ root, action }) => {\n    if (!isUsingFilePond(root)) {\n        return;\n    }\n\n    root.element.textContent = '';\n    const item = root.query('GET_ITEM', action.id);\n    filenames.push(item.filename);\n\n    clearTimeout(addFilesNotificationTimeout);\n    addFilesNotificationTimeout = setTimeout(() => {\n        listModified(root, filenames.join(', '), root.query('GET_LABEL_FILE_ADDED'));\n        filenames.length = 0;\n    }, 750);\n};\n\nconst itemRemoved = ({ root, action }) => {\n    if (!isUsingFilePond(root)) {\n        return;\n    }\n\n    const item = action.item;\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n};\n\nconst itemProcessed = ({ root, action }) => {\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    const item = root.query('GET_ITEM', action.id);\n    const filename = item.filename;\n    const label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n\n    assist(root, `${filename} ${label}`);\n};\n\nconst itemProcessedUndo = ({ root, action }) => {\n    const item = root.query('GET_ITEM', action.id);\n    const filename = item.filename;\n    const label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n\n    assist(root, `${filename} ${label}`);\n};\n\nconst itemError = ({ root, action }) => {\n    const item = root.query('GET_ITEM', action.id);\n    const filename = item.filename;\n\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    assist(root, `${action.status.main} ${filename} ${action.status.sub}`);\n};\n\nconst assistant = createView({\n    create: create$d,\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n        DID_LOAD_ITEM: itemAdded,\n        DID_REMOVE_ITEM: itemRemoved,\n        DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n\n        DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n        DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n\n        DID_THROW_ITEM_REMOVE_ERROR: itemError,\n        DID_THROW_ITEM_LOAD_ERROR: itemError,\n        DID_THROW_ITEM_INVALID: itemError,\n        DID_THROW_ITEM_PROCESSING_ERROR: itemError,\n    }),\n    tag: 'span',\n    name: 'assistant',\n});\n\nconst toCamels = (string, separator = '-') =>\n    string.replace(new RegExp(`${separator}.`, 'g'), sub => sub.charAt(1).toUpperCase());\n\nconst debounce = (func, interval = 16, immidiateOnly = true) => {\n    let last = Date.now();\n    let timeout = null;\n\n    return (...args) => {\n        clearTimeout(timeout);\n\n        const dist = Date.now() - last;\n\n        const fn = () => {\n            last = Date.now();\n            func(...args);\n        };\n\n        if (dist < interval) {\n            // we need to delay by the difference between interval and dist\n            // for example: if distance is 10 ms and interval is 16 ms,\n            // we need to wait an additional 6ms before calling the function)\n            if (!immidiateOnly) {\n                timeout = setTimeout(fn, interval - dist);\n            }\n        } else {\n            // go!\n            fn();\n        }\n    };\n};\n\nconst MAX_FILES_LIMIT = 1000000;\n\nconst prevent = e => e.preventDefault();\n\nconst create$e = ({ root, props }) => {\n    // Add id\n    const id = root.query('GET_ID');\n    if (id) {\n        root.element.id = id;\n    }\n\n    // Add className\n    const className = root.query('GET_CLASS_NAME');\n    if (className) {\n        className\n            .split(' ')\n            .filter(name => name.length)\n            .forEach(name => {\n                root.element.classList.add(name);\n            });\n    }\n\n    // Field label\n    root.ref.label = root.appendChildView(\n        root.createChildView(dropLabel, {\n            ...props,\n            translateY: null,\n            caption: root.query('GET_LABEL_IDLE'),\n        })\n    );\n\n    // List of items\n    root.ref.list = root.appendChildView(root.createChildView(listScroller, { translateY: null }));\n\n    // Background panel\n    root.ref.panel = root.appendChildView(root.createChildView(panel, { name: 'panel-root' }));\n\n    // Assistant notifies assistive tech when content changes\n    root.ref.assistant = root.appendChildView(root.createChildView(assistant, { ...props }));\n\n    // Data\n    root.ref.data = root.appendChildView(root.createChildView(data, { ...props }));\n\n    // Measure (tests if fixed height was set)\n    // DOCTYPE needs to be set for this to work\n    root.ref.measure = createElement$1('div');\n    root.ref.measure.style.height = '100%';\n    root.element.appendChild(root.ref.measure);\n\n    // information on the root height or fixed height status\n    root.ref.bounds = null;\n\n    // apply initial style properties\n    root.query('GET_STYLES')\n        .filter(style => !isEmpty(style.value))\n        .map(({ name, value }) => {\n            root.element.dataset[name] = value;\n        });\n\n    // determine if width changed\n    root.ref.widthPrevious = null;\n    root.ref.widthUpdated = debounce(() => {\n        root.ref.updateHistory = [];\n        root.dispatch('DID_RESIZE_ROOT');\n    }, 250);\n\n    // history of updates\n    root.ref.previousAspectRatio = null;\n    root.ref.updateHistory = [];\n\n    // prevent scrolling and zooming on iOS (only if supports pointer events, for then we can enable reorder)\n    const canHover = window.matchMedia('(pointer: fine) and (hover: hover)').matches;\n    const hasPointerEvents = 'PointerEvent' in window;\n    if (root.query('GET_ALLOW_REORDER') && hasPointerEvents && !canHover) {\n        root.element.addEventListener('touchmove', prevent, { passive: false });\n        root.element.addEventListener('gesturestart', prevent);\n    }\n\n    // add credits\n    const credits = root.query('GET_CREDITS');\n    const hasCredits = credits.length === 2;\n    if (hasCredits) {\n        const frag = document.createElement('a');\n        frag.className = 'filepond--credits';\n        frag.href = credits[0];\n        frag.tabIndex = -1;\n        frag.target = '_blank';\n        frag.rel = 'noopener noreferrer nofollow';\n        frag.textContent = credits[1];\n        root.element.appendChild(frag);\n        root.ref.credits = frag;\n    }\n};\n\nconst write$9 = ({ root, props, actions }) => {\n    // route actions\n    route$5({ root, props, actions });\n\n    // apply style properties\n    actions\n        .filter(action => /^DID_SET_STYLE_/.test(action.type))\n        .filter(action => !isEmpty(action.data.value))\n        .map(({ type, data }) => {\n            const name = toCamels(type.substring(8).toLowerCase(), '_');\n            root.element.dataset[name] = data.value;\n            root.invalidateLayout();\n        });\n\n    if (root.rect.element.hidden) return;\n\n    if (root.rect.element.width !== root.ref.widthPrevious) {\n        root.ref.widthPrevious = root.rect.element.width;\n        root.ref.widthUpdated();\n    }\n\n    // get box bounds, we do this only once\n    let bounds = root.ref.bounds;\n    if (!bounds) {\n        bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root);\n\n        // destroy measure element\n        root.element.removeChild(root.ref.measure);\n        root.ref.measure = null;\n    }\n\n    // get quick references to various high level parts of the upload tool\n    const { hopper, label, list, panel } = root.ref;\n\n    // sets correct state to hopper scope\n    if (hopper) {\n        hopper.updateHopperState();\n    }\n\n    // bool to indicate if we're full or not\n    const aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n    const isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n    const totalItems = root.query('GET_TOTAL_ITEMS');\n    const maxItems = isMultiItem ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT : 1;\n    const atMaxCapacity = totalItems === maxItems;\n\n    // action used to add item\n    const addAction = actions.find(action => action.type === 'DID_ADD_ITEM');\n\n    // if reached max capacity and we've just reached it\n    if (atMaxCapacity && addAction) {\n        // get interaction type\n        const interactionMethod = addAction.data.interactionMethod;\n\n        // hide label\n        label.opacity = 0;\n\n        if (isMultiItem) {\n            label.translateY = -40;\n        } else {\n            if (interactionMethod === InteractionMethod.API) {\n                label.translateX = 40;\n            } else if (interactionMethod === InteractionMethod.BROWSE) {\n                label.translateY = 40;\n            } else {\n                label.translateY = 30;\n            }\n        }\n    } else if (!atMaxCapacity) {\n        label.opacity = 1;\n        label.translateX = 0;\n        label.translateY = 0;\n    }\n\n    const listItemMargin = calculateListItemMargin(root);\n\n    const listHeight = calculateListHeight(root);\n\n    const labelHeight = label.rect.element.height;\n    const currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n\n    const listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n    const listMarginBottom = totalItems === 0 ? 0 : list.rect.element.marginBottom;\n\n    const visualHeight = currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n    const boundsHeight = currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;\n\n    // link list to label bottom position\n    list.translateY =\n        Math.max(0, currentLabelHeight - list.rect.element.marginTop) - listItemMargin.top;\n\n    if (aspectRatio) {\n        // fixed aspect ratio\n\n        // calculate height based on width\n        const width = root.rect.element.width;\n        const height = width * aspectRatio;\n\n        // clear history if aspect ratio has changed\n        if (aspectRatio !== root.ref.previousAspectRatio) {\n            root.ref.previousAspectRatio = aspectRatio;\n            root.ref.updateHistory = [];\n        }\n\n        // remember this width\n        const history = root.ref.updateHistory;\n        history.push(width);\n\n        const MAX_BOUNCES = 2;\n        if (history.length > MAX_BOUNCES * 2) {\n            const l = history.length;\n            const bottom = l - 10;\n            let bounces = 0;\n            for (let i = l; i >= bottom; i--) {\n                if (history[i] === history[i - 2]) {\n                    bounces++;\n                }\n\n                if (bounces >= MAX_BOUNCES) {\n                    // dont adjust height\n                    return;\n                }\n            }\n        }\n\n        // fix height of panel so it adheres to aspect ratio\n        panel.scalable = false;\n        panel.height = height;\n\n        // available height for list\n        const listAvailableHeight =\n            // the height of the panel minus the label height\n            height -\n            currentLabelHeight -\n            // the room we leave open between the end of the list and the panel bottom\n            (listMarginBottom - listItemMargin.bottom) -\n            // if we're full we need to leave some room between the top of the panel and the list\n            (atMaxCapacity ? listMarginTop : 0);\n\n        if (listHeight.visual > listAvailableHeight) {\n            list.overflow = listAvailableHeight;\n        } else {\n            list.overflow = null;\n        }\n\n        // set container bounds (so pushes siblings downwards)\n        root.height = height;\n    } else if (bounds.fixedHeight) {\n        // fixed height\n\n        // fix height of panel\n        panel.scalable = false;\n\n        // available height for list\n        const listAvailableHeight =\n            // the height of the panel minus the label height\n            bounds.fixedHeight -\n            currentLabelHeight -\n            // the room we leave open between the end of the list and the panel bottom\n            (listMarginBottom - listItemMargin.bottom) -\n            // if we're full we need to leave some room between the top of the panel and the list\n            (atMaxCapacity ? listMarginTop : 0);\n\n        // set list height\n        if (listHeight.visual > listAvailableHeight) {\n            list.overflow = listAvailableHeight;\n        } else {\n            list.overflow = null;\n        }\n\n        // no need to set container bounds as these are handles by CSS fixed height\n    } else if (bounds.cappedHeight) {\n        // max-height\n\n        // not a fixed height panel\n        const isCappedHeight = visualHeight >= bounds.cappedHeight;\n        const panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n        panel.scalable = true;\n        panel.height = isCappedHeight\n            ? panelHeight\n            : panelHeight - listItemMargin.top - listItemMargin.bottom;\n\n        // available height for list\n        const listAvailableHeight =\n            // the height of the panel minus the label height\n            panelHeight -\n            currentLabelHeight -\n            // the room we leave open between the end of the list and the panel bottom\n            (listMarginBottom - listItemMargin.bottom) -\n            // if we're full we need to leave some room between the top of the panel and the list\n            (atMaxCapacity ? listMarginTop : 0);\n\n        // set list height (if is overflowing)\n        if (visualHeight > bounds.cappedHeight && listHeight.visual > listAvailableHeight) {\n            list.overflow = listAvailableHeight;\n        } else {\n            list.overflow = null;\n        }\n\n        // set container bounds (so pushes siblings downwards)\n        root.height = Math.min(\n            bounds.cappedHeight,\n            boundsHeight - listItemMargin.top - listItemMargin.bottom\n        );\n    } else {\n        // flexible height\n\n        // not a fixed height panel\n        const itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n        panel.scalable = true;\n        panel.height = Math.max(labelHeight, visualHeight - itemMargin);\n\n        // set container bounds (so pushes siblings downwards)\n        root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n    }\n\n    // move credits to bottom\n    if (root.ref.credits && panel.heightCurrent)\n        root.ref.credits.style.transform = `translateY(${panel.heightCurrent}px)`;\n};\n\nconst calculateListItemMargin = root => {\n    const item = root.ref.list.childViews[0].childViews[0];\n    return item\n        ? {\n              top: item.rect.element.marginTop,\n              bottom: item.rect.element.marginBottom,\n          }\n        : {\n              top: 0,\n              bottom: 0,\n          };\n};\n\nconst calculateListHeight = root => {\n    let visual = 0;\n    let bounds = 0;\n\n    // get file list reference\n    const scrollList = root.ref.list;\n    const itemList = scrollList.childViews[0];\n    const visibleChildren = itemList.childViews.filter(child => child.rect.element.height);\n    const children = root\n        .query('GET_ACTIVE_ITEMS')\n        .map(item => visibleChildren.find(child => child.id === item.id))\n        .filter(item => item);\n\n    // no children, done!\n    if (children.length === 0) return { visual, bounds };\n\n    const horizontalSpace = itemList.rect.element.width;\n    const dragIndex = getItemIndexByPosition(itemList, children, scrollList.dragCoordinates);\n\n    const childRect = children[0].rect.element;\n\n    const itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    const itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n\n    const itemWidth = childRect.width + itemHorizontalMargin;\n    const itemHeight = childRect.height + itemVerticalMargin;\n\n    const newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n    const removedItem = children.find(child => child.markedForRemoval && child.opacity < 0.45)\n        ? -1\n        : 0;\n    const verticalItemCount = children.length + newItem + removedItem;\n    const itemsPerRow = getItemsPerRow(horizontalSpace, itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n        children.forEach(item => {\n            const height = item.rect.element.height + itemVerticalMargin;\n            bounds += height;\n            visual += height * item.opacity;\n        });\n    }\n    // grid\n    else {\n        bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n        visual = bounds;\n    }\n\n    return { visual, bounds };\n};\n\nconst calculateRootBoundingBoxHeight = root => {\n    const height = root.ref.measureHeight || null;\n    const cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n    const fixedHeight = height === 0 ? null : height;\n\n    return {\n        cappedHeight,\n        fixedHeight,\n    };\n};\n\nconst exceedsMaxFiles = (root, items) => {\n    const allowReplace = root.query('GET_ALLOW_REPLACE');\n    const allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n    const totalItems = root.query('GET_TOTAL_ITEMS');\n    let maxItems = root.query('GET_MAX_FILES');\n\n    // total amount of items being dragged\n    const totalBrowseItems = items.length;\n\n    // if does not allow multiple items and dragging more than one item\n    if (!allowMultiple && totalBrowseItems > 1) {\n        root.dispatch('DID_THROW_MAX_FILES', {\n            source: items,\n            error: createResponse('warning', 0, 'Max files'),\n        });\n        return true;\n    }\n\n    // limit max items to one if not allowed to drop multiple items\n    maxItems = allowMultiple ? maxItems : 1;\n\n    if (!allowMultiple && allowReplace) {\n        // There is only one item, so there is room to replace or add an item\n        return false;\n    }\n\n    // no more room?\n    const hasMaxItems = isInt(maxItems);\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n        root.dispatch('DID_THROW_MAX_FILES', {\n            source: items,\n            error: createResponse('warning', 0, 'Max files'),\n        });\n        return true;\n    }\n\n    return false;\n};\n\nconst getDragIndex = (list, children, position) => {\n    const itemList = list.childViews[0];\n    return getItemIndexByPosition(itemList, children, {\n        left: position.scopeLeft - itemList.rect.element.left,\n        top:\n            position.scopeTop -\n            (list.rect.outer.top + list.rect.element.marginTop + list.rect.element.scrollTop),\n    });\n};\n\n/**\n * Enable or disable file drop functionality\n */\nconst toggleDrop = root => {\n    const isAllowed = root.query('GET_ALLOW_DROP');\n    const isDisabled = root.query('GET_DISABLED');\n    const enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.hopper) {\n        const hopper = createHopper(\n            root.element,\n            items => {\n                // allow quick validation of dropped items\n                const beforeDropFile = root.query('GET_BEFORE_DROP_FILE') || (() => true);\n\n                // all items should be validated by all filters as valid\n                const dropValidation = root.query('GET_DROP_VALIDATION');\n                return dropValidation\n                    ? items.every(\n                          item =>\n                              applyFilters('ALLOW_HOPPER_ITEM', item, {\n                                  query: root.query,\n                              }).every(result => result === true) && beforeDropFile(item)\n                      )\n                    : true;\n            },\n            {\n                filterItems: items => {\n                    const ignoredFiles = root.query('GET_IGNORED_FILES');\n                    return items.filter(item => {\n                        if (isFile(item)) {\n                            return !ignoredFiles.includes(item.name.toLowerCase());\n                        }\n                        return true;\n                    });\n                },\n                catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n                requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT'),\n            }\n        );\n\n        hopper.onload = (items, position) => {\n            // get item children elements and sort based on list sort\n            const list = root.ref.list.childViews[0];\n            const visibleChildren = list.childViews.filter(child => child.rect.element.height);\n            const children = root\n                .query('GET_ACTIVE_ITEMS')\n                .map(item => visibleChildren.find(child => child.id === item.id))\n                .filter(item => item);\n\n            applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(queue => {\n                // these files don't fit so stop here\n                if (exceedsMaxFiles(root, queue)) return false;\n\n                // go\n                root.dispatch('ADD_ITEMS', {\n                    items: queue,\n                    index: getDragIndex(root.ref.list, children, position),\n                    interactionMethod: InteractionMethod.DROP,\n                });\n            });\n\n            root.dispatch('DID_DROP', { position });\n\n            root.dispatch('DID_END_DRAG', { position });\n        };\n\n        hopper.ondragstart = position => {\n            root.dispatch('DID_START_DRAG', { position });\n        };\n\n        hopper.ondrag = debounce(position => {\n            root.dispatch('DID_DRAG', { position });\n        });\n\n        hopper.ondragend = position => {\n            root.dispatch('DID_END_DRAG', { position });\n        };\n\n        root.ref.hopper = hopper;\n\n        root.ref.drip = root.appendChildView(root.createChildView(drip));\n    } else if (!enabled && root.ref.hopper) {\n        root.ref.hopper.destroy();\n        root.ref.hopper = null;\n        root.removeChildView(root.ref.drip);\n    }\n};\n\n/**\n * Enable or disable browse functionality\n */\nconst toggleBrowse = (root, props) => {\n    const isAllowed = root.query('GET_ALLOW_BROWSE');\n    const isDisabled = root.query('GET_DISABLED');\n    const enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.browser) {\n        root.ref.browser = root.appendChildView(\n            root.createChildView(browser, {\n                ...props,\n                onload: items => {\n                    applyFilterChain('ADD_ITEMS', items, {\n                        dispatch: root.dispatch,\n                    }).then(queue => {\n                        // these files don't fit so stop here\n                        if (exceedsMaxFiles(root, queue)) return false;\n\n                        // add items!\n                        root.dispatch('ADD_ITEMS', {\n                            items: queue,\n                            index: -1,\n                            interactionMethod: InteractionMethod.BROWSE,\n                        });\n                    });\n                },\n            }),\n            0\n        );\n    } else if (!enabled && root.ref.browser) {\n        root.removeChildView(root.ref.browser);\n        root.ref.browser = null;\n    }\n};\n\n/**\n * Enable or disable paste functionality\n */\nconst togglePaste = root => {\n    const isAllowed = root.query('GET_ALLOW_PASTE');\n    const isDisabled = root.query('GET_DISABLED');\n    const enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.paster) {\n        root.ref.paster = createPaster();\n        root.ref.paster.onload = items => {\n            applyFilterChain('ADD_ITEMS', items, { dispatch: root.dispatch }).then(queue => {\n                // these files don't fit so stop here\n                if (exceedsMaxFiles(root, queue)) return false;\n\n                // add items!\n                root.dispatch('ADD_ITEMS', {\n                    items: queue,\n                    index: -1,\n                    interactionMethod: InteractionMethod.PASTE,\n                });\n            });\n        };\n    } else if (!enabled && root.ref.paster) {\n        root.ref.paster.destroy();\n        root.ref.paster = null;\n    }\n};\n\n/**\n * Route actions\n */\nconst route$5 = createRoute({\n    DID_SET_ALLOW_BROWSE: ({ root, props }) => {\n        toggleBrowse(root, props);\n    },\n    DID_SET_ALLOW_DROP: ({ root }) => {\n        toggleDrop(root);\n    },\n    DID_SET_ALLOW_PASTE: ({ root }) => {\n        togglePaste(root);\n    },\n    DID_SET_DISABLED: ({ root, props }) => {\n        toggleDrop(root);\n        togglePaste(root);\n        toggleBrowse(root, props);\n        const isDisabled = root.query('GET_DISABLED');\n        if (isDisabled) {\n            root.element.dataset.disabled = 'disabled';\n        } else {\n            // delete root.element.dataset.disabled; <= this does not work on iOS 10\n            root.element.removeAttribute('data-disabled');\n        }\n    },\n});\n\nconst root = createView({\n    name: 'root',\n    read: ({ root }) => {\n        if (root.ref.measure) {\n            root.ref.measureHeight = root.ref.measure.offsetHeight;\n        }\n    },\n    create: create$e,\n    write: write$9,\n    destroy: ({ root }) => {\n        if (root.ref.paster) {\n            root.ref.paster.destroy();\n        }\n        if (root.ref.hopper) {\n            root.ref.hopper.destroy();\n        }\n        root.element.removeEventListener('touchmove', prevent);\n        root.element.removeEventListener('gesturestart', prevent);\n    },\n    mixins: {\n        styles: ['height'],\n    },\n});\n\n// creates the app\nconst createApp = (initialOptions = {}) => {\n    // let element\n    let originalElement = null;\n\n    // get default options\n    const defaultOptions = getOptions();\n\n    // create the data store, this will contain all our app info\n    const store = createStore(\n        // initial state (should be serializable)\n        createInitialState(defaultOptions),\n\n        // queries\n        [queries, createOptionQueries(defaultOptions)],\n\n        // action handlers\n        [actions, createOptionActions(defaultOptions)]\n    );\n\n    // set initial options\n    store.dispatch('SET_OPTIONS', { options: initialOptions });\n\n    // kick thread if visibility changes\n    const visibilityHandler = () => {\n        if (document.hidden) return;\n        store.dispatch('KICK');\n    };\n    document.addEventListener('visibilitychange', visibilityHandler);\n\n    // re-render on window resize start and finish\n    let resizeDoneTimer = null;\n    let isResizing = false;\n    let isResizingHorizontally = false;\n    let initialWindowWidth = null;\n    let currentWindowWidth = null;\n    const resizeHandler = () => {\n        if (!isResizing) {\n            isResizing = true;\n        }\n        clearTimeout(resizeDoneTimer);\n        resizeDoneTimer = setTimeout(() => {\n            isResizing = false;\n            initialWindowWidth = null;\n            currentWindowWidth = null;\n            if (isResizingHorizontally) {\n                isResizingHorizontally = false;\n                store.dispatch('DID_STOP_RESIZE');\n            }\n        }, 500);\n    };\n    window.addEventListener('resize', resizeHandler);\n\n    // render initial view\n    const view = root(store, { id: getUniqueId() });\n\n    //\n    // PRIVATE API -------------------------------------------------------------------------------------\n    //\n    let isResting = false;\n    let isHidden = false;\n\n    const readWriteApi = {\n        // necessary for update loop\n\n        /**\n         * Reads from dom (never call manually)\n         * @private\n         */\n        _read: () => {\n            // test if we're resizing horizontally\n            // TODO: see if we can optimize this by measuring root rect\n            if (isResizing) {\n                currentWindowWidth = window.innerWidth;\n                if (!initialWindowWidth) {\n                    initialWindowWidth = currentWindowWidth;\n                }\n\n                if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {\n                    store.dispatch('DID_START_RESIZE');\n                    isResizingHorizontally = true;\n                }\n            }\n\n            if (isHidden && isResting) {\n                // test if is no longer hidden\n                isResting = view.element.offsetParent === null;\n            }\n\n            // if resting, no need to read as numbers will still all be correct\n            if (isResting) return;\n\n            // read view data\n            view._read();\n\n            // if is hidden we need to know so we exit rest mode when revealed\n            isHidden = view.rect.element.hidden;\n        },\n\n        /**\n         * Writes to dom (never call manually)\n         * @private\n         */\n        _write: ts => {\n            // get all actions from store\n            const actions = store\n                .processActionQueue()\n\n                // filter out set actions (these will automatically trigger DID_SET)\n                .filter(action => !/^SET_/.test(action.type));\n\n            // if was idling and no actions stop here\n            if (isResting && !actions.length) return;\n\n            // some actions might trigger events\n            routeActionsToEvents(actions);\n\n            // update the view\n            isResting = view._write(ts, actions, isResizingHorizontally);\n\n            // will clean up all archived items\n            removeReleasedItems(store.query('GET_ITEMS'));\n\n            // now idling\n            if (isResting) {\n                store.processDispatchQueue();\n            }\n        },\n    };\n\n    //\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\n    //\n    const createEvent = name => data => {\n        // create default event\n        const event = {\n            type: name,\n        };\n\n        // no data to add\n        if (!data) {\n            return event;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('error')) {\n            event.error = data.error ? { ...data.error } : null;\n        }\n\n        if (data.status) {\n            event.status = { ...data.status };\n        }\n\n        if (data.file) {\n            event.output = data.file;\n        }\n\n        // only source is available, else add item if possible\n        if (data.source) {\n            event.file = data.source;\n        } else if (data.item || data.id) {\n            const item = data.item ? data.item : store.query('GET_ITEM', data.id);\n            event.file = item ? createItemAPI(item) : null;\n        }\n\n        // map all items in a possible items array\n        if (data.items) {\n            event.items = data.items.map(createItemAPI);\n        }\n\n        // if this is a progress event add the progress amount\n        if (/progress/.test(name)) {\n            event.progress = data.progress;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('origin') && data.hasOwnProperty('target')) {\n            event.origin = data.origin;\n            event.target = data.target;\n        }\n\n        return event;\n    };\n\n    const eventRoutes = {\n        DID_DESTROY: createEvent('destroy'),\n\n        DID_INIT: createEvent('init'),\n\n        DID_THROW_MAX_FILES: createEvent('warning'),\n\n        DID_INIT_ITEM: createEvent('initfile'),\n        DID_START_ITEM_LOAD: createEvent('addfilestart'),\n        DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n        DID_LOAD_ITEM: createEvent('addfile'),\n\n        DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n\n        DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n\n        DID_THROW_ITEM_REMOVE_ERROR: [createEvent('error'), createEvent('removefile')],\n\n        DID_PREPARE_OUTPUT: createEvent('preparefile'),\n\n        DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n        DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n        DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n        DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n        DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n        DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n\n        DID_THROW_ITEM_PROCESSING_ERROR: [createEvent('error'), createEvent('processfile')],\n\n        DID_REMOVE_ITEM: createEvent('removefile'),\n\n        DID_UPDATE_ITEMS: createEvent('updatefiles'),\n\n        DID_ACTIVATE_ITEM: createEvent('activatefile'),\n\n        DID_REORDER_ITEMS: createEvent('reorderfiles'),\n    };\n\n    const exposeEvent = event => {\n        // create event object to be dispatched\n        const detail = { pond: exports, ...event };\n        delete detail.type;\n        view.element.dispatchEvent(\n            new CustomEvent(`FilePond:${event.type}`, {\n                // event info\n                detail,\n\n                // event behaviour\n                bubbles: true,\n                cancelable: true,\n                composed: true, // triggers listeners outside of shadow root\n            })\n        );\n\n        // event object to params used for `on()` event handlers and callbacks `oninit()`\n        const params = [];\n\n        // if is possible error event, make it the first param\n        if (event.hasOwnProperty('error')) {\n            params.push(event.error);\n        }\n\n        // file is always section\n        if (event.hasOwnProperty('file')) {\n            params.push(event.file);\n        }\n\n        // append other props\n        const filtered = ['type', 'error', 'file'];\n        Object.keys(event)\n            .filter(key => !filtered.includes(key))\n            .forEach(key => params.push(event[key]));\n\n        // on(type, () => { })\n        exports.fire(event.type, ...params);\n\n        // oninit = () => {}\n        const handler = store.query(`GET_ON${event.type.toUpperCase()}`);\n        if (handler) {\n            handler(...params);\n        }\n    };\n\n    const routeActionsToEvents = actions => {\n        if (!actions.length) return;\n        actions\n            .filter(action => eventRoutes[action.type])\n            .forEach(action => {\n                const routes = eventRoutes[action.type];\n                (Array.isArray(routes) ? routes : [routes]).forEach(route => {\n                    // this isn't fantastic, but because of the stacking of settimeouts plugins can handle the did_load before the did_init\n                    if (action.type === 'DID_INIT_ITEM') {\n                        exposeEvent(route(action.data));\n                    } else {\n                        setTimeout(() => {\n                            exposeEvent(route(action.data));\n                        }, 0);\n                    }\n                });\n            });\n    };\n\n    //\n    // PUBLIC API -------------------------------------------------------------------------------------\n    //\n    const setOptions = options => store.dispatch('SET_OPTIONS', { options });\n\n    const getFile = query => store.query('GET_ACTIVE_ITEM', query);\n\n    const prepareFile = query =>\n        new Promise((resolve, reject) => {\n            store.dispatch('REQUEST_ITEM_PREPARE', {\n                query,\n                success: item => {\n                    resolve(item);\n                },\n                failure: error => {\n                    reject(error);\n                },\n            });\n        });\n\n    const addFile = (source, options = {}) =>\n        new Promise((resolve, reject) => {\n            addFiles([{ source, options }], { index: options.index })\n                .then(items => resolve(items && items[0]))\n                .catch(reject);\n        });\n\n    const isFilePondFile = obj => obj.file && obj.id;\n\n    const removeFile = (query, options) => {\n        // if only passed options\n        if (typeof query === 'object' && !isFilePondFile(query) && !options) {\n            options = query;\n            query = undefined;\n        }\n\n        // request item removal\n        store.dispatch('REMOVE_ITEM', { ...options, query });\n\n        // see if item has been removed\n        return store.query('GET_ACTIVE_ITEM', query) === null;\n    };\n\n    const addFiles = (...args) =>\n        new Promise((resolve, reject) => {\n            const sources = [];\n            const options = {};\n\n            // user passed a sources array\n            if (isArray(args[0])) {\n                sources.push.apply(sources, args[0]);\n                Object.assign(options, args[1] || {});\n            } else {\n                // user passed sources as arguments, last one might be options object\n                const lastArgument = args[args.length - 1];\n                if (typeof lastArgument === 'object' && !(lastArgument instanceof Blob)) {\n                    Object.assign(options, args.pop());\n                }\n\n                // add rest to sources\n                sources.push(...args);\n            }\n\n            store.dispatch('ADD_ITEMS', {\n                items: sources,\n                index: options.index,\n                interactionMethod: InteractionMethod.API,\n                success: resolve,\n                failure: reject,\n            });\n        });\n\n    const getFiles = () => store.query('GET_ACTIVE_ITEMS');\n\n    const processFile = query =>\n        new Promise((resolve, reject) => {\n            store.dispatch('REQUEST_ITEM_PROCESSING', {\n                query,\n                success: item => {\n                    resolve(item);\n                },\n                failure: error => {\n                    reject(error);\n                },\n            });\n        });\n\n    const prepareFiles = (...args) => {\n        const queries = Array.isArray(args[0]) ? args[0] : args;\n        const items = queries.length ? queries : getFiles();\n        return Promise.all(items.map(prepareFile));\n    };\n\n    const processFiles = (...args) => {\n        const queries = Array.isArray(args[0]) ? args[0] : args;\n        if (!queries.length) {\n            const files = getFiles().filter(\n                item =>\n                    !(item.status === ItemStatus.IDLE && item.origin === FileOrigin.LOCAL) &&\n                    item.status !== ItemStatus.PROCESSING &&\n                    item.status !== ItemStatus.PROCESSING_COMPLETE &&\n                    item.status !== ItemStatus.PROCESSING_REVERT_ERROR\n            );\n            return Promise.all(files.map(processFile));\n        }\n        return Promise.all(queries.map(processFile));\n    };\n\n    const removeFiles = (...args) => {\n        const queries = Array.isArray(args[0]) ? args[0] : args;\n\n        let options;\n        if (typeof queries[queries.length - 1] === 'object') {\n            options = queries.pop();\n        } else if (Array.isArray(args[0])) {\n            options = args[1];\n        }\n\n        const files = getFiles();\n\n        if (!queries.length) return Promise.all(files.map(file => removeFile(file, options)));\n\n        // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n        const mappedQueries = queries\n            .map(query => (isNumber(query) ? (files[query] ? files[query].id : null) : query))\n            .filter(query => query);\n\n        return mappedQueries.map(q => removeFile(q, options));\n    };\n\n    const exports = {\n        // supports events\n        ...on(),\n\n        // inject private api methods\n        ...readWriteApi,\n\n        // inject all getters and setters\n        ...createOptionAPI(store, defaultOptions),\n\n        /**\n         * Override options defined in options object\n         * @param options\n         */\n        setOptions,\n\n        /**\n         * Load the given file\n         * @param source - the source of the file (either a File, base64 data uri or url)\n         * @param options - object, { index: 0 }\n         */\n        addFile,\n\n        /**\n         * Load the given files\n         * @param sources - the sources of the files to load\n         * @param options - object, { index: 0 }\n         */\n        addFiles,\n\n        /**\n         * Returns the file objects matching the given query\n         * @param query { string, number, null }\n         */\n        getFile,\n\n        /**\n         * Upload file with given name\n         * @param query { string, number, null  }\n         */\n        processFile,\n\n        /**\n         * Request prepare output for file with given name\n         * @param query { string, number, null  }\n         */\n        prepareFile,\n\n        /**\n         * Removes a file by its name\n         * @param query { string, number, null  }\n         */\n        removeFile,\n\n        /**\n         * Moves a file to a new location in the files list\n         */\n        moveFile: (query, index) => store.dispatch('MOVE_ITEM', { query, index }),\n\n        /**\n         * Returns all files (wrapped in public api)\n         */\n        getFiles,\n\n        /**\n         * Starts uploading all files\n         */\n        processFiles,\n\n        /**\n         * Clears all files from the files list\n         */\n        removeFiles,\n\n        /**\n         * Starts preparing output of all files\n         */\n        prepareFiles,\n\n        /**\n         * Sort list of files\n         */\n        sort: compare => store.dispatch('SORT', { compare }),\n\n        /**\n         * Browse the file system for a file\n         */\n        browse: () => {\n            // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n            var input = view.element.querySelector('input[type=file]');\n            if (input) {\n                input.click();\n            }\n        },\n\n        /**\n         * Destroys the app\n         */\n        destroy: () => {\n            // request destruction\n            exports.fire('destroy', view.element);\n\n            // stop active processes (file uploads, fetches, stuff like that)\n            // loop over items and depending on states call abort for ongoing processes\n            store.dispatch('ABORT_ALL');\n\n            // destroy view\n            view._destroy();\n\n            // stop listening to resize\n            window.removeEventListener('resize', resizeHandler);\n\n            // stop listening to the visiblitychange event\n            document.removeEventListener('visibilitychange', visibilityHandler);\n\n            // dispatch destroy\n            store.dispatch('DID_DESTROY');\n        },\n\n        /**\n         * Inserts the plugin before the target element\n         */\n        insertBefore: element => insertBefore(view.element, element),\n\n        /**\n         * Inserts the plugin after the target element\n         */\n        insertAfter: element => insertAfter(view.element, element),\n\n        /**\n         * Appends the plugin to the target element\n         */\n        appendTo: element => element.appendChild(view.element),\n\n        /**\n         * Replaces an element with the app\n         */\n        replaceElement: element => {\n            // insert the app before the element\n            insertBefore(view.element, element);\n\n            // remove the original element\n            element.parentNode.removeChild(element);\n\n            // remember original element\n            originalElement = element;\n        },\n\n        /**\n         * Restores the original element\n         */\n        restoreElement: () => {\n            if (!originalElement) {\n                return; // no element to restore\n            }\n\n            // restore original element\n            insertAfter(originalElement, view.element);\n\n            // remove our element\n            view.element.parentNode.removeChild(view.element);\n\n            // remove reference\n            originalElement = null;\n        },\n\n        /**\n         * Returns true if the app root is attached to given element\n         * @param element\n         */\n        isAttachedTo: element => view.element === element || originalElement === element,\n\n        /**\n         * Returns the root element\n         */\n        element: {\n            get: () => view.element,\n        },\n\n        /**\n         * Returns the current pond status\n         */\n        status: {\n            get: () => store.query('GET_STATUS'),\n        },\n    };\n\n    // Done!\n    store.dispatch('DID_INIT');\n\n    // create actual api object\n    return createObject(exports);\n};\n\nconst createAppObject = (customOptions = {}) => {\n    // default options\n    const defaultOptions = {};\n    forin(getOptions(), (key, value) => {\n        defaultOptions[key] = value[0];\n    });\n\n    // set app options\n    const app = createApp({\n        // default options\n        ...defaultOptions,\n\n        // custom options\n        ...customOptions,\n    });\n\n    // return the plugin instance\n    return app;\n};\n\nconst lowerCaseFirstLetter = string => string.charAt(0).toLowerCase() + string.slice(1);\n\nconst attributeNameToPropertyName = attributeName => toCamels(attributeName.replace(/^data-/, ''));\n\nconst mapObject = (object, propertyMap) => {\n    // remove unwanted\n    forin(propertyMap, (selector, mapping) => {\n        forin(object, (property, value) => {\n            // create regexp shortcut\n            const selectorRegExp = new RegExp(selector);\n\n            // tests if\n            const matches = selectorRegExp.test(property);\n\n            // no match, skip\n            if (!matches) {\n                return;\n            }\n\n            // if there's a mapping, the original property is always removed\n            delete object[property];\n\n            // should only remove, we done!\n            if (mapping === false) {\n                return;\n            }\n\n            // move value to new property\n            if (isString(mapping)) {\n                object[mapping] = value;\n                return;\n            }\n\n            // move to group\n            const group = mapping.group;\n            if (isObject(mapping) && !object[group]) {\n                object[group] = {};\n            }\n\n            object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ''))] = value;\n        });\n\n        // do submapping\n        if (mapping.mapping) {\n            mapObject(object[mapping.group], mapping.mapping);\n        }\n    });\n};\n\nconst getAttributesAsObject = (node, attributeMapping = {}) => {\n    // turn attributes into object\n    const attributes = [];\n    forin(node.attributes, index => {\n        attributes.push(node.attributes[index]);\n    });\n\n    const output = attributes\n        .filter(attribute => attribute.name)\n        .reduce((obj, attribute) => {\n            const value = attr(node, attribute.name);\n\n            obj[attributeNameToPropertyName(attribute.name)] =\n                value === attribute.name ? true : value;\n            return obj;\n        }, {});\n\n    // do mapping of object properties\n    mapObject(output, attributeMapping);\n\n    return output;\n};\n\nconst createAppAtElement = (element, options = {}) => {\n    // how attributes of the input element are mapped to the options for the plugin\n    const attributeMapping = {\n        // translate to other name\n        '^class$': 'className',\n        '^multiple$': 'allowMultiple',\n        '^capture$': 'captureMethod',\n        '^webkitdirectory$': 'allowDirectoriesOnly',\n\n        // group under single property\n        '^server': {\n            group: 'server',\n            mapping: {\n                '^process': {\n                    group: 'process',\n                },\n                '^revert': {\n                    group: 'revert',\n                },\n                '^fetch': {\n                    group: 'fetch',\n                },\n                '^restore': {\n                    group: 'restore',\n                },\n                '^load': {\n                    group: 'load',\n                },\n            },\n        },\n\n        // don't include in object\n        '^type$': false,\n        '^files$': false,\n    };\n\n    // add additional option translators\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping);\n\n    // create final options object by setting options object and then overriding options supplied on element\n    const mergedOptions = {\n        ...options,\n    };\n\n    const attributeOptions = getAttributesAsObject(\n        element.nodeName === 'FIELDSET' ? element.querySelector('input[type=file]') : element,\n        attributeMapping\n    );\n\n    // merge with options object\n    Object.keys(attributeOptions).forEach(key => {\n        if (isObject(attributeOptions[key])) {\n            if (!isObject(mergedOptions[key])) {\n                mergedOptions[key] = {};\n            }\n            Object.assign(mergedOptions[key], attributeOptions[key]);\n        } else {\n            mergedOptions[key] = attributeOptions[key];\n        }\n    });\n\n    // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n    // these will then be automatically set to the initial files\n    mergedOptions.files = (options.files || []).concat(\n        Array.from(element.querySelectorAll('input:not([type=file])')).map(input => ({\n            source: input.value,\n            options: {\n                type: input.dataset.type,\n            },\n        }))\n    );\n\n    // build plugin\n    const app = createAppObject(mergedOptions);\n\n    // add already selected files\n    if (element.files) {\n        Array.from(element.files).forEach(file => {\n            app.addFile(file);\n        });\n    }\n\n    // replace the target element\n    app.replaceElement(element);\n\n    // expose\n    return app;\n};\n\n// if an element is passed, we create the instance at that element, if not, we just create an up object\nconst createApp$1 = (...args) =>\n    isNode(args[0]) ? createAppAtElement(...args) : createAppObject(...args);\n\nconst PRIVATE_METHODS = ['fire', '_read', '_write'];\n\nconst createAppAPI = app => {\n    const api = {};\n\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n\n    return api;\n};\n\n/**\n * Replaces placeholders in given string with replacements\n * @param string - \"Foo {bar}\"\"\n * @param replacements - { \"bar\": 10 }\n */\nconst replaceInString = (string, replacements) =>\n    string.replace(/(?:{([a-zA-Z]+)})/g, (match, group) => replacements[group]);\n\nconst createWorker = fn => {\n    const workerBlob = new Blob(['(', fn.toString(), ')()'], {\n        type: 'application/javascript',\n    });\n    const workerURL = URL.createObjectURL(workerBlob);\n    const worker = new Worker(workerURL);\n\n    return {\n        transfer: (message, cb) => {},\n        post: (message, cb, transferList) => {\n            const id = getUniqueId();\n\n            worker.onmessage = e => {\n                if (e.data.id === id) {\n                    cb(e.data.message);\n                }\n            };\n\n            worker.postMessage(\n                {\n                    id,\n                    message,\n                },\n                transferList\n            );\n        },\n        terminate: () => {\n            worker.terminate();\n            URL.revokeObjectURL(workerURL);\n        },\n    };\n};\n\nconst loadImage = url =>\n    new Promise((resolve, reject) => {\n        const img = new Image();\n        img.onload = () => {\n            resolve(img);\n        };\n        img.onerror = e => {\n            reject(e);\n        };\n        img.src = url;\n    });\n\nconst renameFile = (file, name) => {\n    const renamedFile = file.slice(0, file.size, file.type);\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\n    renamedFile.name = name;\n    return renamedFile;\n};\n\nconst copyFile = file => renameFile(file, file.name);\n\n// already registered plugins (can't register twice)\nconst registeredPlugins = [];\n\n// pass utils to plugin\nconst createAppPlugin = plugin => {\n    // already registered\n    if (registeredPlugins.includes(plugin)) {\n        return;\n    }\n\n    // remember this plugin\n    registeredPlugins.push(plugin);\n\n    // setup!\n    const pluginOutline = plugin({\n        addFilter,\n        utils: {\n            Type,\n            forin,\n            isString,\n            isFile,\n            toNaturalFileSize,\n            replaceInString,\n            getExtensionFromFilename,\n            getFilenameWithoutExtension,\n            guesstimateMimeType,\n            getFileFromBlob,\n            getFilenameFromURL,\n            createRoute,\n            createWorker,\n            createView,\n            createItemAPI,\n            loadImage,\n            copyFile,\n            renameFile,\n            createBlob,\n            applyFilterChain,\n            text,\n            getNumericAspectRatioFromString,\n        },\n        views: {\n            fileActionButton,\n        },\n    });\n\n    // add plugin options to default options\n    extendDefaultOptions(pluginOutline.options);\n};\n\n// feature detection used by supported() method\nconst isOperaMini = () => Object.prototype.toString.call(window.operamini) === '[object OperaMini]';\nconst hasPromises = () => 'Promise' in window;\nconst hasBlobSlice = () => 'slice' in Blob.prototype;\nconst hasCreateObjectURL = () => 'URL' in window && 'createObjectURL' in window.URL;\nconst hasVisibility = () => 'visibilityState' in document;\nconst hasTiming = () => 'performance' in window; // iOS 8.x\nconst hasCSSSupports = () => 'supports' in (window.CSS || {}); // use to detect Safari 9+\nconst isIE11 = () => /MSIE|Trident/.test(window.navigator.userAgent);\n\nconst supported = (() => {\n    // Runs immediately and then remembers result for subsequent calls\n    const isSupported =\n        // Has to be a browser\n        isBrowser() &&\n        // Can't run on Opera Mini due to lack of everything\n        !isOperaMini() &&\n        // Require these APIs to feature detect a modern browser\n        hasVisibility() &&\n        hasPromises() &&\n        hasBlobSlice() &&\n        hasCreateObjectURL() &&\n        hasTiming() &&\n        // doesn't need CSSSupports but is a good way to detect Safari 9+ (we do want to support IE11 though)\n        (hasCSSSupports() || isIE11());\n\n    return () => isSupported;\n})();\n\n/**\n * Plugin internal state (over all instances)\n */\nconst state = {\n    // active app instances, used to redraw the apps and to find the later\n    apps: [],\n};\n\n// plugin name\nconst name = 'filepond';\n\n/**\n * Public Plugin methods\n */\nconst fn = () => {};\nlet Status$1 = {};\nlet FileStatus = {};\nlet FileOrigin$1 = {};\nlet OptionTypes = {};\nlet create$f = fn;\nlet destroy = fn;\nlet parse = fn;\nlet find = fn;\nlet registerPlugin = fn;\nlet getOptions$1 = fn;\nlet setOptions$1 = fn;\n\n// if not supported, no API\nif (supported()) {\n    // start painter and fire load event\n    createPainter(\n        () => {\n            state.apps.forEach(app => app._read());\n        },\n        ts => {\n            state.apps.forEach(app => app._write(ts));\n        }\n    );\n\n    // fire loaded event so we know when FilePond is available\n    const dispatch = () => {\n        // let others know we have area ready\n        document.dispatchEvent(\n            new CustomEvent('FilePond:loaded', {\n                detail: {\n                    supported,\n                    create: create$f,\n                    destroy,\n                    parse,\n                    find,\n                    registerPlugin,\n                    setOptions: setOptions$1,\n                },\n            })\n        );\n\n        // clean up event\n        document.removeEventListener('DOMContentLoaded', dispatch);\n    };\n\n    if (document.readyState !== 'loading') {\n        // move to back of execution queue, FilePond should have been exported by then\n        setTimeout(() => dispatch(), 0);\n    } else {\n        document.addEventListener('DOMContentLoaded', dispatch);\n    }\n\n    // updates the OptionTypes object based on the current options\n    const updateOptionTypes = () =>\n        forin(getOptions(), (key, value) => {\n            OptionTypes[key] = value[1];\n        });\n\n    Status$1 = { ...Status };\n    FileOrigin$1 = { ...FileOrigin };\n    FileStatus = { ...ItemStatus };\n\n    OptionTypes = {};\n    updateOptionTypes();\n\n    // create method, creates apps and adds them to the app array\n    create$f = (...args) => {\n        const app = createApp$1(...args);\n        app.on('destroy', destroy);\n        state.apps.push(app);\n        return createAppAPI(app);\n    };\n\n    // destroys apps and removes them from the app array\n    destroy = hook => {\n        // returns true if the app was destroyed successfully\n        const indexToRemove = state.apps.findIndex(app => app.isAttachedTo(hook));\n        if (indexToRemove >= 0) {\n            // remove from apps\n            const app = state.apps.splice(indexToRemove, 1)[0];\n\n            // restore original dom element\n            app.restoreElement();\n\n            return true;\n        }\n\n        return false;\n    };\n\n    // parses the given context for plugins (does not include the context element itself)\n    parse = context => {\n        // get all possible hooks\n        const matchedHooks = Array.from(context.querySelectorAll(`.${name}`));\n\n        // filter out already active hooks\n        const newHooks = matchedHooks.filter(\n            newHook => !state.apps.find(app => app.isAttachedTo(newHook))\n        );\n\n        // create new instance for each hook\n        return newHooks.map(hook => create$f(hook));\n    };\n\n    // returns an app based on the given element hook\n    find = hook => {\n        const app = state.apps.find(app => app.isAttachedTo(hook));\n        if (!app) {\n            return null;\n        }\n        return createAppAPI(app);\n    };\n\n    // adds a plugin extension\n    registerPlugin = (...plugins) => {\n        // register plugins\n        plugins.forEach(createAppPlugin);\n\n        // update OptionTypes, each plugin might have extended the default options\n        updateOptionTypes();\n    };\n\n    getOptions$1 = () => {\n        const opts = {};\n        forin(getOptions(), (key, value) => {\n            opts[key] = value[0];\n        });\n        return opts;\n    };\n\n    setOptions$1 = opts => {\n        if (isObject(opts)) {\n            // update existing plugins\n            state.apps.forEach(app => {\n                app.setOptions(opts);\n            });\n\n            // override defaults\n            setOptions(opts);\n        }\n\n        // return new options\n        return getOptions$1();\n    };\n}\n\nexport {\n    FileOrigin$1 as FileOrigin,\n    FileStatus,\n    OptionTypes,\n    Status$1 as Status,\n    create$f as create,\n    destroy,\n    find,\n    getOptions$1 as getOptions,\n    parse,\n    registerPlugin,\n    setOptions$1 as setOptions,\n    supported,\n};\n","/*!\n * vue-filepond v7.0.4\n * A handy FilePond adapter component for Vue\n * \n * Copyright (c) 2023 PQINA\n * https://pqina.nl/filepond\n * \n * Licensed under the MIT license.\n */\n\nimport { h } from \"vue\";\n\nimport { OptionTypes, create, supported, registerPlugin } from \"filepond\";\n\n// Methods not made available to the component\nconst filteredComponentMethods = [\n  \"setOptions\",\n  \"on\",\n  \"off\",\n  \"onOnce\",\n  \"appendTo\",\n  \"insertAfter\",\n  \"insertBefore\",\n  \"isAttachedTo\",\n  \"replaceElement\",\n  \"restoreElement\",\n  \"destroy\",\n];\n\n// Test if is supported on this client\nconst isSupported = supported();\n\n// Setup initial prop types and update when plugins are added\nconst getNativeConstructorFromType = (type) =>\n  ({\n    string: String,\n    boolean: Boolean,\n    array: Array,\n    function: Function,\n    int: Number,\n    serverapi: Object,\n    object: Object,\n  }[type]);\n\n// Activated props\nconst props = {};\n\n// Events that need to be mapped to emitters\nconst events = [];\n\n// all active instances\nconst instances = [];\n\n// global options\nlet globalOptions = {};\nexport const setOptions = (options) => {\n  globalOptions = Object.assign(globalOptions, options);\n  instances.forEach((instance) => {\n    instance.setOptions(globalOptions);\n  });\n};\n\nexport default (...plugins) => {\n  // register plugins in FilePond\n  registerPlugin(...plugins);\n\n  // build events and props array\n  events.length = 0;\n  for (const prop in OptionTypes) {\n    // don't add events to the props array\n    if (/^on/.test(prop)) {\n      events.push(prop);\n      continue;\n    }\n\n    // get property type ( can be either a String or the type defined within FilePond )\n    let valid_types = [String, getNativeConstructorFromType(OptionTypes[prop])];\n\n    // labelFileProcessingError can also be Function\n    if (prop == \"labelFileProcessingError\") {\n      valid_types.push(Function);\n    }\n\n    props[prop] = {\n      type: valid_types,\n\n      // set this default value so we know which props have been explicitely set by user on component\n      default: undefined,\n    };\n  }\n\n  // create\n  return {\n    name: \"FilePond\",\n    props,\n\n    render() {\n      // clean up undefined attributes\n      const attributes = Object.entries({\n        id: this.id,\n        name: this.name,\n        type: \"file\",\n        class: this.className,\n        required: this.required,\n        multiple: this.allowMultiple,\n        accept: this.acceptedFileTypes,\n        capture: this.captureMethod,\n      }).reduce((attributes, [key, value]) => {\n        if (value !== undefined) attributes[key] = value;\n        return attributes;\n      }, {});\n\n      // create base element\n      return h(\n        \"div\",\n        {\n          class: {\n            \"filepond--wrapper\": true,\n          },\n        },\n        [h(\"input\", attributes)]\n      );\n    },\n\n    created() {\n      this.watchers = Object.keys(props).map((key) => {\n        return this.$watch(key, (next) => {\n          // if pond is not initialized, don't update\n          if (!this._pond) return;\n          this._pond[key] = next;\n        });\n      });\n    },\n\n    // Will setup FilePond instance when mounted\n    mounted() {\n      // exit here if not supported\n      if (!isSupported) return;\n\n      // get pond element\n      this._element = this.$el.querySelector(\"input\");\n\n      // Map FilePond callback methods to Vue $emitters\n      const options = events.reduce((obj, value) => {\n        obj[value] = (...args) => {\n          this.$emit(\"input\", this._pond ? this._pond.getFiles() : []);\n          this.$emit(value.substr(2), ...args);\n        };\n        return obj;\n      }, {});\n\n      const passedProps = {};\n      Object.keys(props).forEach((key) => {\n        if (this[key] === undefined) return;\n        passedProps[key] = this[key];\n      });\n\n      // Create our pond\n      this._pond = create(\n        this._element,\n        Object.assign({}, globalOptions, options, passedProps)\n      );\n\n      // Copy instance method references to component instance\n      Object.keys(this._pond)\n        .filter((key) => !filteredComponentMethods.includes(key))\n        .forEach((key) => {\n          this[key] = this._pond[key];\n        });\n\n      // Add to instances so we can apply global options when used\n      instances.push(this._pond);\n    },\n\n    // Will clean up FilePond instance when unmounted\n    beforeUnmount() {\n      // reference to detached method\n      const { detached } = this.$options;\n\n      // no longer attached, clean up\n      if (!this.$el.offsetParent) {\n        detached.call(this);\n        return;\n      }\n\n      // if we're still attached it's likely a transition is running, we need to\n      // determine the moment when we're no longer attached to the DOM so we can\n      // clean up properly\n      const mutationHandler = (mutations, observer) => {\n        const removedNodes = (mutations[0] || {}).removedNodes || [];\n        const removedNode = removedNodes[0];\n        if (!removedNode || !removedNode.contains(this.$el)) return;\n        observer.disconnect();\n        detached.call(this);\n      };\n\n      // start observing parent element for changes to the DOM\n      const observer = new MutationObserver(mutationHandler);\n      observer.observe(document.documentElement, {\n        childList: true,\n        subtree: true,\n      });\n    },\n\n    // called when the component root node has been detached\n    detached() {\n      this.watchers.forEach((unwatch) => unwatch());\n\n      // exit when no pond defined\n      if (!this._pond) return;\n\n      // bye bye pond\n      this._pond.destroy();\n\n      // remove from instances\n      const index = instances.indexOf(this._pond);\n      if (index >= 0) {\n        instances.splice(index, 1);\n      }\n\n      // clear reference\n      this._pond = null;\n    },\n  };\n};\n\n","/*!\n * FilePondPluginImagePreview 4.6.12\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n// test if file is of type image and can be viewed in canvas\nconst isPreviewableImage = file => /^image/.test(file.type);\n\nconst vectorMultiply = (v, amount) => createVector(v.x * amount, v.y * amount);\n\nconst vectorAdd = (a, b) => createVector(a.x + b.x, a.y + b.y);\n\nconst vectorNormalize = v => {\n  const l = Math.sqrt(v.x * v.x + v.y * v.y);\n  if (l === 0) {\n    return {\n      x: 0,\n      y: 0\n    };\n  }\n  return createVector(v.x / l, v.y / l);\n};\n\nconst vectorRotate = (v, radians, origin) => {\n  const cos = Math.cos(radians);\n  const sin = Math.sin(radians);\n  const t = createVector(v.x - origin.x, v.y - origin.y);\n  return createVector(\n    origin.x + cos * t.x - sin * t.y,\n    origin.y + sin * t.x + cos * t.y\n  );\n};\n\nconst createVector = (x = 0, y = 0) => ({ x, y });\n\nconst getMarkupValue = (value, size, scalar = 1, axis) => {\n  if (typeof value === 'string') {\n    return parseFloat(value) * scalar;\n  }\n  if (typeof value === 'number') {\n    return value * (axis ? size[axis] : Math.min(size.width, size.height));\n  }\n  return;\n};\n\nconst getMarkupStyles = (markup, size, scale) => {\n  const lineStyle = markup.borderStyle || markup.lineStyle || 'solid';\n  const fill = markup.backgroundColor || markup.fontColor || 'transparent';\n  const stroke = markup.borderColor || markup.lineColor || 'transparent';\n  const strokeWidth = getMarkupValue(\n    markup.borderWidth || markup.lineWidth,\n    size,\n    scale\n  );\n  const lineCap = markup.lineCap || 'round';\n  const lineJoin = markup.lineJoin || 'round';\n  const dashes =\n    typeof lineStyle === 'string'\n      ? ''\n      : lineStyle.map(v => getMarkupValue(v, size, scale)).join(',');\n  const opacity = markup.opacity || 1;\n  return {\n    'stroke-linecap': lineCap,\n    'stroke-linejoin': lineJoin,\n    'stroke-width': strokeWidth || 0,\n    'stroke-dasharray': dashes,\n    stroke,\n    fill,\n    opacity\n  };\n};\n\nconst isDefined = value => value != null;\n\nconst getMarkupRect = (rect, size, scalar = 1) => {\n  let left =\n    getMarkupValue(rect.x, size, scalar, 'width') ||\n    getMarkupValue(rect.left, size, scalar, 'width');\n  let top =\n    getMarkupValue(rect.y, size, scalar, 'height') ||\n    getMarkupValue(rect.top, size, scalar, 'height');\n  let width = getMarkupValue(rect.width, size, scalar, 'width');\n  let height = getMarkupValue(rect.height, size, scalar, 'height');\n  let right = getMarkupValue(rect.right, size, scalar, 'width');\n  let bottom = getMarkupValue(rect.bottom, size, scalar, 'height');\n\n  if (!isDefined(top)) {\n    if (isDefined(height) && isDefined(bottom)) {\n      top = size.height - height - bottom;\n    } else {\n      top = bottom;\n    }\n  }\n\n  if (!isDefined(left)) {\n    if (isDefined(width) && isDefined(right)) {\n      left = size.width - width - right;\n    } else {\n      left = right;\n    }\n  }\n\n  if (!isDefined(width)) {\n    if (isDefined(left) && isDefined(right)) {\n      width = size.width - left - right;\n    } else {\n      width = 0;\n    }\n  }\n\n  if (!isDefined(height)) {\n    if (isDefined(top) && isDefined(bottom)) {\n      height = size.height - top - bottom;\n    } else {\n      height = 0;\n    }\n  }\n\n  return {\n    x: left || 0,\n    y: top || 0,\n    width: width || 0,\n    height: height || 0\n  };\n};\n\nconst pointsToPathShape = points =>\n  points\n    .map((point, index) => `${index === 0 ? 'M' : 'L'} ${point.x} ${point.y}`)\n    .join(' ');\n\nconst setAttributes = (element, attr) =>\n  Object.keys(attr).forEach(key => element.setAttribute(key, attr[key]));\n\nconst ns = 'http://www.w3.org/2000/svg';\nconst svg = (tag, attr) => {\n  const element = document.createElementNS(ns, tag);\n  if (attr) {\n    setAttributes(element, attr);\n  }\n  return element;\n};\n\nconst updateRect = element =>\n  setAttributes(element, {\n    ...element.rect,\n    ...element.styles\n  });\n\nconst updateEllipse = element => {\n  const cx = element.rect.x + element.rect.width * 0.5;\n  const cy = element.rect.y + element.rect.height * 0.5;\n  const rx = element.rect.width * 0.5;\n  const ry = element.rect.height * 0.5;\n  return setAttributes(element, {\n    cx,\n    cy,\n    rx,\n    ry,\n    ...element.styles\n  });\n};\n\nconst IMAGE_FIT_STYLE = {\n  contain: 'xMidYMid meet',\n  cover: 'xMidYMid slice'\n};\n\nconst updateImage = (element, markup) => {\n  setAttributes(element, {\n    ...element.rect,\n    ...element.styles,\n    preserveAspectRatio: IMAGE_FIT_STYLE[markup.fit] || 'none'\n  });\n};\n\nconst TEXT_ANCHOR = {\n  left: 'start',\n  center: 'middle',\n  right: 'end'\n};\n\nconst updateText = (element, markup, size, scale) => {\n  const fontSize = getMarkupValue(markup.fontSize, size, scale);\n  const fontFamily = markup.fontFamily || 'sans-serif';\n  const fontWeight = markup.fontWeight || 'normal';\n  const textAlign = TEXT_ANCHOR[markup.textAlign] || 'start';\n\n  setAttributes(element, {\n    ...element.rect,\n    ...element.styles,\n    'stroke-width': 0,\n    'font-weight': fontWeight,\n    'font-size': fontSize,\n    'font-family': fontFamily,\n    'text-anchor': textAlign\n  });\n\n  // update text\n  if (element.text !== markup.text) {\n    element.text = markup.text;\n    element.textContent = markup.text.length ? markup.text : ' ';\n  }\n};\n\nconst updateLine = (element, markup, size, scale) => {\n  setAttributes(element, {\n    ...element.rect,\n    ...element.styles,\n    fill: 'none'\n  });\n\n  const line = element.childNodes[0];\n  const begin = element.childNodes[1];\n  const end = element.childNodes[2];\n\n  const origin = element.rect;\n\n  const target = {\n    x: element.rect.x + element.rect.width,\n    y: element.rect.y + element.rect.height\n  };\n\n  setAttributes(line, {\n    x1: origin.x,\n    y1: origin.y,\n    x2: target.x,\n    y2: target.y\n  });\n\n  if (!markup.lineDecoration) return;\n\n  begin.style.display = 'none';\n  end.style.display = 'none';\n\n  const v = vectorNormalize({\n    x: target.x - origin.x,\n    y: target.y - origin.y\n  });\n\n  const l = getMarkupValue(0.05, size, scale);\n\n  if (markup.lineDecoration.indexOf('arrow-begin') !== -1) {\n    const arrowBeginRotationPoint = vectorMultiply(v, l);\n    const arrowBeginCenter = vectorAdd(origin, arrowBeginRotationPoint);\n    const arrowBeginA = vectorRotate(origin, 2, arrowBeginCenter);\n    const arrowBeginB = vectorRotate(origin, -2, arrowBeginCenter);\n\n    setAttributes(begin, {\n      style: 'display:block;',\n      d: `M${arrowBeginA.x},${arrowBeginA.y} L${origin.x},${origin.y} L${\n        arrowBeginB.x\n      },${arrowBeginB.y}`\n    });\n  }\n\n  if (markup.lineDecoration.indexOf('arrow-end') !== -1) {\n    const arrowEndRotationPoint = vectorMultiply(v, -l);\n    const arrowEndCenter = vectorAdd(target, arrowEndRotationPoint);\n    const arrowEndA = vectorRotate(target, 2, arrowEndCenter);\n    const arrowEndB = vectorRotate(target, -2, arrowEndCenter);\n\n    setAttributes(end, {\n      style: 'display:block;',\n      d: `M${arrowEndA.x},${arrowEndA.y} L${target.x},${target.y} L${\n        arrowEndB.x\n      },${arrowEndB.y}`\n    });\n  }\n};\n\nconst updatePath = (element, markup, size, scale) => {\n  setAttributes(element, {\n    ...element.styles,\n    fill: 'none',\n    d: pointsToPathShape(\n      markup.points.map(point => ({\n        x: getMarkupValue(point.x, size, scale, 'width'),\n        y: getMarkupValue(point.y, size, scale, 'height')\n      }))\n    )\n  });\n};\n\nconst createShape = node => markup => svg(node, { id: markup.id });\n\nconst createImage = markup => {\n  const shape = svg('image', {\n    id: markup.id,\n    'stroke-linecap': 'round',\n    'stroke-linejoin': 'round',\n    opacity: '0'\n  });\n  shape.onload = () => {\n    shape.setAttribute('opacity', markup.opacity || 1);\n  };\n  shape.setAttributeNS(\n    'http://www.w3.org/1999/xlink',\n    'xlink:href',\n    markup.src\n  );\n  return shape;\n};\n\nconst createLine = markup => {\n  const shape = svg('g', {\n    id: markup.id,\n    'stroke-linecap': 'round',\n    'stroke-linejoin': 'round'\n  });\n\n  const line = svg('line');\n  shape.appendChild(line);\n\n  const begin = svg('path');\n  shape.appendChild(begin);\n\n  const end = svg('path');\n  shape.appendChild(end);\n\n  return shape;\n};\n\nconst CREATE_TYPE_ROUTES = {\n  image: createImage,\n  rect: createShape('rect'),\n  ellipse: createShape('ellipse'),\n  text: createShape('text'),\n  path: createShape('path'),\n  line: createLine\n};\n\nconst UPDATE_TYPE_ROUTES = {\n  rect: updateRect,\n  ellipse: updateEllipse,\n  image: updateImage,\n  text: updateText,\n  path: updatePath,\n  line: updateLine\n};\n\nconst createMarkupByType = (type, markup) => CREATE_TYPE_ROUTES[type](markup);\n\nconst updateMarkupByType = (element, type, markup, size, scale) => {\n  if (type !== 'path') {\n    element.rect = getMarkupRect(markup, size, scale);\n  }\n  element.styles = getMarkupStyles(markup, size, scale);\n  UPDATE_TYPE_ROUTES[type](element, markup, size, scale);\n};\n\nconst MARKUP_RECT = [\n  'x',\n  'y',\n  'left',\n  'top',\n  'right',\n  'bottom',\n  'width',\n  'height'\n];\n\nconst toOptionalFraction = value =>\n  typeof value === 'string' && /%/.test(value)\n    ? parseFloat(value) / 100\n    : value;\n\n// adds default markup properties, clones markup\nconst prepareMarkup = markup => {\n  const [type, props] = markup;\n\n  const rect = props.points\n    ? {}\n    : MARKUP_RECT.reduce((prev, curr) => {\n        prev[curr] = toOptionalFraction(props[curr]);\n        return prev;\n      }, {});\n\n  return [\n    type,\n    {\n      zIndex: 0,\n      ...props,\n      ...rect\n    }\n  ];\n};\n\nconst sortMarkupByZIndex = (a, b) => {\n  if (a[1].zIndex > b[1].zIndex) {\n    return 1;\n  }\n  if (a[1].zIndex < b[1].zIndex) {\n    return -1;\n  }\n  return 0;\n};\n\nconst createMarkupView = _ =>\n  _.utils.createView({\n    name: 'image-preview-markup',\n    tag: 'svg',\n    ignoreRect: true,\n    mixins: {\n      apis: ['width', 'height', 'crop', 'markup', 'resize', 'dirty']\n    },\n    write: ({ root, props }) => {\n      if (!props.dirty) return;\n\n      const { crop, resize, markup } = props;\n\n      const viewWidth = props.width;\n      const viewHeight = props.height;\n\n      let cropWidth = crop.width;\n      let cropHeight = crop.height;\n\n      if (resize) {\n        const { size } = resize;\n\n        let outputWidth = size && size.width;\n        let outputHeight = size && size.height;\n        const outputFit = resize.mode;\n        const outputUpscale = resize.upscale;\n\n        if (outputWidth && !outputHeight) outputHeight = outputWidth;\n        if (outputHeight && !outputWidth) outputWidth = outputHeight;\n\n        const shouldUpscale =\n          cropWidth < outputWidth && cropHeight < outputHeight;\n\n        if (!shouldUpscale || (shouldUpscale && outputUpscale)) {\n          let scalarWidth = outputWidth / cropWidth;\n          let scalarHeight = outputHeight / cropHeight;\n\n          if (outputFit === 'force') {\n            cropWidth = outputWidth;\n            cropHeight = outputHeight;\n          } else {\n            let scalar;\n            if (outputFit === 'cover') {\n              scalar = Math.max(scalarWidth, scalarHeight);\n            } else if (outputFit === 'contain') {\n              scalar = Math.min(scalarWidth, scalarHeight);\n            }\n            cropWidth = cropWidth * scalar;\n            cropHeight = cropHeight * scalar;\n          }\n        }\n      }\n\n      const size = {\n        width: viewWidth,\n        height: viewHeight\n      };\n\n      root.element.setAttribute('width', size.width);\n      root.element.setAttribute('height', size.height);\n\n      const scale = Math.min(viewWidth / cropWidth, viewHeight / cropHeight);\n\n      // clear\n      root.element.innerHTML = '';\n\n      // get filter\n      const markupFilter = root.query('GET_IMAGE_PREVIEW_MARKUP_FILTER');\n\n      // draw new\n      markup\n        .filter(markupFilter)\n        .map(prepareMarkup)\n        .sort(sortMarkupByZIndex)\n        .forEach(markup => {\n          const [type, settings] = markup;\n\n          // create\n          const element = createMarkupByType(type, settings);\n\n          // update\n          updateMarkupByType(element, type, settings, size, scale);\n\n          // add\n          root.element.appendChild(element);\n        });\n    }\n  });\n\nconst createVector$1 = (x, y) => ({ x, y });\n\nconst vectorDot = (a, b) => a.x * b.x + a.y * b.y;\n\nconst vectorSubtract = (a, b) => createVector$1(a.x - b.x, a.y - b.y);\n\nconst vectorDistanceSquared = (a, b) =>\n  vectorDot(vectorSubtract(a, b), vectorSubtract(a, b));\n\nconst vectorDistance = (a, b) => Math.sqrt(vectorDistanceSquared(a, b));\n\nconst getOffsetPointOnEdge = (length, rotation) => {\n  const a = length;\n\n  const A = 1.5707963267948966;\n  const B = rotation;\n  const C = 1.5707963267948966 - rotation;\n\n  const sinA = Math.sin(A);\n  const sinB = Math.sin(B);\n  const sinC = Math.sin(C);\n  const cosC = Math.cos(C);\n  const ratio = a / sinA;\n  const b = ratio * sinB;\n  const c = ratio * sinC;\n\n  return createVector$1(cosC * b, cosC * c);\n};\n\nconst getRotatedRectSize = (rect, rotation) => {\n  const w = rect.width;\n  const h = rect.height;\n\n  const hor = getOffsetPointOnEdge(w, rotation);\n  const ver = getOffsetPointOnEdge(h, rotation);\n\n  const tl = createVector$1(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n\n  const tr = createVector$1(\n    rect.x + rect.width + Math.abs(ver.y),\n    rect.y + Math.abs(ver.x)\n  );\n\n  const bl = createVector$1(\n    rect.x - Math.abs(ver.y),\n    rect.y + rect.height - Math.abs(ver.x)\n  );\n\n  return {\n    width: vectorDistance(tl, tr),\n    height: vectorDistance(tl, bl)\n  };\n};\n\nconst calculateCanvasSize = (image, canvasAspectRatio, zoom = 1) => {\n  const imageAspectRatio = image.height / image.width;\n\n  // determine actual pixels on x and y axis\n  let canvasWidth = 1;\n  let canvasHeight = canvasAspectRatio;\n  let imgWidth = 1;\n  let imgHeight = imageAspectRatio;\n  if (imgHeight > canvasHeight) {\n    imgHeight = canvasHeight;\n    imgWidth = imgHeight / imageAspectRatio;\n  }\n\n  const scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n  const width = image.width / (zoom * scalar * imgWidth);\n  const height = width * canvasAspectRatio;\n\n  return {\n    width: width,\n    height: height\n  };\n};\n\nconst getImageRectZoomFactor = (imageRect, cropRect, rotation, center) => {\n  // calculate available space round image center position\n  const cx = center.x > 0.5 ? 1 - center.x : center.x;\n  const cy = center.y > 0.5 ? 1 - center.y : center.y;\n  const imageWidth = cx * 2 * imageRect.width;\n  const imageHeight = cy * 2 * imageRect.height;\n\n  // calculate rotated crop rectangle size\n  const rotatedCropSize = getRotatedRectSize(cropRect, rotation);\n\n  // calculate scalar required to fit image\n  return Math.max(\n    rotatedCropSize.width / imageWidth,\n    rotatedCropSize.height / imageHeight\n  );\n};\n\nconst getCenteredCropRect = (container, aspectRatio) => {\n  let width = container.width;\n  let height = width * aspectRatio;\n  if (height > container.height) {\n    height = container.height;\n    width = height / aspectRatio;\n  }\n  const x = (container.width - width) * 0.5;\n  const y = (container.height - height) * 0.5;\n\n  return {\n    x,\n    y,\n    width,\n    height\n  };\n};\n\nconst getCurrentCropSize = (imageSize, crop = {}) => {\n  let { zoom, rotation, center, aspectRatio } = crop;\n\n  if (!aspectRatio) aspectRatio = imageSize.height / imageSize.width;\n\n  const canvasSize = calculateCanvasSize(imageSize, aspectRatio, zoom);\n\n  const canvasCenter = {\n    x: canvasSize.width * 0.5,\n    y: canvasSize.height * 0.5\n  };\n\n  const stage = {\n    x: 0,\n    y: 0,\n    width: canvasSize.width,\n    height: canvasSize.height,\n    center: canvasCenter\n  };\n\n  const shouldLimit = typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n  const stageZoomFactor = getImageRectZoomFactor(\n    imageSize,\n    getCenteredCropRect(stage, aspectRatio),\n    rotation,\n    shouldLimit ? center : { x: 0.5, y: 0.5 }\n  );\n\n  const scale = zoom * stageZoomFactor;\n\n  // start drawing\n  return {\n    widthFloat: canvasSize.width / scale,\n    heightFloat: canvasSize.height / scale,\n    width: Math.round(canvasSize.width / scale),\n    height: Math.round(canvasSize.height / scale)\n  };\n};\n\nconst IMAGE_SCALE_SPRING_PROPS = {\n  type: 'spring',\n  stiffness: 0.5,\n  damping: 0.45,\n  mass: 10\n};\n\n// does horizontal and vertical flipping\nconst createBitmapView = _ =>\n  _.utils.createView({\n    name: 'image-bitmap',\n    ignoreRect: true,\n    mixins: { styles: ['scaleX', 'scaleY'] },\n    create: ({ root, props }) => {\n      root.appendChild(props.image);\n    }\n  });\n\n// shifts and rotates image\nconst createImageCanvasWrapper = _ =>\n  _.utils.createView({\n    name: 'image-canvas-wrapper',\n    tag: 'div',\n    ignoreRect: true,\n    mixins: {\n      apis: ['crop', 'width', 'height'],\n      styles: [\n        'originX',\n        'originY',\n        'translateX',\n        'translateY',\n        'scaleX',\n        'scaleY',\n        'rotateZ'\n      ],\n      animations: {\n        originX: IMAGE_SCALE_SPRING_PROPS,\n        originY: IMAGE_SCALE_SPRING_PROPS,\n        scaleX: IMAGE_SCALE_SPRING_PROPS,\n        scaleY: IMAGE_SCALE_SPRING_PROPS,\n        translateX: IMAGE_SCALE_SPRING_PROPS,\n        translateY: IMAGE_SCALE_SPRING_PROPS,\n        rotateZ: IMAGE_SCALE_SPRING_PROPS\n      }\n    },\n    create: ({ root, props }) => {\n      props.width = props.image.width;\n      props.height = props.image.height;\n      root.ref.bitmap = root.appendChildView(\n        root.createChildView(createBitmapView(_), { image: props.image })\n      );\n    },\n    write: ({ root, props }) => {\n      const { flip } = props.crop;\n      const { bitmap } = root.ref;\n      bitmap.scaleX = flip.horizontal ? -1 : 1;\n      bitmap.scaleY = flip.vertical ? -1 : 1;\n    }\n  });\n\n// clips canvas to correct aspect ratio\nconst createClipView = _ =>\n  _.utils.createView({\n    name: 'image-clip',\n    tag: 'div',\n    ignoreRect: true,\n    mixins: {\n      apis: [\n        'crop',\n        'markup',\n        'resize',\n        'width',\n        'height',\n        'dirty',\n        'background'\n      ],\n      styles: ['width', 'height', 'opacity'],\n      animations: {\n        opacity: { type: 'tween', duration: 250 }\n      }\n    },\n    didWriteView: function({ root, props }) {\n      if (!props.background) return;\n      root.element.style.backgroundColor = props.background;\n    },\n    create: ({ root, props }) => {\n      root.ref.image = root.appendChildView(\n        root.createChildView(\n          createImageCanvasWrapper(_),\n          Object.assign({}, props)\n        )\n      );\n\n      root.ref.createMarkup = () => {\n        if (root.ref.markup) return;\n        root.ref.markup = root.appendChildView(\n          root.createChildView(createMarkupView(_), Object.assign({}, props))\n        );\n      };\n\n      root.ref.destroyMarkup = () => {\n        if (!root.ref.markup) return;\n        root.removeChildView(root.ref.markup);\n        root.ref.markup = null;\n      };\n\n      // set up transparency grid\n      const transparencyIndicator = root.query(\n        'GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR'\n      );\n      if (transparencyIndicator === null) return;\n\n      // grid pattern\n      if (transparencyIndicator === 'grid') {\n        root.element.dataset.transparencyIndicator = transparencyIndicator;\n      }\n      // basic color\n      else {\n        root.element.dataset.transparencyIndicator = 'color';\n      }\n    },\n    write: ({ root, props, shouldOptimize }) => {\n      const { crop, markup, resize, dirty, width, height } = props;\n\n      root.ref.image.crop = crop;\n\n      const stage = {\n        x: 0,\n        y: 0,\n        width,\n        height,\n        center: {\n          x: width * 0.5,\n          y: height * 0.5\n        }\n      };\n\n      const image = {\n        width: root.ref.image.width,\n        height: root.ref.image.height\n      };\n\n      const origin = {\n        x: crop.center.x * image.width,\n        y: crop.center.y * image.height\n      };\n\n      const translation = {\n        x: stage.center.x - image.width * crop.center.x,\n        y: stage.center.y - image.height * crop.center.y\n      };\n\n      const rotation = Math.PI * 2 + (crop.rotation % (Math.PI * 2));\n\n      const cropAspectRatio = crop.aspectRatio || image.height / image.width;\n\n      const shouldLimit =\n        typeof crop.scaleToFit === 'undefined' || crop.scaleToFit;\n\n      const stageZoomFactor = getImageRectZoomFactor(\n        image,\n        getCenteredCropRect(stage, cropAspectRatio),\n        rotation,\n        shouldLimit ? crop.center : { x: 0.5, y: 0.5 }\n      );\n\n      const scale = crop.zoom * stageZoomFactor;\n\n      // update markup view\n      if (markup && markup.length) {\n        root.ref.createMarkup();\n        root.ref.markup.width = width;\n        root.ref.markup.height = height;\n        root.ref.markup.resize = resize;\n        root.ref.markup.dirty = dirty;\n        root.ref.markup.markup = markup;\n        root.ref.markup.crop = getCurrentCropSize(image, crop);\n      } else if (root.ref.markup) {\n        root.ref.destroyMarkup();\n      }\n\n      // update image view\n      const imageView = root.ref.image;\n\n      // don't update clip layout\n      if (shouldOptimize) {\n        imageView.originX = null;\n        imageView.originY = null;\n        imageView.translateX = null;\n        imageView.translateY = null;\n        imageView.rotateZ = null;\n        imageView.scaleX = null;\n        imageView.scaleY = null;\n        return;\n      }\n\n      imageView.originX = origin.x;\n      imageView.originY = origin.y;\n      imageView.translateX = translation.x;\n      imageView.translateY = translation.y;\n      imageView.rotateZ = rotation;\n      imageView.scaleX = scale;\n      imageView.scaleY = scale;\n    }\n  });\n\nconst createImageView = _ =>\n  _.utils.createView({\n    name: 'image-preview',\n    tag: 'div',\n    ignoreRect: true,\n    mixins: {\n      apis: ['image', 'crop', 'markup', 'resize', 'dirty', 'background'],\n      styles: ['translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: IMAGE_SCALE_SPRING_PROPS,\n        scaleY: IMAGE_SCALE_SPRING_PROPS,\n        translateY: IMAGE_SCALE_SPRING_PROPS,\n        opacity: { type: 'tween', duration: 400 }\n      }\n    },\n    create: ({ root, props }) => {\n      root.ref.clip = root.appendChildView(\n        root.createChildView(createClipView(_), {\n          id: props.id,\n          image: props.image,\n          crop: props.crop,\n          markup: props.markup,\n          resize: props.resize,\n          dirty: props.dirty,\n          background: props.background\n        })\n      );\n    },\n    write: ({ root, props, shouldOptimize }) => {\n      const { clip } = root.ref;\n\n      const { image, crop, markup, resize, dirty } = props;\n\n      clip.crop = crop;\n      clip.markup = markup;\n      clip.resize = resize;\n      clip.dirty = dirty;\n\n      // don't update clip layout\n      clip.opacity = shouldOptimize ? 0 : 1;\n\n      // don't re-render if optimizing or hidden (width will be zero resulting in weird animations)\n      if (shouldOptimize || root.rect.element.hidden) return;\n\n      // calculate scaled preview image size\n      const imageAspectRatio = image.height / image.width;\n      let aspectRatio = crop.aspectRatio || imageAspectRatio;\n\n      // calculate container size\n      const containerWidth = root.rect.inner.width;\n      const containerHeight = root.rect.inner.height;\n\n      let fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n      const minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n      const maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n      const panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n      const allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n\n      if (panelAspectRatio && !allowMultiple) {\n        fixedPreviewHeight = containerWidth * panelAspectRatio;\n        aspectRatio = panelAspectRatio;\n      }\n\n      // determine clip width and height\n      let clipHeight =\n        fixedPreviewHeight !== null\n          ? fixedPreviewHeight\n          : Math.max(\n              minPreviewHeight,\n              Math.min(containerWidth * aspectRatio, maxPreviewHeight)\n            );\n\n      let clipWidth = clipHeight / aspectRatio;\n      if (clipWidth > containerWidth) {\n        clipWidth = containerWidth;\n        clipHeight = clipWidth * aspectRatio;\n      }\n\n      if (clipHeight > containerHeight) {\n        clipHeight = containerHeight;\n        clipWidth = containerHeight / aspectRatio;\n      }\n\n      clip.width = clipWidth;\n      clip.height = clipHeight;\n    }\n  });\n\nlet SVG_MASK = `<svg width=\"500\" height=\"200\" viewBox=\"0 0 500 200\" preserveAspectRatio=\"none\">\n    <defs>\n        <radialGradient id=\"gradient-__UID__\" cx=\".5\" cy=\"1.25\" r=\"1.15\">\n            <stop offset='50%' stop-color='#000000'/>\n            <stop offset='56%' stop-color='#0a0a0a'/>\n            <stop offset='63%' stop-color='#262626'/>\n            <stop offset='69%' stop-color='#4f4f4f'/>\n            <stop offset='75%' stop-color='#808080'/>\n            <stop offset='81%' stop-color='#b1b1b1'/>\n            <stop offset='88%' stop-color='#dadada'/>\n            <stop offset='94%' stop-color='#f6f6f6'/>\n            <stop offset='100%' stop-color='#ffffff'/>\n        </radialGradient>\n        <mask id=\"mask-__UID__\">\n            <rect x=\"0\" y=\"0\" width=\"500\" height=\"200\" fill=\"url(#gradient-__UID__)\"></rect>\n        </mask>\n    </defs>\n    <rect x=\"0\" width=\"500\" height=\"200\" fill=\"currentColor\" mask=\"url(#mask-__UID__)\"></rect>\n</svg>`;\n\nlet SVGMaskUniqueId = 0;\n\nconst createImageOverlayView = fpAPI =>\n  fpAPI.utils.createView({\n    name: 'image-preview-overlay',\n    tag: 'div',\n    ignoreRect: true,\n    create: ({ root, props }) => {\n      let mask = SVG_MASK;\n      if (document.querySelector('base')) {\n        const url = new URL(\n          window.location.href.replace(window.location.hash, '')\n        ).href;\n        mask = mask.replace(/url\\(\\#/g, 'url(' + url + '#');\n      }\n\n      SVGMaskUniqueId++;\n      root.element.classList.add(\n        `filepond--image-preview-overlay-${props.status}`\n      );\n      root.element.innerHTML = mask.replace(/__UID__/g, SVGMaskUniqueId);\n    },\n    mixins: {\n      styles: ['opacity'],\n      animations: {\n        opacity: { type: 'spring', mass: 25 }\n      }\n    }\n  });\n\n/**\n * Bitmap Worker\n */\nconst BitmapWorker = function() {\n  self.onmessage = e => {\n    createImageBitmap(e.data.message.file).then(bitmap => {\n      self.postMessage({ id: e.data.id, message: bitmap }, [bitmap]);\n    });\n  };\n};\n\n/**\n * ColorMatrix Worker\n */\nconst ColorMatrixWorker = function() {\n  self.onmessage = e => {\n    const imageData = e.data.message.imageData;\n    const matrix = e.data.message.colorMatrix;\n\n    const data = imageData.data;\n    const l = data.length;\n\n    const m11 = matrix[0];\n    const m12 = matrix[1];\n    const m13 = matrix[2];\n    const m14 = matrix[3];\n    const m15 = matrix[4];\n\n    const m21 = matrix[5];\n    const m22 = matrix[6];\n    const m23 = matrix[7];\n    const m24 = matrix[8];\n    const m25 = matrix[9];\n\n    const m31 = matrix[10];\n    const m32 = matrix[11];\n    const m33 = matrix[12];\n    const m34 = matrix[13];\n    const m35 = matrix[14];\n\n    const m41 = matrix[15];\n    const m42 = matrix[16];\n    const m43 = matrix[17];\n    const m44 = matrix[18];\n    const m45 = matrix[19];\n\n    let index = 0,\n      r = 0.0,\n      g = 0.0,\n      b = 0.0,\n      a = 0.0;\n\n    for (; index < l; index += 4) {\n      r = data[index] / 255;\n      g = data[index + 1] / 255;\n      b = data[index + 2] / 255;\n      a = data[index + 3] / 255;\n      data[index] = Math.max(\n        0,\n        Math.min((r * m11 + g * m12 + b * m13 + a * m14 + m15) * 255, 255)\n      );\n      data[index + 1] = Math.max(\n        0,\n        Math.min((r * m21 + g * m22 + b * m23 + a * m24 + m25) * 255, 255)\n      );\n      data[index + 2] = Math.max(\n        0,\n        Math.min((r * m31 + g * m32 + b * m33 + a * m34 + m35) * 255, 255)\n      );\n      data[index + 3] = Math.max(\n        0,\n        Math.min((r * m41 + g * m42 + b * m43 + a * m44 + m45) * 255, 255)\n      );\n    }\n\n    self.postMessage({ id: e.data.id, message: imageData }, [\n      imageData.data.buffer\n    ]);\n  };\n};\n\nconst getImageSize = (url, cb) => {\n  let image = new Image();\n  image.onload = () => {\n    const width = image.naturalWidth;\n    const height = image.naturalHeight;\n    image = null;\n    cb(width, height);\n  };\n  image.src = url;\n};\n\nconst transforms = {\n  1: () => [1, 0, 0, 1, 0, 0],\n  2: width => [-1, 0, 0, 1, width, 0],\n  3: (width, height) => [-1, 0, 0, -1, width, height],\n  4: (width, height) => [1, 0, 0, -1, 0, height],\n  5: () => [0, 1, 1, 0, 0, 0],\n  6: (width, height) => [0, 1, -1, 0, height, 0],\n  7: (width, height) => [0, -1, -1, 0, height, width],\n  8: width => [0, -1, 1, 0, 0, width]\n};\n\nconst fixImageOrientation = (ctx, width, height, orientation) => {\n  // no orientation supplied\n  if (orientation === -1) {\n    return;\n  }\n\n  ctx.transform.apply(ctx, transforms[orientation](width, height));\n};\n\n// draws the preview image to canvas\nconst createPreviewImage = (data, width, height, orientation) => {\n  // can't draw on half pixels\n  width = Math.round(width);\n  height = Math.round(height);\n\n  // draw image\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const ctx = canvas.getContext('2d');\n\n  // if is rotated incorrectly swap width and height\n  if (orientation >= 5 && orientation <= 8) {\n    [width, height] = [height, width];\n  }\n\n  // correct image orientation\n  fixImageOrientation(ctx, width, height, orientation);\n\n  // draw the image\n  ctx.drawImage(data, 0, 0, width, height);\n\n  return canvas;\n};\n\nconst isBitmap = file => /^image/.test(file.type) && !/svg/.test(file.type);\n\nconst MAX_WIDTH = 10;\nconst MAX_HEIGHT = 10;\n\nconst calculateAverageColor = image => {\n  const scalar = Math.min(MAX_WIDTH / image.width, MAX_HEIGHT / image.height);\n\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  const width = (canvas.width = Math.ceil(image.width * scalar));\n  const height = (canvas.height = Math.ceil(image.height * scalar));\n  ctx.drawImage(image, 0, 0, width, height);\n  let data = null;\n  try {\n    data = ctx.getImageData(0, 0, width, height).data;\n  } catch (e) {\n    return null;\n  }\n  const l = data.length;\n\n  let r = 0;\n  let g = 0;\n  let b = 0;\n  let i = 0;\n\n  for (; i < l; i += 4) {\n    r += data[i] * data[i];\n    g += data[i + 1] * data[i + 1];\n    b += data[i + 2] * data[i + 2];\n  }\n\n  r = averageColor(r, l);\n  g = averageColor(g, l);\n  b = averageColor(b, l);\n\n  return { r, g, b };\n};\n\nconst averageColor = (c, l) => Math.floor(Math.sqrt(c / (l / 4)));\n\nconst cloneCanvas = (origin, target) => {\n  target = target || document.createElement('canvas');\n  target.width = origin.width;\n  target.height = origin.height;\n  const ctx = target.getContext('2d');\n  ctx.drawImage(origin, 0, 0);\n  return target;\n};\n\nconst cloneImageData = imageData => {\n  let id;\n  try {\n    id = new ImageData(imageData.width, imageData.height);\n  } catch (e) {\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    id = ctx.createImageData(imageData.width, imageData.height);\n  }\n  id.data.set(new Uint8ClampedArray(imageData.data));\n  return id;\n};\n\nconst loadImage = url =>\n  new Promise((resolve, reject) => {\n    const img = new Image();\n    img.crossOrigin = 'Anonymous';\n    img.onload = () => {\n      resolve(img);\n    };\n    img.onerror = e => {\n      reject(e);\n    };\n    img.src = url;\n  });\n\nconst createImageWrapperView = _ => {\n  // create overlay view\n  const OverlayView = createImageOverlayView(_);\n\n  const ImageView = createImageView(_);\n\n  const { createWorker } = _.utils;\n\n  const applyFilter = (root, filter, target) =>\n    new Promise(resolve => {\n      // will store image data for future filter updates\n      if (!root.ref.imageData) {\n        root.ref.imageData = target\n          .getContext('2d')\n          .getImageData(0, 0, target.width, target.height);\n      }\n\n      // get image data reference\n      const imageData = cloneImageData(root.ref.imageData);\n\n      if (!filter || filter.length !== 20) {\n        target.getContext('2d').putImageData(imageData, 0, 0);\n        return resolve();\n      }\n\n      const worker = createWorker(ColorMatrixWorker);\n      worker.post(\n        {\n          imageData,\n          colorMatrix: filter\n        },\n        response => {\n          // apply filtered colors\n          target.getContext('2d').putImageData(response, 0, 0);\n\n          // stop worker\n          worker.terminate();\n\n          // done!\n          resolve();\n        },\n        [imageData.data.buffer]\n      );\n    });\n\n  const removeImageView = (root, imageView) => {\n    root.removeChildView(imageView);\n    imageView.image.width = 1;\n    imageView.image.height = 1;\n    imageView._destroy();\n  };\n\n  // remove an image\n  const shiftImage = ({ root }) => {\n    const imageView = root.ref.images.shift();\n    imageView.opacity = 0;\n    imageView.translateY = -15;\n    root.ref.imageViewBin.push(imageView);\n    return imageView;\n  };\n\n  // add new image\n  const pushImage = ({ root, props, image }) => {\n    const id = props.id;\n    const item = root.query('GET_ITEM', { id });\n    if (!item) return;\n\n    const crop = item.getMetadata('crop') || {\n      center: {\n        x: 0.5,\n        y: 0.5\n      },\n      flip: {\n        horizontal: false,\n        vertical: false\n      },\n      zoom: 1,\n      rotation: 0,\n      aspectRatio: null\n    };\n\n    const background = root.query(\n      'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n    );\n\n    let markup;\n    let resize;\n    let dirty = false;\n    if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n      markup = item.getMetadata('markup') || [];\n      resize = item.getMetadata('resize');\n      dirty = true;\n    }\n\n    // append image presenter\n    const imageView = root.appendChildView(\n      root.createChildView(ImageView, {\n        id,\n        image,\n        crop,\n        resize,\n        markup,\n        dirty,\n        background,\n        opacity: 0,\n        scaleX: 1.15,\n        scaleY: 1.15,\n        translateY: 15\n      }),\n      root.childViews.length\n    );\n    root.ref.images.push(imageView);\n\n    // reveal the preview image\n    imageView.opacity = 1;\n    imageView.scaleX = 1;\n    imageView.scaleY = 1;\n    imageView.translateY = 0;\n\n    // the preview is now ready to be drawn\n    setTimeout(() => {\n      root.dispatch('DID_IMAGE_PREVIEW_SHOW', { id });\n    }, 250);\n  };\n\n  const updateImage = ({ root, props }) => {\n    const item = root.query('GET_ITEM', { id: props.id });\n    if (!item) return;\n    const imageView = root.ref.images[root.ref.images.length - 1];\n    imageView.crop = item.getMetadata('crop');\n    imageView.background = root.query(\n      'GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR'\n    );\n    if (root.query('GET_IMAGE_PREVIEW_MARKUP_SHOW')) {\n      imageView.dirty = true;\n      imageView.resize = item.getMetadata('resize');\n      imageView.markup = item.getMetadata('markup');\n    }\n  };\n\n  // replace image preview\n  const didUpdateItemMetadata = ({ root, props, action }) => {\n    // only filter and crop trigger redraw\n    if (!/crop|filter|markup|resize/.test(action.change.key)) return;\n\n    // no images to update, exit\n    if (!root.ref.images.length) return;\n\n    // no item found, exit\n    const item = root.query('GET_ITEM', { id: props.id });\n    if (!item) return;\n\n    // for now, update existing image when filtering\n    if (/filter/.test(action.change.key)) {\n      const imageView = root.ref.images[root.ref.images.length - 1];\n      applyFilter(root, action.change.value, imageView.image);\n      return;\n    }\n\n    if (/crop|markup|resize/.test(action.change.key)) {\n      const crop = item.getMetadata('crop');\n      const image = root.ref.images[root.ref.images.length - 1];\n\n      // if aspect ratio has changed, we need to create a new image\n      if (\n        crop &&\n        crop.aspectRatio &&\n        image.crop &&\n        image.crop.aspectRatio &&\n        Math.abs(crop.aspectRatio - image.crop.aspectRatio) > 0.00001\n      ) {\n        const imageView = shiftImage({ root });\n        pushImage({ root, props, image: cloneCanvas(imageView.image) });\n      }\n      // if not, we can update the current image\n      else {\n        updateImage({ root, props });\n      }\n    }\n  };\n\n  const canCreateImageBitmap = file => {\n    // Firefox versions before 58 will freeze when running createImageBitmap\n    // in a Web Worker so we detect those versions and return false for support\n    const userAgent = window.navigator.userAgent;\n    const isFirefox = userAgent.match(/Firefox\\/([0-9]+)\\./);\n    const firefoxVersion = isFirefox ? parseInt(isFirefox[1]) : null;\n    if (firefoxVersion !== null && firefoxVersion <= 58) return false;\n\n    return 'createImageBitmap' in window && isBitmap(file);\n  };\n\n  /**\n   * Write handler for when preview container has been created\n   */\n  const didCreatePreviewContainer = ({ root, props }) => {\n    const { id } = props;\n\n    // we need to get the file data to determine the eventual image size\n    const item = root.query('GET_ITEM', id);\n    if (!item) return;\n\n    // get url to file (we'll revoke it later on when done)\n    const fileURL = URL.createObjectURL(item.file);\n\n    // determine image size of this item\n    getImageSize(fileURL, (width, height) => {\n      // we can now scale the panel to the final size\n      root.dispatch('DID_IMAGE_PREVIEW_CALCULATE_SIZE', {\n        id,\n        width,\n        height\n      });\n    });\n  };\n\n  const drawPreview = ({ root, props }) => {\n    const { id } = props;\n\n    // we need to get the file data to determine the eventual image size\n    const item = root.query('GET_ITEM', id);\n    if (!item) return;\n\n    // get url to file (we'll revoke it later on when done)\n    const fileURL = URL.createObjectURL(item.file);\n\n    // fallback\n    const loadPreviewFallback = () => {\n      // let's scale the image in the main thread :(\n      loadImage(fileURL).then(previewImageLoaded);\n    };\n\n    // image is now ready\n    const previewImageLoaded = imageData => {\n      // the file url is no longer needed\n      URL.revokeObjectURL(fileURL);\n\n      // draw the scaled down version here and use that as source so bitmapdata can be closed\n      // orientation info\n      const exif = item.getMetadata('exif') || {};\n      const orientation = exif.orientation || -1;\n\n      // get width and height from action, and swap if orientation is incorrect\n      let { width, height } = imageData;\n\n      // if no width or height, just return early.\n      if (!width || !height) return;\n\n      if (orientation >= 5 && orientation <= 8) {\n        [width, height] = [height, width];\n      }\n\n      // scale canvas based on pixel density\n      // we multiply by .75 as that creates smaller but still clear images on screens with high res displays\n      const pixelDensityFactor = Math.max(1, window.devicePixelRatio * 0.75);\n\n      // we want as much pixels to work with as possible,\n      // this multiplies the minimum image resolution,\n      // so when zooming in it doesn't get too blurry\n      const zoomFactor = root.query('GET_IMAGE_PREVIEW_ZOOM_FACTOR');\n\n      // imaeg scale factor\n      const scaleFactor = zoomFactor * pixelDensityFactor;\n\n      // calculate scaled preview image size\n      const previewImageRatio = height / width;\n\n      // calculate image preview height and width\n      const previewContainerWidth = root.rect.element.width;\n      const previewContainerHeight = root.rect.element.height;\n\n      let imageWidth = previewContainerWidth;\n      let imageHeight = imageWidth * previewImageRatio;\n\n      if (previewImageRatio > 1) {\n        imageWidth = Math.min(width, previewContainerWidth * scaleFactor);\n        imageHeight = imageWidth * previewImageRatio;\n      } else {\n        imageHeight = Math.min(height, previewContainerHeight * scaleFactor);\n        imageWidth = imageHeight / previewImageRatio;\n      }\n\n      // transfer to image tag so no canvas memory wasted on iOS\n      const previewImage = createPreviewImage(\n        imageData,\n        imageWidth,\n        imageHeight,\n        orientation\n      );\n\n      // done\n      const done = () => {\n        // calculate average image color, disabled for now\n        const averageColor = root.query(\n          'GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR'\n        )\n          ? calculateAverageColor(data)\n          : null;\n        item.setMetadata('color', averageColor, true);\n\n        // data has been transferred to canvas ( if was ImageBitmap )\n        if ('close' in imageData) {\n          imageData.close();\n        }\n\n        // show the overlay\n        root.ref.overlayShadow.opacity = 1;\n\n        // create the first image\n        pushImage({ root, props, image: previewImage });\n      };\n\n      // apply filter\n      const filter = item.getMetadata('filter');\n      if (filter) {\n        applyFilter(root, filter, previewImage).then(done);\n      } else {\n        done();\n      }\n    };\n\n    // if we support scaling using createImageBitmap we use a worker\n    if (canCreateImageBitmap(item.file)) {\n      // let's scale the image in a worker\n      const worker = createWorker(BitmapWorker);\n\n      worker.post(\n        {\n          file: item.file\n        },\n        imageBitmap => {\n          // destroy worker\n          worker.terminate();\n\n          // no bitmap returned, must be something wrong,\n          // try the oldschool way\n          if (!imageBitmap) {\n            loadPreviewFallback();\n            return;\n          }\n\n          // yay we got our bitmap, let's continue showing the preview\n          previewImageLoaded(imageBitmap);\n        }\n      );\n    } else {\n      // create fallback preview\n      loadPreviewFallback();\n    }\n  };\n\n  /**\n   * Write handler for when the preview image is ready to be animated\n   */\n  const didDrawPreview = ({ root }) => {\n    // get last added image\n    const image = root.ref.images[root.ref.images.length - 1];\n    image.translateY = 0;\n    image.scaleX = 1.0;\n    image.scaleY = 1.0;\n    image.opacity = 1;\n  };\n\n  /**\n   * Write handler for when the preview has been loaded\n   */\n  const restoreOverlay = ({ root }) => {\n    root.ref.overlayShadow.opacity = 1;\n    root.ref.overlayError.opacity = 0;\n    root.ref.overlaySuccess.opacity = 0;\n  };\n\n  const didThrowError = ({ root }) => {\n    root.ref.overlayShadow.opacity = 0.25;\n    root.ref.overlayError.opacity = 1;\n  };\n\n  const didCompleteProcessing = ({ root }) => {\n    root.ref.overlayShadow.opacity = 0.25;\n    root.ref.overlaySuccess.opacity = 1;\n  };\n\n  /**\n   * Constructor\n   */\n  const create = ({ root }) => {\n    // image view\n    root.ref.images = [];\n\n    // the preview image data (we need this to filter the image)\n    root.ref.imageData = null;\n\n    // image bin\n    root.ref.imageViewBin = [];\n\n    // image overlays\n    root.ref.overlayShadow = root.appendChildView(\n      root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'idle'\n      })\n    );\n\n    root.ref.overlaySuccess = root.appendChildView(\n      root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'success'\n      })\n    );\n\n    root.ref.overlayError = root.appendChildView(\n      root.createChildView(OverlayView, {\n        opacity: 0,\n        status: 'failure'\n      })\n    );\n  };\n\n  return _.utils.createView({\n    name: 'image-preview-wrapper',\n    create,\n    styles: ['height'],\n    apis: ['height'],\n    destroy: ({ root }) => {\n      // we resize the image so memory on iOS 12 is released more quickly (it seems)\n      root.ref.images.forEach(imageView => {\n        imageView.image.width = 1;\n        imageView.image.height = 1;\n      });\n    },\n    didWriteView: ({ root }) => {\n      root.ref.images.forEach(imageView => {\n        imageView.dirty = false;\n      });\n    },\n    write: _.utils.createRoute(\n      {\n        // image preview stated\n        DID_IMAGE_PREVIEW_DRAW: didDrawPreview,\n        DID_IMAGE_PREVIEW_CONTAINER_CREATE: didCreatePreviewContainer,\n        DID_FINISH_CALCULATE_PREVIEWSIZE: drawPreview,\n        DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata,\n\n        // file states\n        DID_THROW_ITEM_LOAD_ERROR: didThrowError,\n        DID_THROW_ITEM_PROCESSING_ERROR: didThrowError,\n        DID_THROW_ITEM_INVALID: didThrowError,\n        DID_COMPLETE_ITEM_PROCESSING: didCompleteProcessing,\n        DID_START_ITEM_PROCESSING: restoreOverlay,\n        DID_REVERT_ITEM_PROCESSING: restoreOverlay\n      },\n      ({ root }) => {\n        // views on death row\n        const viewsToRemove = root.ref.imageViewBin.filter(\n          imageView => imageView.opacity === 0\n        );\n\n        // views to retain\n        root.ref.imageViewBin = root.ref.imageViewBin.filter(\n          imageView => imageView.opacity > 0\n        );\n\n        // remove these views\n        viewsToRemove.forEach(imageView => removeImageView(root, imageView));\n        viewsToRemove.length = 0;\n      }\n    )\n  });\n};\n\n/**\n * Image Preview Plugin\n */\nconst plugin = fpAPI => {\n  const { addFilter, utils } = fpAPI;\n  const { Type, createRoute, isFile } = utils;\n\n  // imagePreviewView\n  const imagePreviewView = createImageWrapperView(fpAPI);\n\n  // called for each view that is created right after the 'create' method\n  addFilter('CREATE_VIEW', viewAPI => {\n    // get reference to created view\n    const { is, view, query } = viewAPI;\n\n    // only hook up to item view and only if is enabled for this cropper\n    if (!is('file') || !query('GET_ALLOW_IMAGE_PREVIEW')) return;\n\n    // create the image preview plugin, but only do so if the item is an image\n    const didLoadItem = ({ root, props }) => {\n      const { id } = props;\n      const item = query('GET_ITEM', id);\n\n      // item could theoretically have been removed in the mean time\n      if (!item || !isFile(item.file) || item.archived) return;\n\n      // get the file object\n      const file = item.file;\n\n      // exit if this is not an image\n      if (!isPreviewableImage(file)) return;\n\n      // test if is filtered\n      if (!query('GET_IMAGE_PREVIEW_FILTER_ITEM')(item)) return;\n\n      // exit if image size is too high and no createImageBitmap support\n      // this would simply bring the browser to its knees and that is not what we want\n      const supportsCreateImageBitmap = 'createImageBitmap' in (window || {});\n      const maxPreviewFileSize = query('GET_IMAGE_PREVIEW_MAX_FILE_SIZE');\n      if (\n        !supportsCreateImageBitmap &&\n        (maxPreviewFileSize && file.size > maxPreviewFileSize)\n      )\n        return;\n\n      // set preview view\n      root.ref.imagePreview = view.appendChildView(\n        view.createChildView(imagePreviewView, { id })\n      );\n\n      // update height if is fixed\n      const fixedPreviewHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n      if (fixedPreviewHeight) {\n        root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n          id: item.id,\n          height: fixedPreviewHeight\n        });\n      }\n\n      // now ready\n      const queue =\n        !supportsCreateImageBitmap &&\n        file.size > query('GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE');\n      root.dispatch('DID_IMAGE_PREVIEW_CONTAINER_CREATE', { id }, queue);\n    };\n\n    const rescaleItem = (root, props) => {\n      if (!root.ref.imagePreview) return;\n\n      let { id } = props;\n\n      // get item\n      const item = root.query('GET_ITEM', { id });\n      if (!item) return;\n\n      // if is fixed height or panel has aspect ratio, exit here, height has already been defined\n      const panelAspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n      const itemPanelAspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO');\n      const fixedHeight = root.query('GET_IMAGE_PREVIEW_HEIGHT');\n      if (panelAspectRatio || itemPanelAspectRatio || fixedHeight) return;\n\n      // no data!\n      let { imageWidth, imageHeight } = root.ref;\n      if (!imageWidth || !imageHeight) return;\n\n      // get height min and max\n      const minPreviewHeight = root.query('GET_IMAGE_PREVIEW_MIN_HEIGHT');\n      const maxPreviewHeight = root.query('GET_IMAGE_PREVIEW_MAX_HEIGHT');\n\n      // orientation info\n      const exif = item.getMetadata('exif') || {};\n      const orientation = exif.orientation || -1;\n\n      // get width and height from action, and swap of orientation is incorrect\n      if (orientation >= 5 && orientation <= 8)\n        [imageWidth, imageHeight] = [imageHeight, imageWidth];\n\n      // scale up width and height when we're dealing with an SVG\n      if (!isBitmap(item.file) || root.query('GET_IMAGE_PREVIEW_UPSCALE')) {\n        const scalar = 2048 / imageWidth;\n        imageWidth *= scalar;\n        imageHeight *= scalar;\n      }\n\n      // image aspect ratio\n      const imageAspectRatio = imageHeight / imageWidth;\n\n      // we need the item to get to the crop size\n      const previewAspectRatio =\n        (item.getMetadata('crop') || {}).aspectRatio || imageAspectRatio;\n\n      // preview height range\n      let previewHeightMax = Math.max(\n        minPreviewHeight,\n        Math.min(imageHeight, maxPreviewHeight)\n      );\n      const itemWidth = root.rect.element.width;\n      const previewHeight = Math.min(\n        itemWidth * previewAspectRatio,\n        previewHeightMax\n      );\n\n      // request update to panel height\n      root.dispatch('DID_UPDATE_PANEL_HEIGHT', {\n        id: item.id,\n        height: previewHeight\n      });\n    };\n\n    const didResizeView = ({ root }) => {\n      // actions in next write operation\n      root.ref.shouldRescale = true;\n    };\n\n    const didUpdateItemMetadata = ({ root, action }) => {\n      if (action.change.key !== 'crop') return;\n\n      // actions in next write operation\n      root.ref.shouldRescale = true;\n    };\n\n    const didCalculatePreviewSize = ({ root, action }) => {\n      // remember dimensions\n      root.ref.imageWidth = action.width;\n      root.ref.imageHeight = action.height;\n\n      // actions in next write operation\n      root.ref.shouldRescale = true;\n      root.ref.shouldDrawPreview = true;\n\n      // as image load could take a while and fire when draw loop is resting we need to give it a kick\n      root.dispatch('KICK');\n    };\n\n    // start writing\n    view.registerWriter(\n      createRoute(\n        {\n          DID_RESIZE_ROOT: didResizeView,\n          DID_STOP_RESIZE: didResizeView,\n          DID_LOAD_ITEM: didLoadItem,\n          DID_IMAGE_PREVIEW_CALCULATE_SIZE: didCalculatePreviewSize,\n          DID_UPDATE_ITEM_METADATA: didUpdateItemMetadata\n        },\n        ({ root, props }) => {\n          // no preview view attached\n          if (!root.ref.imagePreview) return;\n\n          // don't do anything while hidden\n          if (root.rect.element.hidden) return;\n\n          // resize the item panel\n          if (root.ref.shouldRescale) {\n            rescaleItem(root, props);\n            root.ref.shouldRescale = false;\n          }\n\n          if (root.ref.shouldDrawPreview) {\n            // queue till next frame so we're sure the height has been applied this forces the draw image call inside the wrapper view to use the correct height\n            requestAnimationFrame(() => {\n              // this requestAnimationFrame nesting is horrible but it fixes an issue with 100hz displays on Chrome\n              // https://github.com/pqina/filepond-plugin-image-preview/issues/57\n              requestAnimationFrame(() => {\n                root.dispatch('DID_FINISH_CALCULATE_PREVIEWSIZE', {\n                  id: props.id\n                });\n              });\n            });\n\n            root.ref.shouldDrawPreview = false;\n          }\n        }\n      )\n    );\n  });\n\n  // expose plugin\n  return {\n    options: {\n      // Enable or disable image preview\n      allowImagePreview: [true, Type.BOOLEAN],\n\n      // filters file items to determine which are shown as preview\n      imagePreviewFilterItem: [() => true, Type.FUNCTION],\n\n      // Fixed preview height\n      imagePreviewHeight: [null, Type.INT],\n\n      // Min image height\n      imagePreviewMinHeight: [44, Type.INT],\n\n      // Max image height\n      imagePreviewMaxHeight: [256, Type.INT],\n\n      // Max size of preview file for when createImageBitmap is not supported\n      imagePreviewMaxFileSize: [null, Type.INT],\n\n      // The amount of extra pixels added to the image preview to allow comfortable zooming\n      imagePreviewZoomFactor: [2, Type.INT],\n\n      // Should we upscale small images to fit the max bounding box of the preview area\n      imagePreviewUpscale: [false, Type.BOOLEAN],\n\n      // Max size of preview file that we allow to try to instant preview if createImageBitmap is not supported, else image is queued for loading\n      imagePreviewMaxInstantPreviewFileSize: [1000000, Type.INT],\n\n      // Style of the transparancy indicator used behind images\n      imagePreviewTransparencyIndicator: [null, Type.STRING],\n\n      // Enables or disables reading average image color\n      imagePreviewCalculateAverageImageColor: [false, Type.BOOLEAN],\n\n      // Enables or disables the previewing of markup\n      imagePreviewMarkupShow: [true, Type.BOOLEAN],\n\n      // Allows filtering of markup to only show certain shapes\n      imagePreviewMarkupFilter: [() => true, Type.FUNCTION]\n    }\n  };\n};\n\n// fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\nconst isBrowser =\n  typeof window !== 'undefined' && typeof window.document !== 'undefined';\nif (isBrowser) {\n  document.dispatchEvent(\n    new CustomEvent('FilePond:pluginloaded', { detail: plugin })\n  );\n}\n\nexport default plugin;\n","/*!\n * FilePondPluginFileValidateType 1.2.9\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\nconst plugin = ({ addFilter, utils }) => {\n    // get quick reference to Type utils\n    const {\n        Type,\n        isString,\n        replaceInString,\n        guesstimateMimeType,\n        getExtensionFromFilename,\n        getFilenameFromURL,\n    } = utils;\n\n    const mimeTypeMatchesWildCard = (mimeType, wildcard) => {\n        const mimeTypeGroup = (/^[^/]+/.exec(mimeType) || []).pop(); // image/png -> image\n        const wildcardGroup = wildcard.slice(0, -2); // image/* -> image\n        return mimeTypeGroup === wildcardGroup;\n    };\n\n    const isValidMimeType = (acceptedTypes, userInputType) =>\n        acceptedTypes.some(acceptedType => {\n            // accepted is wildcard mime type\n            if (/\\*$/.test(acceptedType)) {\n                return mimeTypeMatchesWildCard(userInputType, acceptedType);\n            }\n\n            // is normal mime type\n            return acceptedType === userInputType;\n        });\n\n    const getItemType = item => {\n        // if the item is a url we guess the mime type by the extension\n        let type = '';\n        if (isString(item)) {\n            const filename = getFilenameFromURL(item);\n            const extension = getExtensionFromFilename(filename);\n            if (extension) {\n                type = guesstimateMimeType(extension);\n            }\n        } else {\n            type = item.type;\n        }\n\n        return type;\n    };\n\n    const validateFile = (item, acceptedFileTypes, typeDetector) => {\n        // no types defined, everything is allowed \\o/\n        if (acceptedFileTypes.length === 0) {\n            return true;\n        }\n\n        // gets the item type\n        const type = getItemType(item);\n\n        // no type detector, test now\n        if (!typeDetector) {\n            return isValidMimeType(acceptedFileTypes, type);\n        }\n\n        // use type detector\n        return new Promise((resolve, reject) => {\n            typeDetector(item, type)\n                .then(detectedType => {\n                    if (isValidMimeType(acceptedFileTypes, detectedType)) {\n                        resolve();\n                    } else {\n                        reject();\n                    }\n                })\n                .catch(reject);\n        });\n    };\n\n    const applyMimeTypeMap = map => acceptedFileType =>\n        map[acceptedFileType] === null ? false : map[acceptedFileType] || acceptedFileType;\n\n    // setup attribute mapping for accept\n    addFilter('SET_ATTRIBUTE_TO_OPTION_MAP', map =>\n        Object.assign(map, {\n            accept: 'acceptedFileTypes',\n        })\n    );\n\n    // filtering if an item is allowed in hopper\n    addFilter('ALLOW_HOPPER_ITEM', (file, { query }) => {\n        // if we are not doing file type validation exit\n        if (!query('GET_ALLOW_FILE_TYPE_VALIDATION')) {\n            return true;\n        }\n\n        // we validate the file against the accepted file types\n        return validateFile(file, query('GET_ACCEPTED_FILE_TYPES'));\n    });\n\n    // called for each file that is loaded\n    // right before it is set to the item state\n    // should return a promise\n    addFilter(\n        'LOAD_FILE',\n        (file, { query }) =>\n            new Promise((resolve, reject) => {\n                if (!query('GET_ALLOW_FILE_TYPE_VALIDATION')) {\n                    resolve(file);\n                    return;\n                }\n\n                const acceptedFileTypes = query('GET_ACCEPTED_FILE_TYPES');\n\n                // custom type detector method\n                const typeDetector = query('GET_FILE_VALIDATE_TYPE_DETECT_TYPE');\n\n                // if invalid, exit here\n                const validationResult = validateFile(file, acceptedFileTypes, typeDetector);\n\n                const handleRejection = () => {\n                    const acceptedFileTypesMapped = acceptedFileTypes\n                        .map(\n                            applyMimeTypeMap(\n                                query('GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP')\n                            )\n                        )\n                        .filter(label => label !== false);\n\n                    const acceptedFileTypesMappedUnique = acceptedFileTypesMapped.filter(\n                        (item, index) => acceptedFileTypesMapped.indexOf(item) === index\n                    );\n\n                    reject({\n                        status: {\n                            main: query('GET_LABEL_FILE_TYPE_NOT_ALLOWED'),\n                            sub: replaceInString(\n                                query('GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES'),\n                                {\n                                    allTypes: acceptedFileTypesMappedUnique.join(', '),\n                                    allButLastType: acceptedFileTypesMappedUnique\n                                        .slice(0, -1)\n                                        .join(', '),\n                                    lastType:\n                                        acceptedFileTypesMappedUnique[\n                                            acceptedFileTypesMappedUnique.length - 1\n                                        ],\n                                }\n                            ),\n                        },\n                    });\n                };\n\n                // has returned new filename immidiately\n                if (typeof validationResult === 'boolean') {\n                    if (!validationResult) {\n                        return handleRejection();\n                    }\n                    return resolve(file);\n                }\n\n                // is promise\n                validationResult\n                    .then(() => {\n                        resolve(file);\n                    })\n                    .catch(handleRejection);\n            })\n    );\n\n    // expose plugin\n    return {\n        // default options\n        options: {\n            // Enable or disable file type validation\n            allowFileTypeValidation: [true, Type.BOOLEAN],\n\n            // What file types to accept\n            acceptedFileTypes: [[], Type.ARRAY],\n            // - must be comma separated\n            // - mime types: image/png, image/jpeg, image/gif\n            // - extensions: .png, .jpg, .jpeg ( not enabled yet )\n            // - wildcards: image/*\n\n            // label to show when a type is not allowed\n            labelFileTypeNotAllowed: ['File is of invalid type', Type.STRING],\n\n            // nicer label\n            fileValidateTypeLabelExpectedTypes: [\n                'Expects {allButLastType} or {lastType}',\n                Type.STRING,\n            ],\n\n            // map mime types to extensions\n            fileValidateTypeLabelExpectedTypesMap: [{}, Type.OBJECT],\n\n            // Custom function to detect type of file\n            fileValidateTypeDetectType: [null, Type.FUNCTION],\n        },\n    };\n};\n\n// fire pluginloaded event if running in browser, this allows registering the plugin when using async script tags\nconst isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\nif (isBrowser) {\n    document.dispatchEvent(new CustomEvent('FilePond:pluginloaded', { detail: plugin }));\n}\n\nexport default plugin;\n","<script setup lang=\"ts\">\nimport { PropType, computed, ref, watch } from 'vue'\nimport { useForm } from 'vuestic-ui'\nimport { Service } from '../types'\nimport { validators } from '../../../services/utils'\n\n// FilePond imports\nimport vueFilePond from 'vue-filepond'\nimport FilePondPluginImagePreview from 'filepond-plugin-image-preview'\nimport FilePondPluginFileValidateType from 'filepond-plugin-file-validate-type'\nimport 'filepond/dist/filepond.min.css'\nimport 'filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css'\n\nconst FilePond = vueFilePond(FilePondPluginImagePreview, FilePondPluginFileValidateType)\n\n\n\nconst props = defineProps({\n  service: {\n    type: Object as PropType<Service | null>,\n    default: null,\n  },\n  saveButtonLabel: {\n    type: String,\n    default: 'Save',\n  },\n})\n\nconst filepondServer = {\n  url: `${import.meta.env.VITE_API_BASE_URL}/upload_service_image`,\n  process: {\n    url: '/',\n    method: 'POST',\n    headers: {\n      Authorization: `Bearer ${localStorage.getItem('access_token')}`,\n    },\n    withCredentials: false,\n    onload: (response: any) => {\n      const { filename, url } = JSON.parse(response)\n      newService.value.image_url = url\n      return url\n    },\n    onerror: (response: any) => {\n      console.error('Upload error:', response)\n      return 'Upload failed'\n    },\n  },\n  revert: null, // optional: implement if you want to allow image deletion\n}\n\nconst defaultNewService: Omit<Service, 'id'> = {\n  name: '',\n  description: '',\n  available_days: 'Mon,Tue,Wed,Thu,Fri,Sat,Sun',\n  room: '',\n  from_time: '',\n  to_time: '',\n  avg_minute: 0,\n  image_url: '',\n}\n\nconst newService = ref<Service>({ ...(defaultNewService as Service) })\n\nconst weekdays = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\nconst selectedDays = ref<string[]>([])\n\nwatch(\n  () => props.service,\n  (newVal) => {\n    if (newVal) {\n      newService.value = { ...newVal }\n      selectedDays.value = newVal.available_days\n        ? newVal.available_days.split(',').map(day => day.trim())\n        : [...weekdays]\n    } else {\n      newService.value = { ...(defaultNewService as Service) }\n      selectedDays.value = [...weekdays]\n    }\n    newService.value.available_days = selectedDays.value.join(',')\n  },\n  { immediate: true }\n)\n\nconst toggleDay = (day: string) => {\n  const index = selectedDays.value.indexOf(day)\n  if (index > -1) {\n    selectedDays.value.splice(index, 1)\n  } else {\n    selectedDays.value.push(day)\n  }\n  newService.value.available_days = selectedDays.value.join(',')\n}\n\nconst form = useForm('add-service-form')\nconst emit = defineEmits(['close', 'save'])\n\nconst onSave = () => {\n  if (form.validate()) {\n    emit('save', newService.value)\n  }\n}\n\n// Handle FilePond Image Upload\nconst imageFile = ref<File[]>([])\n\nconst handleImageUpdate = (files: File[]) => {\n  const file = files[0]\n  if (file) {\n    newService.value.image_url = URL.createObjectURL(file)\n  } else {\n    newService.value.image_url = ''\n  }\n}\n</script>\n\n<template>\n  <VaForm v-slot=\"{ isValid }\" ref=\"add-service-form\"\n    class=\"flex-col justify-start items-start gap-4 inline-flex w-full\">\n    <!-- Image Upload using FilePond -->\n    <div class=\"w-full\">\n      <label class=\"block mb-1 font-semibold\">Service Image</label>\n      <FilePond name=\"file\" accepted-file-types=\"image/*\" :files=\"imageFile\" :server=\"filepondServer\"\n        @updatefiles=\"handleImageUpdate($event.map((f: any) => f.file))\" allow-multiple=\"false\" allow-replace=\"true\"\n        label-idle='Drag & Drop or <span class=\"filepond--label-action\">Browse</span>' />\n    </div>\n    <div class=\"flex gap-4 w-full\">\n        <VaInput v-model=\"newService.name\" label=\"Service Name\" class=\"w-full\" :rules=\"[validators.required]\"\n        name=\"name\" />\n        <VaInput v-model=\"newService.room\" label=\"Room\" class=\"w-1/2\" name=\"room\" />\n    </div>\n    <div class=\"self-stretch flex-col justify-start items-start gap-4 flex w-full\">\n    \n\n      <VaTextarea v-model=\"newService.description\" label=\"Description\" class=\"w-full\" name=\"description\" />\n\n      <!-- Available Days -->\n      <div class=\"mb-4 self-stretch\">\n        <label class=\"block mb-1 font-semibold\">Available Days</label>\n        <div class=\"flex gap-2 flex-wrap\">\n          <button v-for=\"day in weekdays\" :key=\"day\" type=\"button\" :class=\"[\n            'px-3 py-1 rounded cursor-pointer select-none border',\n            selectedDays.includes(day)\n              ? 'bg-primary text-white border-primary'\n              : 'bg-gray-200 text-gray-700 border-transparent',\n          ]\" @click=\"toggleDay(day)\">\n            {{ day }}\n          </button>\n        </div>\n      </div>\n\n      <div class=\"flex gap-4 w-full\">\n        <VaInput v-model=\"newService.from_time\" label=\"From Time\" type=\"time\" class=\"w-1/4\" name=\"from_time\" />\n        <VaInput v-model=\"newService.to_time\" label=\"To Time\" type=\"time\" class=\"w-1/4\" name=\"to_time\" />\n      </div>\n\n      <VaInput v-model=\"newService.avg_minute\" label=\"Average Time (minutes)\" type=\"number\" class=\"w-1/2\" min=\"0\"\n        name=\"avg_minute\" />\n\n      <div class=\"flex gap-2 flex-col-reverse items-stretch justify-end w-full sm:flex-row sm:items-center\">\n        <VaButton preset=\"secondary\" color=\"secondary\" @click=\"$emit('close')\">Cancel</VaButton>\n        <VaButton :disabled=\"!isValid\" @click=\"onSave\">{{ saveButtonLabel }}</VaButton>\n      </div>\n    </div>\n  </VaForm>\n</template>\n","<script setup lang=\"ts\">\nimport { defineVaDataTableColumns, useModal } from 'vuestic-ui'\nimport { Service } from '../types'\nimport { PropType, computed, toRef } from 'vue'\nimport { Pagination, Sorting } from '../../../data/pages/services'\nimport { useVModel } from '@vueuse/core'\n\nconst BASE_URL= import.meta.env.VITE_API_BASE_URL\n\n\nconst columns = defineVaDataTableColumns([\n  { label: 'Name', key: 'name', sortable: true },\n  { label: 'Description', key: 'description', sortable: true },\n  { label: 'Available Days', key: 'available_days', sortable: true },\n  { label: 'Room', key: 'room', sortable: true },\n  { label: 'From Time', key: 'from_time', sortable: true },\n  { label: 'To Time', key: 'to_time', sortable: true },\n  { label: 'Average Minutes', key: 'avg_minute', sortable: true },\n  { label: 'Image', key: 'image_url', sortable: false },\n  { label: ' ', key: 'actions', align: 'right' },\n])\n\nconst props = defineProps({\n  services: {\n    type: Array as PropType<Service[]>,\n    required: true,\n  },\n  loading: { type: Boolean, default: false },\n  pagination: { type: Object as PropType<Pagination>, required: true },\n  sortBy: { type: String as PropType<Sorting['sortBy']>, required: true },\n  sortingOrder: { type: String as PropType<Sorting['sortingOrder']>, default: null },\n})\n\nconst emit = defineEmits<{\n  (event: 'edit-service', service: Service): void\n  (event: 'delete-service', service: Service): void\n  (event: 'update:sortBy', sortBy: Sorting['sortBy']): void\n  (event: 'update:sortingOrder', sortingOrder: Sorting['sortingOrder']): void\n}>()\n\nconst services = toRef(props, 'services')\nconst sortByVModel = useVModel(props, 'sortBy', emit)\nconst sortingOrderVModel = useVModel(props, 'sortingOrder', emit)\n\nconst totalPages = computed(() => Math.ceil(props.pagination.total / props.pagination.perPage))\n\nconst { confirm } = useModal()\n\nconst onServiceDelete = async (service: Service) => {\n  const agreed = await confirm({\n    title: 'Delete service',\n    message: `Are you sure you want to delete ${service.name}?`,\n    okText: 'Delete',\n    cancelText: 'Cancel',\n    size: 'small',\n    maxWidth: '380px',\n  })\n\n  if (agreed) {\n    emit('delete-service', service)\n  }\n}\n</script>\n\n<template>\n  <VaDataTable\n  v-model:sort-by=\"sortByVModel\"\n  v-model:sorting-order=\"sortingOrderVModel\"\n  :columns=\"columns\"\n  :items=\"services\"\n  :loading=\"$props.loading\"\n>\n  <!-- Name -->\n  <template #cell(name)=\"{ rowData }\">\n    <div class=\"max-w-[120px] ellipsis\">\n      {{ rowData.name || '' }}\n    </div>\n  </template>\n\n  <!-- Description -->\n  <template #cell(description)=\"{ rowData }\">\n    <div class=\"max-w-[230px] ellipsis\">\n      {{ rowData.description || '' }}\n    </div>\n  </template>\n\n  <!-- Available Days -->\n  <template #cell(available_days)=\"{ rowData }\">\n    <div class=\"max-w-[120px] ellipsis\">\n      {{ rowData.available_days || '' }}\n    </div>\n  </template>\n\n  <!-- Room -->\n  <template #cell(room)=\"{ rowData }\">\n    <div>\n      {{ rowData.room || '' }}\n    </div>\n  </template>\n\n  <!-- From Time -->\n  <template #cell(from_time)=\"{ rowData }\">\n    <div>\n      {{ rowData.from_time || '' }}\n    </div>\n  </template>\n\n  <!-- To Time -->\n  <template #cell(to_time)=\"{ rowData }\">\n    <div>\n      {{ rowData.to_time || '' }}\n    </div>\n  </template>\n\n  <!-- Avg Minute -->\n  <template #cell(avg_minute)=\"{ rowData }\">\n    <div>\n      {{ rowData.avg_minute || '' }}\n    </div>\n  </template>\n\n  <!-- Image URL (optional - maybe show image thumbnail) -->\n  <template #cell(image_url)=\"{ rowData }\">\n    <img\n      v-if=\"rowData.image_url\"\n      :src=\"BASE_URL+rowData.image_url\"\n      alt=\"Service Image\"\n      class=\"w-12 h-12 object-cover rounded\"\n    />\n  </template>\n\n  <!-- Actions -->\n  <template #cell(actions)=\"{ rowData }\">\n    <div class=\"flex gap-2 justify-end\">\n      <VaButton\n        preset=\"primary\"\n        size=\"small\"\n        icon=\"mso-edit\"\n        aria-label=\"Edit service\"\n        @click=\"$emit('edit-service', rowData)\"\n      />\n      <VaButton\n        preset=\"primary\"\n        size=\"small\"\n        icon=\"mso-delete\"\n        color=\"danger\"\n        aria-label=\"Delete service\"\n        @click=\"onServiceDelete(rowData)\"\n      />\n    </div>\n  </template>\n</VaDataTable>\n\n</template>\n\n<style lang=\"scss\" scoped>\n.va-data-table {\n  ::v-deep(.va-data-table__table-tr) {\n    border-bottom: 1px solid var(--va-background-border);\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, watchEffect } from 'vue'\nimport EditServiceForm from './widgets/EditServiceForm.vue'\nimport ServicesTable from './widgets/ServicesTable.vue'\nimport { Service } from './types'\nimport { useServices } from './composables/useServices'\nimport { useModal, useToast } from 'vuestic-ui'\n\nconst doShowEditServiceModal = ref(false)\n\nconst { services, isLoading, filters, sorting, pagination, error, ...servicesApi } = useServices()\n\nconst serviceToEdit = ref<Service | null>(null)\n\nconst showEditServiceModal = (service: Service) => {\n  serviceToEdit.value = service\n  doShowEditServiceModal.value = true\n}\n\nconst showAddServiceModal = () => {\n  serviceToEdit.value = null\n  doShowEditServiceModal.value = true\n}\n\nconst { init: notify } = useToast()\n\nwatchEffect(() => {\n  if (error.value) {\n    notify({\n      message: error.value.message,\n      color: 'danger',\n    })\n  }\n})\n\nconst onServiceSaved = async (service: Service) => {\n\n  if (serviceToEdit.value) {\n    await servicesApi.update(service)\n    if (!error.value) {\n      notify({\n        message: `${service.name} has been updated`,\n        color: 'success',\n      })\n    }\n  } else {\n    await servicesApi.add(service)\n\n    if (!error.value) {\n      notify({\n        message: `${service.name} has been created`,\n        color: 'success',\n      })\n    }\n  }\n}\n\nconst onServiceDelete = async (service: Service) => {\n  await servicesApi.remove(service)\n  notify({\n    message: `${service.name} has been deleted`,\n    color: 'success',\n  })\n}\n\nconst editFormRef = ref()\n\nconst { confirm } = useModal()\n\nconst beforeEditFormModalClose = async (hide: () => unknown) => {\n  if (editFormRef.value.isFormHasUnsavedChanges) {\n    const agreed = await confirm({\n      maxWidth: '380px',\n      message: 'Form has unsaved changes. Are you sure you want to close it?',\n      size: 'small',\n    })\n    if (agreed) {\n      hide()\n    }\n  } else {\n    hide()\n  }\n}\n</script>\n\n<template>\n  <h1 class=\"page-title\">Services</h1>\n\n  <VaCard>\n    <VaCardContent>\n      <div class=\"flex flex-col md:flex-row gap-2 mb-2 justify-between\">\n        <div class=\"flex flex-col md:flex-row gap-2 justify-start\">\n          <VaInput v-model=\"filters.search\" placeholder=\"Search\">\n            <template #prependInner>\n              <VaIcon name=\"search\" color=\"secondary\" size=\"small\" />\n            </template>\n          </VaInput>\n        </div>\n        <VaButton @click=\"showAddServiceModal\">Add Service</VaButton>\n      </div>\n\n      <ServicesTable\n        v-model:sort-by=\"sorting.sortBy\"\n        v-model:sorting-order=\"sorting.sortingOrder\"\n        :services=\"services\"\n        :loading=\"isLoading\"\n        :pagination=\"pagination\"\n        @editService=\"showEditServiceModal\"\n        @deleteService=\"onServiceDelete\"\n      />\n    </VaCardContent>\n  </VaCard>\n\n  <VaModal\n    v-slot=\"{ cancel, ok }\"\n    v-model=\"doShowEditServiceModal\"\n    size=\"small\"\n    mobile-fullscreen\n    close-button\n    hide-default-actions\n    :before-cancel=\"beforeEditFormModalClose\"\n  >\n    <h1 class=\"va-h5\">{{ serviceToEdit ? 'Edit service' : 'Add service' }}</h1>\n    <EditServiceForm\n      ref=\"editFormRef\"\n      :service=\"serviceToEdit\"\n      :save-button-label=\"serviceToEdit ? 'Save' : 'Add'\"\n      @close=\"cancel\"\n      @save=\"\n        (service) => {\n          onServiceSaved(service)\n          ok()\n        }\n      \"\n    />\n  </VaModal>\n</template>\n"],"names":["isNode","value","createStore","initialState","queries","actions","state","actionQueue","dispatchQueue","getState","processActionQueue","queue","processDispatchQueue","type","data","dispatch","isBlocking","actionHandlers","query","str","args","queryHandles","api","action","defineProperty","obj","property","definition","forin","cb","key","createObject","attr","node","name","ns","svgElements","isSVGElement","tag","createElement","className","attributes","element","appendChild","parent","child","index","appendChildView","childViews","view","removeChildView","IS_BROWSER","isBrowser","testElement","getChildCount","el","getViewRect","elementRect","offset","scale","left","top","right","bottom","rect","childView","childViewRect","expandRect","calculateRectSize","isNumber","thereYet","position","destination","velocity","errorMargin","spring","stiffness","damping","mass","target","resting","ts","skipToEndState","f","easeInOutQuad","t","tween","duration","easing","delay","start","p","reverse","animator","createAnimator","category","def","props","addGetSet","keys","overwrite","o","getter","setter","animations","mixinConfig","viewProps","viewInternalAPI","viewExternalAPI","initialProps","animation","addEvent","fn","removeEvent","listeners","viewState","events","add","remove","event","apis","isDefined","defaults","styles","currentProps","getOffset","getScale","getRect","propsHaveChanged","applyStyles","newProps","prop","opacity","perspective","translateX","translateY","scaleX","scaleY","rotateX","rotateY","rotateZ","originX","originY","width","height","transforms","elementCurrentStyle","Mixins","updateRect","style","createView","read","write","create","destroy","filterFrameActionsForChild","didCreateView","didWriteView","ignoreRect","ignoreRectUpdate","mixins","store","frameRect","isResting","activeMixins","ref","writers","readers","destroyers","getElement","getChildViews","getReference","createChildView","getStyle","_read","internalAPI","reader","_write","frameActions","shouldOptimize","writer","mixin","_destroy","destroyer","sharedAPIDefinition","internalAPIDefinition","needle","externalAPIDefinition","mixinAPIDefinition","a","b","mixinAPI","childCount","createPainter","fps","painter","interval","last","id","requestTick","cancelTick","setTimerType","tick","delta","createRoute","routes","root","timestamp","insertBefore","newNode","referenceNode","insertAfter","isArray","isEmpty","trim","toString","toArray","splitter","isBoolean","toBoolean","isString","toNumber","toInt","toFloat","isInt","toBytes","base","naturalFileSize","isFunction","toFunctionReference","string","levels","level","methods","createServerAPI","outline","createAction","method","timeout","headers","parts","toServerAPI","isNull","isObject","isAPI","getType","replaceSingleQuotes","conversionTable","convertTo","getValueByType","newValue","defaultValue","valueType","newValueType","convertedValue","createOption","currentValue","createOptions","options","optionDefinition","createInitialState","fromCamels","separator","part","createOptionAPI","createOptionActions","createOptionQueries","InteractionMethod","getUniqueId","arrayRemove","arr","run","sync","on","off","listener","fire","copyObjectPropertiesToObject","src","excluded","PRIVATE","createItemAPI","item","removeReleasedItems","items","ItemStatus","FileOrigin","getNonNumeric","getDecimalSeparator","getThousandsSeparator","decimalSeparator","thousandsStringWithSeparator","Type","filters","applyFilterChain","utils","resolve","reject","matchingFilters","initialFilter","current","next","error","applyFilters","addFilter","extendDefaultOptions","additionalOptions","defaultOptions","getOptions","setOptions","opts","getItemByQuery","getNumericAspectRatioFromString","aspectRatio","getActiveItems","Status","res","canUpdateFileInput","dataTransfer","ITEM_ERROR","ITEM_BUSY","ITEM_READY","isItemInErrorState","isItemInBusyState","isItemInReadyState","isAsync","EMPTY","ERROR","BUSY","IDLE","READY","option","status","hasRoomForItem","count","maxFileCount","limit","min","max","arrayInsert","insertItem","isBase64DataURI","getFilenameFromURL","url","getExtensionFromFilename","guesstimateExtension","subtype","leftPad","padding","getDateString","date","getFileFromBlob","blob","filename","extension","file","getBlobBuilder","createBlob","arrayBuffer","mimeType","BB","bb","getBlobFromByteStringWithMimeType","byteString","ab","ia","i","getMimeTypeFromBase64DataURI","dataURI","getBase64DataFromBase64DataURI","getByteStringFromBase64DataURI","getBlobFromBase64DataURI","getFileFromBase64DataURI","getFileNameFromHeader","header","matches","getFileSizeFromHeader","size","getTranfserIdFromHeader","getFileInfoFromHeaders","info","rows","source","createFileLoader","fetchFn","getProgress","abort","load","loadURL","response","computable","total","fileinfo","isGet","sendRequest","aborted","xhr","headersReceived","process","e","createResponse","code","body","createTimeoutResponse","hasQS","buildURL","createFetchFunction","apiUrl","onload","onerror","progress","request","ChunkStatus","processFileChunked","metadata","transfer","chunks","chunkTransferId","chunkServer","chunkSize","chunkRetryDelays","ondata","fd","requestTransferId","formData","requestParams","requestTransferOffset","requestUrl","lastChunkIndex","completeProcessingChunks","canProcessChunk","chunk","processChunk","processChunks","lengthComputable","loaded","updateTotalProgress","retryProcessChunk","totalBytesTransfered","totalSize","abortChunks","serverId","createFileProcessorFunction","canChunkUpload","shouldChunkUpload","willChunkUpload","createProcessorFunction","params","createRevertFunction","uniqueFileId","getRandomNumber","createPerceivedPerformanceUpdater","tickMin","tickMax","runtime","createFileProcessor","processFn","allowMinimumUploadDuration","progressFn","completeFn","transferId","reset","getDuration","getFilenameWithoutExtension","createFileStub","isFile","deepCloneObject","v","createItem","origin","serverFileReference","abortProcessingRequestComplete","setStatus","getFileExtension","getFileType","getFileSize","getFile","loader","meta","success","result","retryLoad","abortLoad","processor","onprocess","requestProcessing","abortProcessing","revert","revertFileUpload","forceRevert","serverTransferId","setMetadata","silent","handler","itemAPI","getItemIndexByQuery","getItemById","itemId","fetchBlob","getDomainFromURL","isExternalURL","dynamicLabel","label","isMockItem","listUpdated","optionalPromise","sortItems","compare","getItemByQueryFromState","itemHandler","failure","files","activeItems","change","shouldPrepareOutput","beforePrepareFile","upload","doUpload","currentIndex","interactionMethod","insertLocation","totalItems","ignoredFiles","isValidFile","promises","itemInsertLocation","mainStatus","handleAdd","shouldAdd","loadComplete","restore","fetch","err","processNow","maxParallelUploads","processNext","queueEntry","itemReference","server","noop","shouldRemove","removeFromView","handleRevert","shouldRevert","requestRemoveResult","optionKeys","prioritizedOptionKeys","PrioritizedOptions","formatFilename","createElement$1","tagName","text","textNode","polarToCartesian","centerX","centerY","radius","angleInDegrees","angleInRadians","describeArc","x","y","startAngle","endAngle","arcSweep","end","percentageArc","from","to","svg","ringStrokeWidth","ringFrom","ringTo","coordinates","progressIndicator","create$1","write$1","isDisabled","shouldDisable","fileActionButton","toNaturalFileSize","bytes","labelBytes","labelKilobytes","labelMegabytes","labelGigabytes","KB","MB","GB","removeDecimalsWhenZero","decimalCount","create$2","fileName","fileSize","updateFile","updateFileSizeOnError","fileInfo","toPercentage","create$3","main","sub","didSetItemLoadProgress","title","didSetItemProcessProgress","didRequestItemProcessing","didAbortItemProcessing","didCompleteItemProcessing","clear","fileStatus","Buttons","ButtonKeys","calculateFileInfoOffset","getRemoveIndicatorAligment","buttonRect","calculateButtonWidth","calculateFileVerticalCenterOffset","calculateFileHorizontalCenterOffset","getLoadIndicatorAlignment","getProcessIndicatorAlignment","DefaultStyle","IdleStyle","ProcessingStyle","StyleMap","processingCompleteIndicatorView","create$4","LocalButtons","prev","curr","allowRevert","allowRemove","allowProcess","instantUpload","alignRemoveItemButton","buttonFilter","enabledButtons","map","buttonView","loadIndicatorView","progressIndicatorView","write$2","route","stylesToApply","defaultStyles","control","create$5","didLoadItem","fileWrapper","PANEL_SPRING_PROPS","create$6","section","createSection","viewConstructor","write$3","topRect","bottomRect","panel","createDragHelper","itemIds","prevIndex","ITEM_TRANSLATE_SPRING","ITEM_SCALE_SPRING","StateMap","create$7","grab","removedActivateListener","dragState","drag","drop","cancel","route$1","write$4","getItemsPerRow","horizontalSpace","itemWidth","getItemIndexByPosition","children","positionInView","l","itemRect","itemHorizontalMargin","itemsPerRow","childMid","itemVerticalMargin","itemHeight","indexX","indexY","offsetX","offsetY","itemTop","itemRight","itemBottom","dropAreaDimensions","val","create$8","addItemView","now","spawnDate","cooldown","dist","moveItem","vx","vy","introItemView","removeItemView","getItemHeight","getItemWidth","dragItem","numItems","oldIndex","dragPosition","dragHeight","dragWidth","cols","location","visibleChildren","idx","childHeight","childBottom","childTop","route$2","write$5","dragCoordinates","dragIndex","addIndex","dragIndexOffset","removeIndexOffset","addIndexOffset","childRect","dragOffset","visualHeight","prevX","prevY","visualIndex","vectorX","vectorY","filterSetItemActions","list","create$9","storeDragCoordinates","clearDragCoordinates","route$3","write$6","newHeight","listScroller","attrToggle","enabledValue","resetFileInput","input","form","parentNode","create$a","setAcceptedFileTypes","toggleAllowMultiple","toggleDirectoryFilter","toggleDisabled","toggleRequired","setCaptureMethod","doesAllowBrowse","disableField","updateRequiredStatus","hasInvalidField","updateFieldValidityStatus","browser","Key","create$b","updateLabelValue","clickable","dropLabel","addBlob","moveBlob","hideBlob","explodeBlob","write$7","route$4","drip","setInputFiles","create$c","legend","getField","syncFieldPositionsWithItems","didReorderItems","didAddItem","shouldUseFileInput","dataContainer","didLoadItem$1","field","fileItem","didPrepareOutput","didSetDisabled","didRemoveItem","didDefineValue","write$8","getRootNode","images","text$1","guesstimateMimeType","requestDataTransferItems","links","getLinks","hasFiles","getFiles","promisedFiles","isFileSystemItem","getFilesFromItem","returnedFileGroups","group","isEntry","entry","getAsEntry","isDirectoryEntry","getFilesInDirectory","dirCounter","fileCounter","resolveIfDone","readEntries","dirEntry","directoryReader","readBatch","entries","correctedFile","correctMissingFileType","getLinksFromTransferMetaData","getLinksFromTransferURLData","dragNDropObservers","eventPosition","createDragNDropClient","scopeToObserve","filterElement","observer","getDragNDropObserver","client","newObserver","createDragNDropObserver","clients","dragenter","dragover","dragleave","handlers","createHandler","elementFromPoint","point","isEventTarget","elementAtPosition","initialTarget","setDropEffect","effect","onenter","overDropTarget","onexit","ondrag","allowdrop","allowsTransfer","ondrop","createHopper","scope","validateItems","catchesDropsOnPage","requiresDropOnElement","filterItems","lastState","currentState","filteredItems","listening","listeners$1","handlePaste","activeEl","inScope","listen","unlisten","createPaster","create$d","addFilesNotificationTimeout","notificationClearTimeout","filenames","assist","message","clear$1","listModified","isUsingFilePond","itemAdded","itemRemoved","itemProcessed","itemProcessedUndo","itemError","assistant","toCamels","debounce","func","immidiateOnly","MAX_FILES_LIMIT","prevent","create$e","canHover","hasPointerEvents","credits","frag","write$9","route$5","bounds","calculateRootBoundingBoxHeight","hopper","isMultiItem","maxItems","atMaxCapacity","addAction","listItemMargin","calculateListItemMargin","listHeight","calculateListHeight","labelHeight","currentLabelHeight","listMarginTop","listMarginBottom","boundsHeight","history","MAX_BOUNCES","bounces","listAvailableHeight","isCappedHeight","panelHeight","itemMargin","visual","scrollList","itemList","newItem","removedItem","verticalItemCount","exceedsMaxFiles","allowReplace","allowMultiple","totalBrowseItems","getDragIndex","toggleDrop","isAllowed","enabled","beforeDropFile","toggleBrowse","togglePaste","createApp","initialOptions","originalElement","visibilityHandler","resizeDoneTimer","isResizing","isResizingHorizontally","initialWindowWidth","currentWindowWidth","resizeHandler","isHidden","readWriteApi","routeActionsToEvents","createEvent","eventRoutes","exposeEvent","detail","exports","filtered","prepareFile","addFile","addFiles","isFilePondFile","removeFile","sources","lastArgument","processFile","prepareFiles","processFiles","removeFiles","q","createAppObject","customOptions","lowerCaseFirstLetter","attributeNameToPropertyName","attributeName","mapObject","object","propertyMap","selector","mapping","selectorRegExp","getAttributesAsObject","attributeMapping","output","attribute","createAppAtElement","mergedOptions","attributeOptions","app","createApp$1","PRIVATE_METHODS","createAppAPI","replaceInString","replacements","match","createWorker","workerBlob","workerURL","worker","transferList","loadImage","img","renameFile","renamedFile","copyFile","registeredPlugins","createAppPlugin","plugin","pluginOutline","isOperaMini","hasPromises","hasBlobSlice","hasCreateObjectURL","hasVisibility","hasTiming","hasCSSSupports","isIE11","supported","isSupported","OptionTypes","create$f","parse","find","registerPlugin","getOptions$1","setOptions$1","updateOptionTypes","hook","indexToRemove","context","newHook","plugins","filteredComponentMethods","getNativeConstructorFromType","instances","globalOptions","vueFilePond","valid_types","h","passedProps","detached","mutationHandler","mutations","removedNode","unwatch","isPreviewableImage","vectorMultiply","amount","createVector","vectorAdd","vectorNormalize","vectorRotate","radians","cos","sin","getMarkupValue","scalar","axis","getMarkupStyles","markup","lineStyle","fill","stroke","strokeWidth","lineCap","lineJoin","dashes","getMarkupRect","pointsToPathShape","points","setAttributes","updateEllipse","cx","cy","rx","ry","IMAGE_FIT_STYLE","updateImage","TEXT_ANCHOR","updateText","fontSize","fontFamily","fontWeight","textAlign","updateLine","line","begin","arrowBeginRotationPoint","arrowBeginCenter","arrowBeginA","arrowBeginB","arrowEndRotationPoint","arrowEndCenter","arrowEndA","arrowEndB","updatePath","createShape","createImage","shape","createLine","CREATE_TYPE_ROUTES","UPDATE_TYPE_ROUTES","createMarkupByType","updateMarkupByType","MARKUP_RECT","toOptionalFraction","prepareMarkup","sortMarkupByZIndex","createMarkupView","_","crop","resize","viewWidth","viewHeight","cropWidth","cropHeight","outputWidth","outputHeight","outputFit","outputUpscale","shouldUpscale","scalarWidth","scalarHeight","markupFilter","settings","createVector$1","vectorDot","vectorSubtract","vectorDistanceSquared","vectorDistance","getOffsetPointOnEdge","length","rotation","A","B","C","sinA","sinB","sinC","cosC","ratio","c","getRotatedRectSize","w","hor","ver","tl","tr","bl","calculateCanvasSize","image","canvasAspectRatio","zoom","imageAspectRatio","canvasWidth","canvasHeight","imgWidth","imgHeight","getImageRectZoomFactor","imageRect","cropRect","center","imageWidth","imageHeight","rotatedCropSize","getCenteredCropRect","container","getCurrentCropSize","imageSize","canvasSize","canvasCenter","stage","shouldLimit","stageZoomFactor","IMAGE_SCALE_SPRING_PROPS","createBitmapView","createImageCanvasWrapper","flip","bitmap","createClipView","transparencyIndicator","dirty","translation","cropAspectRatio","imageView","createImageView","clip","containerWidth","containerHeight","fixedPreviewHeight","minPreviewHeight","maxPreviewHeight","panelAspectRatio","clipHeight","clipWidth","SVG_MASK","SVGMaskUniqueId","createImageOverlayView","fpAPI","mask","BitmapWorker","ColorMatrixWorker","imageData","matrix","m11","m12","m13","m14","m15","m21","m22","m23","m24","m25","m31","m32","m33","m34","m35","m41","m42","m43","m44","m45","r","g","getImageSize","fixImageOrientation","ctx","orientation","createPreviewImage","canvas","isBitmap","MAX_WIDTH","MAX_HEIGHT","calculateAverageColor","averageColor","cloneCanvas","cloneImageData","createImageWrapperView","OverlayView","ImageView","applyFilter","filter","removeImageView","shiftImage","pushImage","background","didUpdateItemMetadata","canCreateImageBitmap","isFirefox","firefoxVersion","didCreatePreviewContainer","fileURL","drawPreview","loadPreviewFallback","previewImageLoaded","pixelDensityFactor","scaleFactor","previewImageRatio","previewContainerWidth","previewContainerHeight","previewImage","done","imageBitmap","didDrawPreview","restoreOverlay","didThrowError","didCompleteProcessing","viewsToRemove","imagePreviewView","viewAPI","is","supportsCreateImageBitmap","maxPreviewFileSize","rescaleItem","itemPanelAspectRatio","fixedHeight","previewAspectRatio","previewHeightMax","previewHeight","didResizeView","didCalculatePreviewSize","mimeTypeMatchesWildCard","wildcard","mimeTypeGroup","wildcardGroup","isValidMimeType","acceptedTypes","userInputType","acceptedType","getItemType","validateFile","acceptedFileTypes","typeDetector","detectedType","applyMimeTypeMap","acceptedFileType","validationResult","handleRejection","acceptedFileTypesMapped","acceptedFileTypesMappedUnique","FilePond","FilePondPluginImagePreview","FilePondPluginFileValidateType","__props","filepondServer","newService","defaultNewService","weekdays","selectedDays","watch","newVal","day","toggleDay","useForm","emit","__emit","onSave","imageFile","handleImageUpdate","BASE_URL","columns","defineVaDataTableColumns","services","toRef","sortByVModel","useVModel","sortingOrderVModel","computed","confirm","useModal","onServiceDelete","service","doShowEditServiceModal","isLoading","sorting","pagination","servicesApi","useServices","serviceToEdit","showEditServiceModal","showAddServiceModal","notify","useToast","watchEffect","onServiceSaved","editFormRef","beforeEditFormModalClose","hide"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}
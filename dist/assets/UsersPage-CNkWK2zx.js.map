{"version":3,"file":"UsersPage-CNkWK2zx.js","sources":["../../src/pages/users/widgets/UsersTable.vue","../../src/pages/users/widgets/UserAvatar.vue","../../src/pages/users/widgets/EditUserForm.vue","../../src/pages/users/composables/useUsers.ts","../../src/pages/users/UsersPage.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { defineVaDataTableColumns, useModal } from 'vuestic-ui'\nimport { Genders, User, UserRole } from '../types'\nimport { PropType, computed, toRef } from 'vue'\nimport { Pagination, Sorting } from '../../../data/pages/users'\nimport { useVModel } from '@vueuse/core'\n\nconst columns = defineVaDataTableColumns([\n  { label: 'Full Name', key: 'fullname', sortable: true },\n  { label: 'Email', key: 'email', sortable: true },\n  { label: 'Username', key: 'username', sortable: true },\n  { label: 'Role', key: 'role', sortable: true },\n  { label: 'Gender', key: 'gender', sortable: true },\n  { label: ' ', key: 'actions', align: 'right' },\n])\n\nconst props = defineProps({\n  users: {\n    type: Array as PropType<User[]>,\n    required: true,\n  },\n  loading: { type: Boolean, default: false },\n  pagination: { type: Object as PropType<Pagination>, required: true },\n  sortBy: { type: String as PropType<Sorting['sortBy']>, required: true },\n  sortingOrder: { type: String as PropType<Sorting['sortingOrder']>, default: null },\n})\n\nconst emit = defineEmits<{\n  (event: 'edit-user', user: User): void\n  (event: 'delete-user', user: User): void\n  (event: 'update:sortBy', sortBy: Sorting['sortBy']): void\n  (event: 'update:sortingOrder', sortingOrder: Sorting['sortingOrder']): void\n}>()\n\nconst users = toRef(props, 'users')\nconst sortByVModel = useVModel(props, 'sortBy', emit)\nconst sortingOrderVModel = useVModel(props, 'sortingOrder', emit)\n\nconst roleColors: Record<UserRole, string> = {\n  admin: 'danger',\n  client: 'background-element',\n  service_admin: 'warning',\n}\n\nconst genderColors: Record<Genders, string> = {\n  male: 'dark',\n  female: 'purple'\n}\n\nconst totalPages = computed(() => Math.ceil(props.pagination.total / props.pagination.perPage))\n\nconst { confirm } = useModal()\n\nconst onUserDelete = async (user: User) => {\n  const agreed = await confirm({\n    title: 'Delete user',\n    message: `Are you sure you want to delete ${user.fullname}?`,\n    okText: 'Delete',\n    cancelText: 'Cancel',\n    size: 'small',\n    maxWidth: '380px',\n  })\n\n  if (agreed) {\n    emit('delete-user', user)\n  }\n}\n</script>\n\n<template>\n  <VaDataTable v-model:sort-by=\"sortByVModel\" v-model:sorting-order=\"sortingOrderVModel\" :columns=\"columns\"\n    :items=\"users\" :loading=\"$props.loading\">\n    <template #cell(fullname)=\"{ rowData }\">\n      <div class=\"max-w-[120px] ellipsis\">\n        {{ rowData?.profile?.fullname || '' }}\n      </div>\n    </template>\n\n    <template #cell(email)=\"{ rowData }\">\n      <div class=\"ellipsis max-w-[230px]\">\n        {{ rowData.email }}\n      </div>\n    </template>\n\n    <template #cell(username)=\"{ rowData }\">\n      <div class=\"max-w-[120px] ellipsis\">\n        {{ rowData.username }}\n      </div>\n    </template>\n\n    <template #cell(role)=\"{ rowData }\">\n      <VaBadge :text=\"rowData.role\" :color=\"roleColors[rowData.role as UserRole]\" />\n    </template>\n    <template #cell(gender)=\"{ rowData }\">\n      <VaBadge :text=\"rowData.profile?.gender\" :color=\"genderColors[rowData.profile?.gender as Genders]\" />\n    </template>\n\n    <template #cell(actions)=\"{ rowData }\">\n      <div class=\"flex gap-2 justify-end\">\n        <VaButton preset=\"primary\" size=\"small\" icon=\"mso-edit\" aria-label=\"Edit user\"\n          @click=\"$emit('edit-user', rowData as User)\" />\n        <VaButton preset=\"primary\" size=\"small\" icon=\"mso-delete\" color=\"danger\" aria-label=\"Delete user\"\n          @click=\"onUserDelete(rowData as User)\" />\n      </div>\n    </template>\n  </VaDataTable>\n\n  <div class=\"flex flex-col-reverse md:flex-row gap-2 justify-between items-center py-2\">\n    <div>\n      <b>{{ $props.pagination.total }} results.</b>\n      Results per page\n      <VaSelect v-model=\"$props.pagination.perPage\" class=\"!w-20\" :options=\"[10, 50, 100]\" />\n    </div>\n\n    <div v-if=\"totalPages > 1\" class=\"flex\">\n      <VaButton preset=\"secondary\" icon=\"va-arrow-left\" aria-label=\"Previous page\"\n        :disabled=\"$props.pagination.page === 1\" @click=\"$props.pagination.page--\" />\n      <VaButton class=\"mr-2\" preset=\"secondary\" icon=\"va-arrow-right\" aria-label=\"Next page\"\n        :disabled=\"$props.pagination.page === totalPages\" @click=\"$props.pagination.page++\" />\n      <VaPagination v-model=\"$props.pagination.page\" buttons-preset=\"secondary\" :pages=\"totalPages\" :visible-pages=\"5\"\n        :boundary-links=\"false\" :direction-links=\"false\" />\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.va-data-table {\n  ::v-deep(.va-data-table__table-tr) {\n    border-bottom: 1px solid var(--va-background-border);\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { type PropType } from 'vue'\nimport { type User } from '../types'\n\nconst avatarColor = (userName: string) => {\n  const colors = ['primary', '#FFD43A', '#ADFF00', '#262824', 'danger']\n  const index = userName.charCodeAt(0) % colors.length\n  return colors[index]\n}\n\ndefineProps({\n  user: {\n    type: Object as PropType<User>,\n    required: true,\n  },\n  size: {\n    type: String,\n    default: 'medium',\n  },\n})\n\nconst isUrl = (avatar: string) => {\n  if (!avatar) return false\n\n  return avatar.startsWith('http') || avatar.startsWith('blob:')\n}\n\nconst fallback = (fullname: string) => {\n  try {\n    const [firstName, lastName] = fullname.split(' ')\n    return `${firstName[0]}${lastName[0]}`\n  } catch {\n    return fullname[0]\n  }\n}\n</script>\n\n<template>\n  <VaAvatar\n    :size=\"size\"\n    :src=\"isUrl(user.avatar) ? user.avatar : ''\"\n    :fallback-text=\"fallback(user.fullname)\"\n    :color=\"avatarColor(user.fullname)\"\n  />\n</template>\n","<script setup lang=\"ts\">\nimport { PropType, computed, ref, watch } from 'vue'\nimport { useForm } from 'vuestic-ui'\nimport { User, UserRole } from '../types'\nimport UserAvatar from './UserAvatar.vue'\nimport { validators } from '../../../services/utils'\n\nconst props = defineProps({\n  user: {\n    type: Object as PropType<User | null>,\n    default: null,\n  },\n  saveButtonLabel: {\n    type: String,\n    default: 'Save',\n  },\n})\n\nconst defaultNewUser: Omit<User, 'id'> = {\n  avatar: '',\n  fullname: '',\n  role: 'user',\n  username: '',\n  notes: '',\n  email: '',\n  active: true,\n  projects: [],\n}\n\nconst newUser = ref<User>({ ...defaultNewUser } as User)\n\nconst isFormHasUnsavedChanges = computed(() => {\n  return Object.keys(newUser.value).some((key) => {\n    if (key === 'avatar' || key === 'projects') {\n      return false\n    }\n\n    return (\n      newUser.value[key as keyof Omit<User, 'id'>] !== (props.user ?? defaultNewUser)?.[key as keyof Omit<User, 'id'>]\n    )\n  })\n})\n\ndefineExpose({\n  isFormHasUnsavedChanges,\n})\n\n\nwatch(\n  [() => props.user, projects],\n  () => {\n    if (!props.user) {\n      return\n    }\n\n    newUser.value = {\n      ...props.user,\n    }\n  },\n  { immediate: true },\n)\n\nconst avatar = ref<File>()\n\nconst makeAvatarBlobUrl = (avatar: File) => {\n  return URL.createObjectURL(avatar)\n}\n\nwatch(avatar, (newAvatar) => {\n  newUser.value.avatar = newAvatar ? makeAvatarBlobUrl(newAvatar) : ''\n})\n\nconst form = useForm('add-user-form')\n\nconst emit = defineEmits(['close', 'save'])\n\nconst onSave = () => {\n  if (form.validate()) {\n    emit('save', newUser.value)\n  }\n}\n\nconst roleSelectOptions: { text: Capitalize<Lowercase<UserRole>>; value: UserRole }[] = [\n  { text: 'Admin', value: 'admin' },\n  { text: 'User', value: 'user' },\n  { text: 'Owner', value: 'owner' },\n]\n</script>\n\n<template>\n  <VaForm v-slot=\"{ isValid }\" ref=\"add-user-form\" class=\"flex-col justify-start items-start gap-4 inline-flex w-full\">\n    <VaFileUpload\n      v-model=\"avatar\"\n      type=\"single\"\n      hide-file-list\n      class=\"self-stretch justify-start items-center gap-4 inline-flex\"\n    >\n      <UserAvatar :user=\"newUser\" size=\"large\" />\n      <VaButton preset=\"primary\" size=\"small\">Add image</VaButton>\n      <VaButton\n        v-if=\"avatar\"\n        preset=\"primary\"\n        color=\"danger\"\n        size=\"small\"\n        icon=\"delete\"\n        class=\"z-10\"\n        @click.stop=\"avatar = undefined\"\n      />\n    </VaFileUpload>\n    <div class=\"self-stretch flex-col justify-start items-start gap-4 flex\">\n      <div class=\"flex gap-4 flex-col sm:flex-row w-full\">\n        <VaInput\n          v-model=\"newUser.fullname\"\n          label=\"Full name\"\n          class=\"w-full sm:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"fullName\"\n        />\n        <VaInput\n          v-model=\"newUser.username\"\n          label=\"Username\"\n          class=\"w-full sm:w-1/2\"\n          :rules=\"[validators.required]\"\n          name=\"username\"\n        />\n      </div>\n      <div class=\"flex gap-4 flex-col sm:flex-row w-full\">\n        <VaInput\n          v-model=\"newUser.email\"\n          label=\"Email\"\n          class=\"w-full sm:w-1/2\"\n          :rules=\"[validators.required, validators.email]\"\n          name=\"email\"\n        />\n        <VaSelect\n          v-model=\"newUser.projects\"\n          label=\"Projects\"\n          class=\"w-full sm:w-1/2\"\n          :options=\"projects\"\n          value-by=\"id\"\n          text-by=\"project_name\"\n          :rules=\"[validators.required]\"\n          name=\"projects\"\n          multiple\n          :max-visible-options=\"2\"\n        />\n      </div>\n\n      <div class=\"flex gap-4 w-full\">\n        <div class=\"w-1/2\">\n          <VaSelect\n            v-model=\"newUser.role\"\n            label=\"Role\"\n            class=\"w-full\"\n            :options=\"roleSelectOptions\"\n            :rules=\"[validators.required]\"\n            name=\"role\"\n            value-by=\"value\"\n          />\n        </div>\n\n        <div class=\"flex items-center w-1/2 mt-4\">\n          <VaCheckbox v-model=\"newUser.active\" label=\"Active\" class=\"w-full\" name=\"active\" />\n        </div>\n      </div>\n\n      <VaTextarea v-model=\"newUser.notes\" label=\"Notes\" class=\"w-full\" name=\"notes\" />\n      <div class=\"flex gap-2 flex-col-reverse items-stretch justify-end w-full sm:flex-row sm:items-center\">\n        <VaButton preset=\"secondary\" color=\"secondary\" @click=\"$emit('close')\">Cancel</VaButton>\n        <VaButton :disabled=\"!isValid\" @click=\"onSave\">{{ saveButtonLabel }}</VaButton>\n      </div>\n    </div>\n  </VaForm>\n</template>\n","import { Ref, ref, unref, watch, computed } from 'vue'\nimport { v4 as uuid } from 'uuid'\nimport type { Filters, Pagination, Sorting } from '../../../data/pages/users'\nimport { User } from '../types'\nimport { useUsersStore } from '../../../stores/users'\n\nconst makePaginationRef = () => ref<Pagination>({ page: 1, perPage: 10, total: 0 })\nconst makeSortingRef = () => ref<Sorting>({ sortBy: 'fullname', sortingOrder: null })\nconst makeFiltersRef = () => ref<Partial<Filters>>({ isActive: true, search: '' })\n\nexport const useUsers = (options?: {\n  pagination?: Ref<Pagination>\n  sorting?: Ref<Sorting>\n  filters?: Ref<Partial<Filters>>\n}) => {\n  const isLoading = ref(false)\n  const error = ref()\n  const usersStore = useUsersStore()\n\n  const { filters = makeFiltersRef(), sorting = makeSortingRef(), pagination = makePaginationRef() } = options || {}\n\n  const fetch = async () => {\n    isLoading.value = true\n    try {\n      await usersStore.getAll({\n        filters: unref(filters),\n        sorting: unref(sorting),\n        pagination: unref(pagination),\n      })\n      pagination.value = usersStore.pagination\n    } finally {\n      isLoading.value = false\n    }\n  }\n\n  watch(\n    filters,\n    () => {\n      // Reset pagination to first page when filters changed\n      pagination.value.page = 1\n      fetch()\n    },\n    { deep: true },\n  )\n\n  fetch()\n\n  const users = computed(() => {\n    const getSortItem = (obj: any, sortBy: string) => {\n      return obj[sortBy]\n    }\n\n    const paginated = usersStore.items.slice(\n      (pagination.value.page - 1) * pagination.value.perPage,\n      pagination.value.page * pagination.value.perPage,\n    )\n\n    if (sorting.value.sortBy && sorting.value.sortingOrder) {\n      paginated.sort((a, b) => {\n        const first = getSortItem(a, sorting.value.sortBy!)\n        const second = getSortItem(b, sorting.value.sortBy!)\n        if (first > second) {\n          return sorting.value.sortingOrder === 'asc' ? 1 : -1\n        }\n        if (first < second) {\n          return sorting.value.sortingOrder === 'asc' ? -1 : 1\n        }\n        return 0\n      })\n    }\n    return paginated\n  })\n\n  return {\n    error,\n    isLoading,\n    filters,\n    sorting,\n    pagination,\n\n    users,\n\n    fetch,\n\n    async add(user: User) {\n      isLoading.value = true\n      try {\n        return await usersStore.add(user)\n      } catch (e) {\n        error.value = e\n      } finally {\n        isLoading.value = false\n      }\n    },\n\n    async update(user: User) {\n      isLoading.value = true\n      try {\n        return await usersStore.update(user)\n      } catch (e) {\n        error.value = e\n      } finally {\n        isLoading.value = false\n      }\n    },\n\n    async remove(user: User) {\n      isLoading.value = true\n      try {\n        return await usersStore.remove(user)\n      } catch (e) {\n        error.value = e\n      } finally {\n        isLoading.value = false\n      }\n    },\n\n    async uploadAvatar(avatar: Blob) {\n      const formData = new FormData()\n      formData.append('avatar', avatar)\n      formData.append('id', uuid())\n\n      return usersStore.uploadAvatar(formData)\n    },\n  }\n}\n","<script setup lang=\"ts\">\nimport { ref, watchEffect } from 'vue'\nimport UsersTable from './widgets/UsersTable.vue'\nimport EditUserForm from './widgets/EditUserForm.vue'\nimport { User } from './types'\nimport { useUsers } from './composables/useUsers'\nimport { useModal, useToast } from 'vuestic-ui'\n\nconst doShowEditUserModal = ref(false)\n\nconst { users, isLoading, filters, sorting, pagination, error, ...usersApi } = useUsers()\n\nconst userToEdit = ref<User | null>(null)\n\nconst showEditUserModal = (user: User) => {\n  userToEdit.value = user\n  doShowEditUserModal.value = true\n}\n\nconst showAddUserModal = () => {\n  userToEdit.value = null\n  doShowEditUserModal.value = true\n}\n\nconst { init: notify } = useToast()\n\nwatchEffect(() => {\n  if (error.value) {\n    notify({\n      message: error.value.message,\n      color: 'danger',\n    })\n  }\n})\n\nconst onUserSaved = async (user: User) => {\n\n  if (userToEdit.value) {\n    await usersApi.update(user)\n    if (!error.value) {\n      notify({\n        message: `${user.fullname} has been updated`,\n        color: 'success',\n      })\n    }\n  } else {\n    await usersApi.add(user)\n\n    if (!error.value) {\n      notify({\n        message: `${user.fullname} has been created`,\n        color: 'success',\n      })\n    }\n  }\n}\n\nconst onUserDelete = async (user: User) => {\n  await usersApi.remove(user)\n  notify({\n    message: `${user.fullname} has been deleted`,\n    color: 'success',\n  })\n}\n\nconst editFormRef = ref()\n\nconst { confirm } = useModal()\n\nconst beforeEditFormModalClose = async (hide: () => unknown) => {\n  if (editFormRef.value.isFormHasUnsavedChanges) {\n    const agreed = await confirm({\n      maxWidth: '380px',\n      message: 'Form has unsaved changes. Are you sure you want to close it?',\n      size: 'small',\n    })\n    if (agreed) {\n      hide()\n    }\n  } else {\n    hide()\n  }\n}\n</script>\n\n<template>\n  <h1 class=\"page-title\">Users</h1>\n\n  <VaCard>\n    <VaCardContent>\n      <div class=\"flex flex-col md:flex-row gap-2 mb-2 justify-between\">\n        <div class=\"flex flex-col md:flex-row gap-2 justify-start\">\n          <VaButtonToggle\n            v-model=\"filters.isActive\"\n            color=\"background-element\"\n            border-color=\"background-element\"\n            :options=\"[\n              { label: 'Active', value: true },\n              { label: 'Inactive', value: false },\n            ]\"\n          />\n          <VaInput v-model=\"filters.search\" placeholder=\"Search\">\n            <template #prependInner>\n              <VaIcon name=\"search\" color=\"secondary\" size=\"small\" />\n            </template>\n          </VaInput>\n        </div>\n        <VaButton @click=\"showAddUserModal\">Add User</VaButton>\n      </div>\n\n      <UsersTable\n        v-model:sort-by=\"sorting.sortBy\"\n        v-model:sorting-order=\"sorting.sortingOrder\"\n        :users=\"users\"\n        :loading=\"isLoading\"\n        :pagination=\"pagination\"\n        @editUser=\"showEditUserModal\"\n        @deleteUser=\"onUserDelete\"\n      />\n    </VaCardContent>\n  </VaCard>\n\n  <VaModal\n    v-slot=\"{ cancel, ok }\"\n    v-model=\"doShowEditUserModal\"\n    size=\"small\"\n    mobile-fullscreen\n    close-button\n    hide-default-actions\n    :before-cancel=\"beforeEditFormModalClose\"\n  >\n    <h1 class=\"va-h5\">{{ userToEdit ? 'Edit user' : 'Add user' }}</h1>\n    <EditUserForm\n      ref=\"editFormRef\"\n      :user=\"userToEdit\"\n      :save-button-label=\"userToEdit ? 'Save' : 'Add'\"\n      @close=\"cancel\"\n      @save=\"\n        (user) => {\n          onUserSaved(user)\n          ok()\n        }\n      \"\n    />\n  </VaModal>\n</template>\n"],"names":["columns","defineVaDataTableColumns","props","__props","emit","__emit","users","toRef","sortByVModel","useVModel","sortingOrderVModel","roleColors","genderColors","totalPages","computed","confirm","useModal","onUserDelete","user","avatarColor","userName","colors","index","isUrl","avatar","fallback","fullname","firstName","lastName","defaultNewUser","newUser","ref","isFormHasUnsavedChanges","key","_a","__expose","watch","makeAvatarBlobUrl","newAvatar","form","useForm","onSave","roleSelectOptions","makePaginationRef","makeSortingRef","makeFiltersRef","useUsers","options","isLoading","error","usersStore","useUsersStore","filters","sorting","pagination","fetch","unref","getSortItem","obj","sortBy","paginated","a","b","first","second","e","formData","uuid","doShowEditUserModal","usersApi","userToEdit","showEditUserModal","showAddUserModal","notify","useToast","watchEffect","onUserSaved","editFormRef","beforeEditFormModalClose","hide"],"mappings":"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"}
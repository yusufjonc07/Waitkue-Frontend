import{d as h,r as y,K as D,k as M,J as S,z as T,f as u,b as $,c as z,e as _,i as c,h as t,w as r,B as i,u as G,L as H}from"./index-Bcr3mXlA.js";import{u as x}from"./useForm-fy7gsO6_.js";import{u as J}from"./useAuth-D0ISSAP_.js";const K={class:"flex-column"},O={class:"text-base mb-4 leading-5"},W=h({__name:"Signup",setup(Y){const f=y(0),{push:I}=D(),{init:m}=M(),{login:k,signup:U,addClient:A,isLoading:C}=J(),{validate:F}=x("form"),{validate:V}=x("form2"),o=S({email:"",password:"",repeatPassword:""}),l=S({firstname:"",surename:"",middlename:"",user_id:0,gender:"male"}),P=T(),L=[s=>!!s||"Password field is required",s=>s.length>=8||"Password must be at least 8 characters long",s=>/[A-Za-z]/.test(s)||"Password must contain at least one letter",s=>/\d/.test(s)||"Password must contain at least one number",s=>/[!@#$%^&*(),.?":{}|<>]/.test(s)||"Password must contain at least one special character"],v=async()=>{if(await F())try{await U(o.email,o.password),await k(o.email.split("@")[0],o.password),m({message:"Account created successfully!",color:"success"})}catch(e){throw m({message:e.message||"Sign-up failed. Try again.",color:"danger"}),e}else throw new Error("Form validation failed.")},b=async()=>{let e;if(await V())try{l.user_id=((e=P.currentUser)==null?void 0:e.id)||0,await A(l),m({message:"You've successfully signed up!",color:"success"}),I({name:"dashboard"})}catch(p){m({message:p.message||"Profile creation failed.",color:"danger"})}},q=y(H([{label:"User Account",beforeLeave:async(s,e)=>{if(s!==e)try{return await v(),!0}catch{return!1}return!0}},{label:"Profile Details",beforeLeave:async()=>await V()}]));return(s,e)=>{const p=u("RouterLink"),d=u("VaInput"),w=u("VaIcon"),B=u("VaValue"),g=u("VaForm"),R=u("VaSelect"),N=u("VaButton"),E=u("VaStepper");return $(),z("div",K,[e[11]||(e[11]=_("h1",{class:"font-semibold text-3xl mb-4"},"Sign up",-1)),_("p",O,[e[9]||(e[9]=c(" Have an account? ")),t(p,{to:{name:"login"},class:"font-semibold text-primary"},{default:r(()=>e[8]||(e[8]=[c("Login")])),_:1})]),t(E,{ref:"actionStepper",modelValue:f.value,"onUpdate:modelValue":e[7]||(e[7]=a=>f.value=a),steps:q.value},{"step-content-0":r(()=>[t(g,{ref:"form",onSubmit:i(v,["prevent"])},{default:r(()=>[t(d,{modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=a=>o.email=a),rules:[a=>!!a||"Email is required",a=>/.+@.+\..+/.test(a)||"Invalid email format"],class:"mb-4",label:"Email",type:"email"},null,8,["modelValue","rules"]),t(B,{"default-value":!1},{default:r(a=>[t(d,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=n=>o.password=n),rules:L,type:a.value?"text":"password",class:"mb-4",label:"Password",messages:"Password should be 8+ characters with letters, numbers, and special characters.",onClickAppendInner:i(n=>a.value=!a.value,["stop"])},{appendInner:r(()=>[t(w,{name:a.value?"mso-visibility_off":"mso-visibility",class:"cursor-pointer",color:"secondary"},null,8,["name"])]),_:2},1032,["modelValue","type","onClickAppendInner"]),t(d,{modelValue:o.repeatPassword,"onUpdate:modelValue":e[2]||(e[2]=n=>o.repeatPassword=n),rules:[n=>!!n||"Repeat Password is required",n=>n===o.password||"Passwords do not match"],type:a.value?"text":"password",class:"mb-4",label:"Repeat Password",onClickAppendInner:i(n=>a.value=!a.value,["stop"])},{appendInner:r(()=>[t(w,{name:a.value?"mso-visibility_off":"mso-visibility",class:"cursor-pointer",color:"secondary"},null,8,["name"])]),_:2},1032,["modelValue","rules","type","onClickAppendInner"])]),_:1})]),_:1},512)]),"step-content-1":r(()=>[t(g,{ref:"form2",onSubmit:i(b,["prevent"])},{default:r(()=>[t(d,{modelValue:l.firstname,"onUpdate:modelValue":e[3]||(e[3]=a=>l.firstname=a),label:"First Name",class:"mb-4",rules:[a=>!!a||"First name is required"]},null,8,["modelValue","rules"]),t(d,{modelValue:l.surename,"onUpdate:modelValue":e[4]||(e[4]=a=>l.surename=a),label:"Surname",class:"mb-4",rules:[a=>!!a||"Surname is required"]},null,8,["modelValue","rules"]),t(d,{modelValue:l.middlename,"onUpdate:modelValue":e[5]||(e[5]=a=>l.middlename=a),label:"Middle Name",class:"mb-4"},null,8,["modelValue"]),t(R,{modelValue:l.gender,"onUpdate:modelValue":e[6]||(e[6]=a=>l.gender=a),label:"Gender",class:"mb-4",options:["Male","Female","Other"],rules:[a=>!!a||"Gender is required"]},null,8,["modelValue","rules"]),t(N,{loading:G(C),onClick:b,class:"mt-2",color:"primary"},{default:r(()=>e[10]||(e[10]=[c(" Finish ")])),_:1},8,["loading"])]),_:1},512)]),_:1},8,["modelValue","steps"])])}}});export{W as default};
//# sourceMappingURL=Signup-BoVqHFrR.js.map
